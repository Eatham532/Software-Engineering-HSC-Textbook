
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Learning Outcome: SE-12-05 - Investigate the effect of human and dataset source bias in the development of ML and AI solutions">
      
      
      
        <link rel="canonical" href="https://eatham532.github.io/Software-Engineering-HSC-Textbook/Year12/SoftwareAutomation/Chapter-22-Significance-and-impact/22-03-Bias-in-datasets-and-models-expanded/">
      
      
        <link rel="prev" href="../22-02-Human-behaviour-patterns-and-their-influence-on-ML-AI-development/quiz/">
      
      
        <link rel="next" href="quiz/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Section 22.3: Bias in Datasets and Models (Expanded) - Software Engineering Textbook HSC</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/diagram-modal.css">
    
      <link rel="stylesheet" href="../../../../assets/quiz.css">
    
      <link rel="stylesheet" href="../../../../assets/common.css">
    
      <link rel="stylesheet" href="../../../../assets/diagram-fix.css">
    
      <link rel="stylesheet" href="../../../../assets/cross-reference.css">
    
      <link rel="stylesheet" href="../../../../assets/site-banner.css">
    
      <link rel="stylesheet" href="../../../../assets/code-runner.css">
    
      <link rel="stylesheet" href="../../../../assets/code-editor.css">
    
      <link rel="stylesheet" href="../../../../assets/glossary.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-58275RL1P9"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-58275RL1P9",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-58275RL1P9",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#section-223-bias-in-datasets-and-models-expanded" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
  
  
    
    
    
    <div class="site-banner site-banner--warning" data-banner data-banner-version="1" role="status" aria-live="polite">
      <div class="site-banner__inner">
        <span class="site-banner__icon" aria-hidden="true">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            
              <path d="M12 9v4"/><path d="M12 17h.01"/><path d="M10.29 3.86 1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0Z"/>
            
          </svg>
        </span>
        <p class="site-banner__text">
          This textbook is in <strong>beta</strong> â€“ content is actively being refined.
          
            <a class="site-banner__link" href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/issues/new/choose" target="_blank" rel="noopener">Report issues or suggestions</a>
          
        </p>
        <button type="button" class="site-banner__close" aria-label="Dismiss banner" title="Dismiss" data-banner-dismiss>&times;</button>
      </div>
    </div>
    <script>
      (function(){
        var banner=document.querySelector('[data-banner]');
        if(!banner) return;
        var version=banner.getAttribute('data-banner-version')||'1';
        var KEY='site_banner_dismissed_v'+version;
        try{ if(localStorage.getItem(KEY)){ banner.remove(); return;} }catch(e){}
        var btn=banner.querySelector('[data-banner-dismiss]');
        if(btn){ btn.addEventListener('click',function(){
          banner.classList.add('is-hiding');
          setTimeout(function(){ banner && banner.remove(); },200);
          try{ localStorage.setItem(KEY,'1'); }catch(e){}
        }); }
      })();
    </script>
  
  
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Software Engineering Textbook HSC" class="md-header__button md-logo" aria-label="Software Engineering Textbook HSC" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Software Engineering Textbook HSC
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Section 22.3: Bias in Datasets and Models (Expanded)
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Eatham532/Software-Engineering-HSC-Textbook
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    

    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../Year11/ProgrammingFundamentals/" class="md-tabs__link">
          
  
  
  Year 11

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../ProgrammingForTheWeb/" class="md-tabs__link">
          
  
  
  Year 12

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../code-editor/" class="md-tabs__link">
        
  
  
    
  
  Code Editor

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../glossary/" class="md-tabs__link">
        
  
  
    
  
  Glossary

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Software Engineering Textbook HSC" class="md-nav__button md-logo" aria-label="Software Engineering Textbook HSC" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Software Engineering Textbook HSC
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Eatham532/Software-Engineering-HSC-Textbook
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../../../Year11/ProgrammingFundamentals/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Year 11
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Year 12
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Year 12
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../ProgrammingForTheWeb/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Programming For The Web
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../SecureSoftwareArchitecture/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Secure Software Architecture
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Software Automation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Software Automation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../Chapter-20-ML-and-automation-basics/20-01-What-is-AI-vs-ML/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 20 â€” ML and automation basics
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../Chapter-21-Programming-for-automation/21-01-Regression-models-and-core-algorithm-types-in-Python/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 21 â€” Programming for automation
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_4" checked>
        
          
          <label class="md-nav__link" for="__nav_3_3_4" id="__nav_3_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Chapter 22 â€” Significance and impact
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_3_4">
            <span class="md-nav__icon md-icon"></span>
            Chapter 22 â€” Significance and impact
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../22-01-Assessing-the-impact-of-automation/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    22.1 Assessing the impact of automation
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../22-02-Human-behaviour-patterns-and-their-influence-on-ML-AI-development/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    22.2 Human behaviour patterns and their influence on ML/AI development
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_4_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3_3_4_3" id="__nav_3_3_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    22.3 Bias in datasets and models (expanded)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_3_4_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_3_4_3">
            <span class="md-nav__icon md-icon"></span>
            22.3 Bias in datasets and models (expanded)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Content
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Content
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-1-sources-of-bias-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Part 1: Sources of Bias Analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 1: Sources of Bias Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-understanding-bias-types" class="md-nav__link">
    <span class="md-ellipsis">
      1.1 Understanding Bias Types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-bias-detection-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      1.2 Bias Detection Workflow
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-2-practical-bias-investigation-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Part 2: Practical Bias Investigation Tools
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-3-bias-mitigation-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      Part 3: Bias Mitigation Strategies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-4-transparency-and-accountability-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Part 4: Transparency and Accountability Tools
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#practice-tasks" class="md-nav__link">
    <span class="md-ellipsis">
      Practice Tasks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Practice Tasks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task-1-bias-source-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Task 1: Bias Source Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-2-missing-groups-investigation" class="md-nav__link">
    <span class="md-ellipsis">
      Task 2: Missing Groups Investigation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-3-fairness-aware-model-development" class="md-nav__link">
    <span class="md-ellipsis">
      Task 3: Fairness-Aware Model Development
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-4-model-card-creation" class="md-nav__link">
    <span class="md-ellipsis">
      Task 4: Model Card Creation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-5-reproducibility-package" class="md-nav__link">
    <span class="md-ellipsis">
      Task 5: Reproducibility Package
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-takeaways" class="md-nav__link">
    <span class="md-ellipsis">
      Key Takeaways
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="quiz/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quiz
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../SoftwareEngineeringProject/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Software Engineering Project
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../code-editor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code Editor
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-1-sources-of-bias-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Part 1: Sources of Bias Analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 1: Sources of Bias Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-understanding-bias-types" class="md-nav__link">
    <span class="md-ellipsis">
      1.1 Understanding Bias Types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-bias-detection-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      1.2 Bias Detection Workflow
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-2-practical-bias-investigation-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Part 2: Practical Bias Investigation Tools
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-3-bias-mitigation-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      Part 3: Bias Mitigation Strategies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-4-transparency-and-accountability-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Part 4: Transparency and Accountability Tools
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#practice-tasks" class="md-nav__link">
    <span class="md-ellipsis">
      Practice Tasks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Practice Tasks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task-1-bias-source-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Task 1: Bias Source Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-2-missing-groups-investigation" class="md-nav__link">
    <span class="md-ellipsis">
      Task 2: Missing Groups Investigation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-3-fairness-aware-model-development" class="md-nav__link">
    <span class="md-ellipsis">
      Task 3: Fairness-Aware Model Development
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-4-model-card-creation" class="md-nav__link">
    <span class="md-ellipsis">
      Task 4: Model Card Creation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-5-reproducibility-package" class="md-nav__link">
    <span class="md-ellipsis">
      Task 5: Reproducibility Package
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-takeaways" class="md-nav__link">
    <span class="md-ellipsis">
      Key Takeaways
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/edit/main/docs/Year12/SoftwareAutomation/Chapter-22-Significance-and-impact/22-03-Bias-in-datasets-and-models-expanded/index.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/raw/main/docs/Year12/SoftwareAutomation/Chapter-22-Significance-and-impact/22-03-Bias-in-datasets-and-models-expanded/index.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="section-223-bias-in-datasets-and-models-expanded">Section 22.3: Bias in Datasets and Models (Expanded)<a class="headerlink" href="#section-223-bias-in-datasets-and-models-expanded" title="Permanent link">&para;</a></h1>
<p><strong>Learning Outcome</strong>: SE-12-05 - Investigate the effect of human and dataset source bias in the development of ML and <span class="glossary-term" data-glossary-category="Automation" data-glossary-definition="The simulation of human intelligence processes by computer systems, including learning, reasoning, and self-correction." data-glossary-full-form="Artificial Intelligence" data-glossary-term="AI">AI</span> solutions</p>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>Bias in machine learning systems represents one of the most critical challenges in <span class="glossary-term" data-glossary-category="Automation" data-glossary-definition="The simulation of human intelligence processes by computer systems, including learning, reasoning, and self-correction." data-glossary-full-form="Artificial Intelligence" data-glossary-term="AI">AI</span> development. This section provides comprehensive <span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A pre-built structure providing a foundation and tools for developing software applications more efficiently." data-glossary-term="Framework">frameworks</span> for identifying, analyzing, and mitigating various forms of bias that can infiltrate ML systems through data collection, model design, and deployment decisions. Understanding bias is essential for creating fair, reliable, and trustworthy <span class="glossary-term" data-glossary-category="Automation" data-glossary-definition="The simulation of human intelligence processes by computer systems, including learning, reasoning, and self-correction." data-glossary-full-form="Artificial Intelligence" data-glossary-term="AI">AI</span> systems.</p>
<h2 id="part-1-sources-of-bias-analysis">Part 1: Sources of Bias Analysis<a class="headerlink" href="#part-1-sources-of-bias-analysis" title="Permanent link">&para;</a></h2>
<h3 id="11-understanding-bias-types">1.1 Understanding Bias Types<a class="headerlink" href="#11-understanding-bias-types" title="Permanent link">&para;</a></h3>
<p>Bias in ML systems manifests through multiple pathways, each requiring specific identification and mitigation strategies.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Any</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogisticRegression</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">confusion_matrix</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="nd">@dataclass</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="k">class</span><span class="w"> </span><span class="nc">BiasAssessment</span><span class="p">:</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Assessment result for a specific type of bias&quot;&quot;&quot;</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="n">bias_type</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    <span class="n">severity_score</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># 0.0 to 1.0</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    <span class="n">affected_groups</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    <span class="n">impact_description</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    <span class="n">mitigation_suggestions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="k">class</span><span class="w"> </span><span class="nc">BiasSourceAnalyzer</span><span class="p">:</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Comprehensive framework for analyzing various sources of bias in ML systems&quot;&quot;&quot;</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bias_types</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>            <span class="s1">&#39;sampling&#39;</span><span class="p">:</span> <span class="s1">&#39;Systematic exclusion or over-representation of certain groups&#39;</span><span class="p">,</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>            <span class="s1">&#39;historical&#39;</span><span class="p">:</span> <span class="s1">&#39;Past societal inequities embedded in training data&#39;</span><span class="p">,</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>            <span class="s1">&#39;labeler&#39;</span><span class="p">:</span> <span class="s1">&#39;Human annotator biases affecting ground truth labels&#39;</span><span class="p">,</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>            <span class="s1">&#39;population_drift&#39;</span><span class="p">:</span> <span class="s1">&#39;Changes in population characteristics over time&#39;</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>        <span class="p">}</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assessments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_sampling_bias</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">protected_attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>                            <span class="n">expected_distribution</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">BiasAssessment</span><span class="p">:</span>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="sd">        Analyze sampling bias by comparing actual vs expected group distributions</span>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="sd">        Args:</span>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a><span class="sd">            dataset: The dataset to analyze</span>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a><span class="sd">            protected_attr: Column name for protected attribute (e.g., &#39;gender&#39;, &#39;race&#39;)</span>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="sd">            expected_distribution: Expected proportions for each group</span>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a>        <span class="n">actual_distribution</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="n">protected_attr</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a>        <span class="c1"># Calculate divergence from expected distribution</span>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a>        <span class="n">divergences</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a>        <span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">expected_prop</span> <span class="ow">in</span> <span class="n">expected_distribution</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a>            <span class="n">actual_prop</span> <span class="o">=</span> <span class="n">actual_distribution</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a>            <span class="n">divergences</span><span class="p">[</span><span class="n">group</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">actual_prop</span> <span class="o">-</span> <span class="n">expected_prop</span><span class="p">)</span>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a>        <span class="n">severity</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">divergences</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a>        <span class="n">affected_groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">group</span> <span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">div</span> <span class="ow">in</span> <span class="n">divergences</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">div</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">]</span>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a>        <span class="n">impact_desc</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Sampling bias detected with max divergence of </span><span class="si">{</span><span class="n">severity</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a>        <span class="k">if</span> <span class="n">affected_groups</span><span class="p">:</span>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a>            <span class="n">impact_desc</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; affecting groups: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">affected_groups</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a>        <span class="n">mitigation</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a>            <span class="s2">&quot;Implement stratified sampling to match expected distribution&quot;</span><span class="p">,</span>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a>            <span class="s2">&quot;Use weighted sampling during training&quot;</span><span class="p">,</span>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a>            <span class="s2">&quot;Collect additional data for underrepresented groups&quot;</span><span class="p">,</span>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62" href="#__codelineno-0-62"></a>            <span class="s2">&quot;Apply data augmentation techniques for minority groups&quot;</span>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63" href="#__codelineno-0-63"></a>        <span class="p">]</span>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64" href="#__codelineno-0-64"></a>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65" href="#__codelineno-0-65"></a>        <span class="n">assessment</span> <span class="o">=</span> <span class="n">BiasAssessment</span><span class="p">(</span>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66" href="#__codelineno-0-66"></a>            <span class="n">bias_type</span><span class="o">=</span><span class="s2">&quot;sampling&quot;</span><span class="p">,</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67" href="#__codelineno-0-67"></a>            <span class="n">severity_score</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">severity</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>  <span class="c1"># Scale to 0-1</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68" href="#__codelineno-0-68"></a>            <span class="n">affected_groups</span><span class="o">=</span><span class="n">affected_groups</span><span class="p">,</span>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69" href="#__codelineno-0-69"></a>            <span class="n">impact_description</span><span class="o">=</span><span class="n">impact_desc</span><span class="p">,</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70" href="#__codelineno-0-70"></a>            <span class="n">mitigation_suggestions</span><span class="o">=</span><span class="n">mitigation</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71" href="#__codelineno-0-71"></a>        <span class="p">)</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72" href="#__codelineno-0-72"></a>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73" href="#__codelineno-0-73"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assessments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">assessment</span><span class="p">)</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74" href="#__codelineno-0-74"></a>        <span class="k">return</span> <span class="n">assessment</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75" href="#__codelineno-0-75"></a>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76" href="#__codelineno-0-76"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_historical_bias</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">protected_attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77" href="#__codelineno-0-77"></a>                               <span class="n">outcome_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiasAssessment</span><span class="p">:</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78" href="#__codelineno-0-78"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79" href="#__codelineno-0-79"></a><span class="sd">        Analyze historical bias through disparate impact analysis</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80" href="#__codelineno-0-80"></a>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81" href="#__codelineno-0-81"></a><span class="sd">        Args:</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82" href="#__codelineno-0-82"></a><span class="sd">            dataset: The dataset to analyze</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83" href="#__codelineno-0-83"></a><span class="sd">            protected_attr: Protected attribute column</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84" href="#__codelineno-0-84"></a><span class="sd">            outcome_col: Target outcome column</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85" href="#__codelineno-0-85"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86" href="#__codelineno-0-86"></a>        <span class="c1"># Calculate positive outcome rates by group</span>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87" href="#__codelineno-0-87"></a>        <span class="n">group_outcomes</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">protected_attr</span><span class="p">)[</span><span class="n">outcome_col</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">])</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88" href="#__codelineno-0-88"></a>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89" href="#__codelineno-0-89"></a>        <span class="c1"># Find reference group (typically majority group)</span>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90" href="#__codelineno-0-90"></a>        <span class="n">reference_group</span> <span class="o">=</span> <span class="n">group_outcomes</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91" href="#__codelineno-0-91"></a>        <span class="n">reference_rate</span> <span class="o">=</span> <span class="n">group_outcomes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">reference_group</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">]</span>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92" href="#__codelineno-0-92"></a>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93" href="#__codelineno-0-93"></a>        <span class="c1"># Calculate disparate impact ratios</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94" href="#__codelineno-0-94"></a>        <span class="n">disparate_impacts</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95" href="#__codelineno-0-95"></a>        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">group_outcomes</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96" href="#__codelineno-0-96"></a>            <span class="n">group_rate</span> <span class="o">=</span> <span class="n">group_outcomes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">group</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">]</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97" href="#__codelineno-0-97"></a>            <span class="k">if</span> <span class="n">reference_rate</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98" href="#__codelineno-0-98"></a>                <span class="n">disparate_impacts</span><span class="p">[</span><span class="n">group</span><span class="p">]</span> <span class="o">=</span> <span class="n">group_rate</span> <span class="o">/</span> <span class="n">reference_rate</span>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99" href="#__codelineno-0-99"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100" href="#__codelineno-0-100"></a>                <span class="n">disparate_impacts</span><span class="p">[</span><span class="n">group</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101" href="#__codelineno-0-101"></a>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102" href="#__codelineno-0-102"></a>        <span class="c1"># Identify groups with significant disparate impact (&lt; 0.8 or &gt; 1.25)</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103" href="#__codelineno-0-103"></a>        <span class="n">affected_groups</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104" href="#__codelineno-0-104"></a>            <span class="n">group</span> <span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">ratio</span> <span class="ow">in</span> <span class="n">disparate_impacts</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105" href="#__codelineno-0-105"></a>            <span class="k">if</span> <span class="n">ratio</span> <span class="o">&lt;</span> <span class="mf">0.8</span> <span class="ow">or</span> <span class="n">ratio</span> <span class="o">&gt;</span> <span class="mf">1.25</span>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106" href="#__codelineno-0-106"></a>        <span class="p">]</span>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107" href="#__codelineno-0-107"></a>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108" href="#__codelineno-0-108"></a>        <span class="n">max_disparity</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ratio</span><span class="p">)</span> <span class="k">for</span> <span class="n">ratio</span> <span class="ow">in</span> <span class="n">disparate_impacts</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109" href="#__codelineno-0-109"></a>        <span class="n">severity</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_disparity</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110" href="#__codelineno-0-110"></a>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111" href="#__codelineno-0-111"></a>        <span class="n">impact_desc</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Historical bias analysis reveals disparate impact ratios: </span><span class="si">{</span><span class="n">disparate_impacts</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112" href="#__codelineno-0-112"></a>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113" href="#__codelineno-0-113"></a>        <span class="n">mitigation</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114" href="#__codelineno-0-114"></a>            <span class="s2">&quot;Collect contemporary data to reduce historical bias&quot;</span><span class="p">,</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115" href="#__codelineno-0-115"></a>            <span class="s2">&quot;Apply bias-aware preprocessing techniques&quot;</span><span class="p">,</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116" href="#__codelineno-0-116"></a>            <span class="s2">&quot;Use fairness constraints during model training&quot;</span><span class="p">,</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117" href="#__codelineno-0-117"></a>            <span class="s2">&quot;Implement post-processing calibration&quot;</span><span class="p">,</span>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118" href="#__codelineno-0-118"></a>            <span class="s2">&quot;Consider synthetic data generation for balanced representation&quot;</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119" href="#__codelineno-0-119"></a>        <span class="p">]</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120" href="#__codelineno-0-120"></a>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121" href="#__codelineno-0-121"></a>        <span class="n">assessment</span> <span class="o">=</span> <span class="n">BiasAssessment</span><span class="p">(</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122" href="#__codelineno-0-122"></a>            <span class="n">bias_type</span><span class="o">=</span><span class="s2">&quot;historical&quot;</span><span class="p">,</span>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123" href="#__codelineno-0-123"></a>            <span class="n">severity_score</span><span class="o">=</span><span class="n">severity</span><span class="p">,</span>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124" href="#__codelineno-0-124"></a>            <span class="n">affected_groups</span><span class="o">=</span><span class="n">affected_groups</span><span class="p">,</span>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125" href="#__codelineno-0-125"></a>            <span class="n">impact_description</span><span class="o">=</span><span class="n">impact_desc</span><span class="p">,</span>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126" href="#__codelineno-0-126"></a>            <span class="n">mitigation_suggestions</span><span class="o">=</span><span class="n">mitigation</span>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127" href="#__codelineno-0-127"></a>        <span class="p">)</span>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128" href="#__codelineno-0-128"></a>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129" href="#__codelineno-0-129"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assessments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">assessment</span><span class="p">)</span>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130" href="#__codelineno-0-130"></a>        <span class="k">return</span> <span class="n">assessment</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131" href="#__codelineno-0-131"></a>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132" href="#__codelineno-0-132"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_labeler_bias</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">text_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BiasAssessment</span><span class="p">:</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133" href="#__codelineno-0-133"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134" href="#__codelineno-0-134"></a><span class="sd">        Analyze potential labeler bias through inter-annotator agreement and pattern analysis</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135" href="#__codelineno-0-135"></a>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136" href="#__codelineno-0-136"></a><span class="sd">        Args:</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137" href="#__codelineno-0-137"></a><span class="sd">            labels_df: DataFrame with columns for different annotators&#39; labels</span>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138" href="#__codelineno-0-138"></a><span class="sd">            text_data: Optional text data for content-based bias analysis</span>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139" href="#__codelineno-0-139"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140" href="#__codelineno-0-140"></a>        <span class="n">annotators</span> <span class="o">=</span> <span class="n">labels_df</span><span class="o">.</span><span class="n">columns</span>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141" href="#__codelineno-0-141"></a>        <span class="n">n_annotators</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">annotators</span><span class="p">)</span>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142" href="#__codelineno-0-142"></a>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143" href="#__codelineno-0-143"></a>        <span class="k">if</span> <span class="n">n_annotators</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144" href="#__codelineno-0-144"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Need at least 2 annotators to assess labeler bias&quot;</span><span class="p">)</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145" href="#__codelineno-0-145"></a>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146" href="#__codelineno-0-146"></a>        <span class="c1"># Calculate inter-annotator agreement</span>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147" href="#__codelineno-0-147"></a>        <span class="n">agreements</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148" href="#__codelineno-0-148"></a>        <span class="n">disagreement_patterns</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149" href="#__codelineno-0-149"></a>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150" href="#__codelineno-0-150"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels_df</span><span class="p">)):</span>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151" href="#__codelineno-0-151"></a>            <span class="n">row_labels</span> <span class="o">=</span> <span class="n">labels_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152" href="#__codelineno-0-152"></a>            <span class="n">unique_labels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">row_labels</span><span class="p">))</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153" href="#__codelineno-0-153"></a>            <span class="n">agreement_rate</span> <span class="o">=</span> <span class="p">(</span><span class="n">row_labels</span> <span class="o">==</span> <span class="n">row_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_labels</span><span class="p">)</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154" href="#__codelineno-0-154"></a>            <span class="n">agreements</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">agreement_rate</span><span class="p">)</span>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155" href="#__codelineno-0-155"></a>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156" href="#__codelineno-0-156"></a>            <span class="k">if</span> <span class="n">unique_labels</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157" href="#__codelineno-0-157"></a>                <span class="c1"># Track disagreement patterns</span>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158" href="#__codelineno-0-158"></a>                <span class="n">pattern</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">row_labels</span><span class="p">))</span>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159" href="#__codelineno-0-159"></a>                <span class="n">disagreement_patterns</span><span class="p">[</span><span class="n">pattern</span><span class="p">]</span> <span class="o">=</span> <span class="n">disagreement_patterns</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160" href="#__codelineno-0-160"></a>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161" href="#__codelineno-0-161"></a>        <span class="n">avg_agreement</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">agreements</span><span class="p">)</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162" href="#__codelineno-0-162"></a>        <span class="n">severity</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">avg_agreement</span>  <span class="c1"># Higher disagreement = higher bias risk</span>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163" href="#__codelineno-0-163"></a>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164" href="#__codelineno-0-164"></a>        <span class="c1"># Identify potential systematic biases</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165" href="#__codelineno-0-165"></a>        <span class="n">affected_groups</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166" href="#__codelineno-0-166"></a>        <span class="k">if</span> <span class="n">text_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167" href="#__codelineno-0-167"></a>            <span class="c1"># Analyze if disagreements correlate with text characteristics</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168" href="#__codelineno-0-168"></a>            <span class="c1"># This is a simplified example - real implementation would be more sophisticated</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169" href="#__codelineno-0-169"></a>            <span class="n">high_disagreement_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">agree</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">agreements</span><span class="p">)</span> <span class="k">if</span> <span class="n">agree</span> <span class="o">&lt;</span> <span class="mf">0.7</span><span class="p">]</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170" href="#__codelineno-0-170"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">high_disagreement_indices</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">agreements</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">:</span>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171" href="#__codelineno-0-171"></a>                <span class="n">affected_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;high_disagreement_content&quot;</span><span class="p">)</span>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172" href="#__codelineno-0-172"></a>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173" href="#__codelineno-0-173"></a>        <span class="n">impact_desc</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Labeler bias analysis: </span><span class="si">{</span><span class="n">avg_agreement</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> average agreement, &quot;</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174" href="#__codelineno-0-174"></a>        <span class="n">impact_desc</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">disagreement_patterns</span><span class="p">)</span><span class="si">}</span><span class="s2"> disagreement patterns detected&quot;</span>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175" href="#__codelineno-0-175"></a>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176" href="#__codelineno-0-176"></a>        <span class="n">mitigation</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177" href="#__codelineno-0-177"></a>            <span class="s2">&quot;Provide comprehensive annotation guidelines&quot;</span><span class="p">,</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178" href="#__codelineno-0-178"></a>            <span class="s2">&quot;Implement regular inter-annotator agreement checks&quot;</span><span class="p">,</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179" href="#__codelineno-0-179"></a>            <span class="s2">&quot;Use multiple annotators with majority voting&quot;</span><span class="p">,</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180" href="#__codelineno-0-180"></a>            <span class="s2">&quot;Apply bias-aware label aggregation methods&quot;</span><span class="p">,</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181" href="#__codelineno-0-181"></a>            <span class="s2">&quot;Provide annotator training on potential biases&quot;</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182" href="#__codelineno-0-182"></a>        <span class="p">]</span>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183" href="#__codelineno-0-183"></a>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184" href="#__codelineno-0-184"></a>        <span class="n">assessment</span> <span class="o">=</span> <span class="n">BiasAssessment</span><span class="p">(</span>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185" href="#__codelineno-0-185"></a>            <span class="n">bias_type</span><span class="o">=</span><span class="s2">&quot;labeler&quot;</span><span class="p">,</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186" href="#__codelineno-0-186"></a>            <span class="n">severity_score</span><span class="o">=</span><span class="n">severity</span><span class="p">,</span>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187" href="#__codelineno-0-187"></a>            <span class="n">affected_groups</span><span class="o">=</span><span class="n">affected_groups</span><span class="p">,</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188" href="#__codelineno-0-188"></a>            <span class="n">impact_description</span><span class="o">=</span><span class="n">impact_desc</span><span class="p">,</span>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189" href="#__codelineno-0-189"></a>            <span class="n">mitigation_suggestions</span><span class="o">=</span><span class="n">mitigation</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190" href="#__codelineno-0-190"></a>        <span class="p">)</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191" href="#__codelineno-0-191"></a>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192" href="#__codelineno-0-192"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assessments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">assessment</span><span class="p">)</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193" href="#__codelineno-0-193"></a>        <span class="k">return</span> <span class="n">assessment</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194" href="#__codelineno-0-194"></a>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195" href="#__codelineno-0-195"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_population_drift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">train_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">test_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196" href="#__codelineno-0-196"></a>                               <span class="n">demographic_cols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">BiasAssessment</span><span class="p">:</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197" href="#__codelineno-0-197"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198" href="#__codelineno-0-198"></a><span class="sd">        Analyze population drift between training and deployment populations</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199" href="#__codelineno-0-199"></a>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200" href="#__codelineno-0-200"></a><span class="sd">        Args:</span>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201" href="#__codelineno-0-201"></a><span class="sd">            train_data: Training dataset</span>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202" href="#__codelineno-0-202"></a><span class="sd">            test_data: Test/deployment dataset</span>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203" href="#__codelineno-0-203"></a><span class="sd">            demographic_cols: List of demographic columns to analyze</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204" href="#__codelineno-0-204"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205" href="#__codelineno-0-205"></a>        <span class="n">drift_scores</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206" href="#__codelineno-0-206"></a>        <span class="n">affected_groups</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207" href="#__codelineno-0-207"></a>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208" href="#__codelineno-0-208"></a>        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">demographic_cols</span><span class="p">:</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209" href="#__codelineno-0-209"></a>            <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">train_data</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">test_data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210" href="#__codelineno-0-210"></a>                <span class="c1"># Calculate distribution differences</span>
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211" href="#__codelineno-0-211"></a>                <span class="n">train_dist</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212" href="#__codelineno-0-212"></a>                <span class="n">test_dist</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213" href="#__codelineno-0-213"></a>
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214" href="#__codelineno-0-214"></a>                <span class="c1"># Align distributions for comparison</span>
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215" href="#__codelineno-0-215"></a>                <span class="n">all_categories</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">train_dist</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">test_dist</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216" href="#__codelineno-0-216"></a>                <span class="n">train_aligned</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">all_categories</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217" href="#__codelineno-0-217"></a>                <span class="n">test_aligned</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">all_categories</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218" href="#__codelineno-0-218"></a>
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219" href="#__codelineno-0-219"></a>                <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">all_categories</span><span class="p">:</span>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220" href="#__codelineno-0-220"></a>                    <span class="n">train_aligned</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_dist</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cat</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221" href="#__codelineno-0-221"></a>                    <span class="n">test_aligned</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_dist</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cat</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222" href="#__codelineno-0-222"></a>
</span><span id="__span-0-223"><a id="__codelineno-0-223" name="__codelineno-0-223" href="#__codelineno-0-223"></a>                <span class="c1"># Calculate KL divergence or similar metric</span>
</span><span id="__span-0-224"><a id="__codelineno-0-224" name="__codelineno-0-224" href="#__codelineno-0-224"></a>                <span class="n">drift_score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">train_aligned</span> <span class="o">-</span> <span class="n">test_aligned</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># Total variation distance</span>
</span><span id="__span-0-225"><a id="__codelineno-0-225" name="__codelineno-0-225" href="#__codelineno-0-225"></a>                <span class="n">drift_scores</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">drift_score</span>
</span><span id="__span-0-226"><a id="__codelineno-0-226" name="__codelineno-0-226" href="#__codelineno-0-226"></a>
</span><span id="__span-0-227"><a id="__codelineno-0-227" name="__codelineno-0-227" href="#__codelineno-0-227"></a>                <span class="k">if</span> <span class="n">drift_score</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">:</span>  <span class="c1"># Threshold for significant drift</span>
</span><span id="__span-0-228"><a id="__codelineno-0-228" name="__codelineno-0-228" href="#__codelineno-0-228"></a>                    <span class="n">affected_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
</span><span id="__span-0-229"><a id="__codelineno-0-229" name="__codelineno-0-229" href="#__codelineno-0-229"></a>
</span><span id="__span-0-230"><a id="__codelineno-0-230" name="__codelineno-0-230" href="#__codelineno-0-230"></a>        <span class="n">max_drift</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">drift_scores</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="k">if</span> <span class="n">drift_scores</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-0-231"><a id="__codelineno-0-231" name="__codelineno-0-231" href="#__codelineno-0-231"></a>        <span class="n">severity</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_drift</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
</span><span id="__span-0-232"><a id="__codelineno-0-232" name="__codelineno-0-232" href="#__codelineno-0-232"></a>
</span><span id="__span-0-233"><a id="__codelineno-0-233" name="__codelineno-0-233" href="#__codelineno-0-233"></a>        <span class="n">impact_desc</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Population drift detected with scores: </span><span class="si">{</span><span class="n">drift_scores</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-234"><a id="__codelineno-0-234" name="__codelineno-0-234" href="#__codelineno-0-234"></a>
</span><span id="__span-0-235"><a id="__codelineno-0-235" name="__codelineno-0-235" href="#__codelineno-0-235"></a>        <span class="n">mitigation</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-0-236"><a id="__codelineno-0-236" name="__codelineno-0-236" href="#__codelineno-0-236"></a>            <span class="s2">&quot;Implement continuous monitoring of population characteristics&quot;</span><span class="p">,</span>
</span><span id="__span-0-237"><a id="__codelineno-0-237" name="__codelineno-0-237" href="#__codelineno-0-237"></a>            <span class="s2">&quot;Regular model retraining with current data&quot;</span><span class="p">,</span>
</span><span id="__span-0-238"><a id="__codelineno-0-238" name="__codelineno-0-238" href="#__codelineno-0-238"></a>            <span class="s2">&quot;Use domain adaptation techniques&quot;</span><span class="p">,</span>
</span><span id="__span-0-239"><a id="__codelineno-0-239" name="__codelineno-0-239" href="#__codelineno-0-239"></a>            <span class="s2">&quot;Apply online learning methods&quot;</span><span class="p">,</span>
</span><span id="__span-0-240"><a id="__codelineno-0-240" name="__codelineno-0-240" href="#__codelineno-0-240"></a>            <span class="s2">&quot;Implement drift detection alerts&quot;</span>
</span><span id="__span-0-241"><a id="__codelineno-0-241" name="__codelineno-0-241" href="#__codelineno-0-241"></a>        <span class="p">]</span>
</span><span id="__span-0-242"><a id="__codelineno-0-242" name="__codelineno-0-242" href="#__codelineno-0-242"></a>
</span><span id="__span-0-243"><a id="__codelineno-0-243" name="__codelineno-0-243" href="#__codelineno-0-243"></a>        <span class="n">assessment</span> <span class="o">=</span> <span class="n">BiasAssessment</span><span class="p">(</span>
</span><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244" href="#__codelineno-0-244"></a>            <span class="n">bias_type</span><span class="o">=</span><span class="s2">&quot;population_drift&quot;</span><span class="p">,</span>
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245" href="#__codelineno-0-245"></a>            <span class="n">severity_score</span><span class="o">=</span><span class="n">severity</span><span class="p">,</span>
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246" href="#__codelineno-0-246"></a>            <span class="n">affected_groups</span><span class="o">=</span><span class="n">affected_groups</span><span class="p">,</span>
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247" href="#__codelineno-0-247"></a>            <span class="n">impact_description</span><span class="o">=</span><span class="n">impact_desc</span><span class="p">,</span>
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248" href="#__codelineno-0-248"></a>            <span class="n">mitigation_suggestions</span><span class="o">=</span><span class="n">mitigation</span>
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249" href="#__codelineno-0-249"></a>        <span class="p">)</span>
</span><span id="__span-0-250"><a id="__codelineno-0-250" name="__codelineno-0-250" href="#__codelineno-0-250"></a>
</span><span id="__span-0-251"><a id="__codelineno-0-251" name="__codelineno-0-251" href="#__codelineno-0-251"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assessments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">assessment</span><span class="p">)</span>
</span><span id="__span-0-252"><a id="__codelineno-0-252" name="__codelineno-0-252" href="#__codelineno-0-252"></a>        <span class="k">return</span> <span class="n">assessment</span>
</span><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253" href="#__codelineno-0-253"></a>
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254" href="#__codelineno-0-254"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate_bias_report</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="__span-0-255"><a id="__codelineno-0-255" name="__codelineno-0-255" href="#__codelineno-0-255"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate comprehensive bias assessment report&quot;&quot;&quot;</span>
</span><span id="__span-0-256"><a id="__codelineno-0-256" name="__codelineno-0-256" href="#__codelineno-0-256"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">assessments</span><span class="p">:</span>
</span><span id="__span-0-257"><a id="__codelineno-0-257" name="__codelineno-0-257" href="#__codelineno-0-257"></a>            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;No bias assessments performed&quot;</span><span class="p">}</span>
</span><span id="__span-0-258"><a id="__codelineno-0-258" name="__codelineno-0-258" href="#__codelineno-0-258"></a>
</span><span id="__span-0-259"><a id="__codelineno-0-259" name="__codelineno-0-259" href="#__codelineno-0-259"></a>        <span class="n">report</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-260"><a id="__codelineno-0-260" name="__codelineno-0-260" href="#__codelineno-0-260"></a>            <span class="s2">&quot;total_assessments&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">assessments</span><span class="p">),</span>
</span><span id="__span-0-261"><a id="__codelineno-0-261" name="__codelineno-0-261" href="#__codelineno-0-261"></a>            <span class="s2">&quot;bias_types_analyzed&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">bias_type</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">assessments</span><span class="p">],</span>
</span><span id="__span-0-262"><a id="__codelineno-0-262" name="__codelineno-0-262" href="#__codelineno-0-262"></a>            <span class="s2">&quot;overall_severity&quot;</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">severity_score</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">assessments</span><span class="p">),</span>
</span><span id="__span-0-263"><a id="__codelineno-0-263" name="__codelineno-0-263" href="#__codelineno-0-263"></a>            <span class="s2">&quot;critical_biases&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">assessments</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">severity_score</span> <span class="o">&gt;</span> <span class="mf">0.7</span><span class="p">],</span>
</span><span id="__span-0-264"><a id="__codelineno-0-264" name="__codelineno-0-264" href="#__codelineno-0-264"></a>            <span class="s2">&quot;all_affected_groups&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span>
</span><span id="__span-0-265"><a id="__codelineno-0-265" name="__codelineno-0-265" href="#__codelineno-0-265"></a>                <span class="n">group</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">assessments</span> <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">affected_groups</span>
</span><span id="__span-0-266"><a id="__codelineno-0-266" name="__codelineno-0-266" href="#__codelineno-0-266"></a>            <span class="p">)),</span>
</span><span id="__span-0-267"><a id="__codelineno-0-267" name="__codelineno-0-267" href="#__codelineno-0-267"></a>            <span class="s2">&quot;comprehensive_mitigations&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span>
</span><span id="__span-0-268"><a id="__codelineno-0-268" name="__codelineno-0-268" href="#__codelineno-0-268"></a>                <span class="n">suggestion</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">assessments</span> <span class="k">for</span> <span class="n">suggestion</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">mitigation_suggestions</span>
</span><span id="__span-0-269"><a id="__codelineno-0-269" name="__codelineno-0-269" href="#__codelineno-0-269"></a>            <span class="p">)),</span>
</span><span id="__span-0-270"><a id="__codelineno-0-270" name="__codelineno-0-270" href="#__codelineno-0-270"></a>            <span class="s2">&quot;detailed_assessments&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">assessments</span>
</span><span id="__span-0-271"><a id="__codelineno-0-271" name="__codelineno-0-271" href="#__codelineno-0-271"></a>        <span class="p">}</span>
</span><span id="__span-0-272"><a id="__codelineno-0-272" name="__codelineno-0-272" href="#__codelineno-0-272"></a>
</span><span id="__span-0-273"><a id="__codelineno-0-273" name="__codelineno-0-273" href="#__codelineno-0-273"></a>        <span class="k">return</span> <span class="n">report</span>
</span><span id="__span-0-274"><a id="__codelineno-0-274" name="__codelineno-0-274" href="#__codelineno-0-274"></a>
</span><span id="__span-0-275"><a id="__codelineno-0-275" name="__codelineno-0-275" href="#__codelineno-0-275"></a><span class="c1"># Demonstration function</span>
</span><span id="__span-0-276"><a id="__codelineno-0-276" name="__codelineno-0-276" href="#__codelineno-0-276"></a><span class="k">def</span><span class="w"> </span><span class="nf">demonstrate_bias_analysis</span><span class="p">():</span>
</span><span id="__span-0-277"><a id="__codelineno-0-277" name="__codelineno-0-277" href="#__codelineno-0-277"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrate bias source analysis with synthetic data&quot;&quot;&quot;</span>
</span><span id="__span-0-278"><a id="__codelineno-0-278" name="__codelineno-0-278" href="#__codelineno-0-278"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Bias Source Analysis Demonstration ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-279"><a id="__codelineno-0-279" name="__codelineno-0-279" href="#__codelineno-0-279"></a>
</span><span id="__span-0-280"><a id="__codelineno-0-280" name="__codelineno-0-280" href="#__codelineno-0-280"></a>    <span class="c1"># Create synthetic biased dataset</span>
</span><span id="__span-0-281"><a id="__codelineno-0-281" name="__codelineno-0-281" href="#__codelineno-0-281"></a>    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
</span><span id="__span-0-282"><a id="__codelineno-0-282" name="__codelineno-0-282" href="#__codelineno-0-282"></a>    <span class="n">n_samples</span> <span class="o">=</span> <span class="mi">1000</span>
</span><span id="__span-0-283"><a id="__codelineno-0-283" name="__codelineno-0-283" href="#__codelineno-0-283"></a>
</span><span id="__span-0-284"><a id="__codelineno-0-284" name="__codelineno-0-284" href="#__codelineno-0-284"></a>    <span class="c1"># Simulate sampling bias (gender imbalance)</span>
</span><span id="__span-0-285"><a id="__codelineno-0-285" name="__codelineno-0-285" href="#__codelineno-0-285"></a>    <span class="n">gender</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">],</span> <span class="n">n_samples</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>  <span class="c1"># 80% male, 20% female</span>
</span><span id="__span-0-286"><a id="__codelineno-0-286" name="__codelineno-0-286" href="#__codelineno-0-286"></a>
</span><span id="__span-0-287"><a id="__codelineno-0-287" name="__codelineno-0-287" href="#__codelineno-0-287"></a>    <span class="c1"># Simulate historical bias (salary gaps)</span>
</span><span id="__span-0-288"><a id="__codelineno-0-288" name="__codelineno-0-288" href="#__codelineno-0-288"></a>    <span class="n">base_salary</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">50000</span><span class="p">,</span> <span class="mi">15000</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span>
</span><span id="__span-0-289"><a id="__codelineno-0-289" name="__codelineno-0-289" href="#__codelineno-0-289"></a>    <span class="c1"># Historical bias: lower salaries for females</span>
</span><span id="__span-0-290"><a id="__codelineno-0-290" name="__codelineno-0-290" href="#__codelineno-0-290"></a>    <span class="n">salary</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">gender</span> <span class="o">==</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="n">base_salary</span> <span class="o">*</span> <span class="mf">0.85</span><span class="p">,</span> <span class="n">base_salary</span><span class="p">)</span>
</span><span id="__span-0-291"><a id="__codelineno-0-291" name="__codelineno-0-291" href="#__codelineno-0-291"></a>
</span><span id="__span-0-292"><a id="__codelineno-0-292" name="__codelineno-0-292" href="#__codelineno-0-292"></a>    <span class="c1"># Create dataset</span>
</span><span id="__span-0-293"><a id="__codelineno-0-293" name="__codelineno-0-293" href="#__codelineno-0-293"></a>    <span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
</span><span id="__span-0-294"><a id="__codelineno-0-294" name="__codelineno-0-294" href="#__codelineno-0-294"></a>        <span class="s1">&#39;gender&#39;</span><span class="p">:</span> <span class="n">gender</span><span class="p">,</span>
</span><span id="__span-0-295"><a id="__codelineno-0-295" name="__codelineno-0-295" href="#__codelineno-0-295"></a>        <span class="s1">&#39;salary&#39;</span><span class="p">:</span> <span class="n">salary</span><span class="p">,</span>
</span><span id="__span-0-296"><a id="__codelineno-0-296" name="__codelineno-0-296" href="#__codelineno-0-296"></a>        <span class="s1">&#39;promotion&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">gender</span> <span class="o">==</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="n">n_samples</span><span class="p">)</span>
</span><span id="__span-0-297"><a id="__codelineno-0-297" name="__codelineno-0-297" href="#__codelineno-0-297"></a>    <span class="p">})</span>
</span><span id="__span-0-298"><a id="__codelineno-0-298" name="__codelineno-0-298" href="#__codelineno-0-298"></a>
</span><span id="__span-0-299"><a id="__codelineno-0-299" name="__codelineno-0-299" href="#__codelineno-0-299"></a>    <span class="n">analyzer</span> <span class="o">=</span> <span class="n">BiasSourceAnalyzer</span><span class="p">()</span>
</span><span id="__span-0-300"><a id="__codelineno-0-300" name="__codelineno-0-300" href="#__codelineno-0-300"></a>
</span><span id="__span-0-301"><a id="__codelineno-0-301" name="__codelineno-0-301" href="#__codelineno-0-301"></a>    <span class="c1"># Analyze sampling bias</span>
</span><span id="__span-0-302"><a id="__codelineno-0-302" name="__codelineno-0-302" href="#__codelineno-0-302"></a>    <span class="n">expected_gender_dist</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">}</span>  <span class="c1"># Expected 50-50 split</span>
</span><span id="__span-0-303"><a id="__codelineno-0-303" name="__codelineno-0-303" href="#__codelineno-0-303"></a>    <span class="n">sampling_assessment</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">analyze_sampling_bias</span><span class="p">(</span>
</span><span id="__span-0-304"><a id="__codelineno-0-304" name="__codelineno-0-304" href="#__codelineno-0-304"></a>        <span class="n">dataset</span><span class="p">,</span> <span class="s1">&#39;gender&#39;</span><span class="p">,</span> <span class="n">expected_gender_dist</span>
</span><span id="__span-0-305"><a id="__codelineno-0-305" name="__codelineno-0-305" href="#__codelineno-0-305"></a>    <span class="p">)</span>
</span><span id="__span-0-306"><a id="__codelineno-0-306" name="__codelineno-0-306" href="#__codelineno-0-306"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sampling Bias Assessment:&quot;</span><span class="p">)</span>
</span><span id="__span-0-307"><a id="__codelineno-0-307" name="__codelineno-0-307" href="#__codelineno-0-307"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Severity: </span><span class="si">{</span><span class="n">sampling_assessment</span><span class="o">.</span><span class="n">severity_score</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-308"><a id="__codelineno-0-308" name="__codelineno-0-308" href="#__codelineno-0-308"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Impact: </span><span class="si">{</span><span class="n">sampling_assessment</span><span class="o">.</span><span class="n">impact_description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-309"><a id="__codelineno-0-309" name="__codelineno-0-309" href="#__codelineno-0-309"></a>    <span class="nb">print</span><span class="p">()</span>
</span><span id="__span-0-310"><a id="__codelineno-0-310" name="__codelineno-0-310" href="#__codelineno-0-310"></a>
</span><span id="__span-0-311"><a id="__codelineno-0-311" name="__codelineno-0-311" href="#__codelineno-0-311"></a>    <span class="c1"># Analyze historical bias</span>
</span><span id="__span-0-312"><a id="__codelineno-0-312" name="__codelineno-0-312" href="#__codelineno-0-312"></a>    <span class="n">historical_assessment</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">analyze_historical_bias</span><span class="p">(</span>
</span><span id="__span-0-313"><a id="__codelineno-0-313" name="__codelineno-0-313" href="#__codelineno-0-313"></a>        <span class="n">dataset</span><span class="p">,</span> <span class="s1">&#39;gender&#39;</span><span class="p">,</span> <span class="s1">&#39;promotion&#39;</span>
</span><span id="__span-0-314"><a id="__codelineno-0-314" name="__codelineno-0-314" href="#__codelineno-0-314"></a>    <span class="p">)</span>
</span><span id="__span-0-315"><a id="__codelineno-0-315" name="__codelineno-0-315" href="#__codelineno-0-315"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Historical Bias Assessment:&quot;</span><span class="p">)</span>
</span><span id="__span-0-316"><a id="__codelineno-0-316" name="__codelineno-0-316" href="#__codelineno-0-316"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Severity: </span><span class="si">{</span><span class="n">historical_assessment</span><span class="o">.</span><span class="n">severity_score</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-317"><a id="__codelineno-0-317" name="__codelineno-0-317" href="#__codelineno-0-317"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Impact: </span><span class="si">{</span><span class="n">historical_assessment</span><span class="o">.</span><span class="n">impact_description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-318"><a id="__codelineno-0-318" name="__codelineno-0-318" href="#__codelineno-0-318"></a>    <span class="nb">print</span><span class="p">()</span>
</span><span id="__span-0-319"><a id="__codelineno-0-319" name="__codelineno-0-319" href="#__codelineno-0-319"></a>
</span><span id="__span-0-320"><a id="__codelineno-0-320" name="__codelineno-0-320" href="#__codelineno-0-320"></a>    <span class="c1"># Generate comprehensive report</span>
</span><span id="__span-0-321"><a id="__codelineno-0-321" name="__codelineno-0-321" href="#__codelineno-0-321"></a>    <span class="n">report</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">generate_bias_report</span><span class="p">()</span>
</span><span id="__span-0-322"><a id="__codelineno-0-322" name="__codelineno-0-322" href="#__codelineno-0-322"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Overall Bias Report:&quot;</span><span class="p">)</span>
</span><span id="__span-0-323"><a id="__codelineno-0-323" name="__codelineno-0-323" href="#__codelineno-0-323"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Total assessments: </span><span class="si">{</span><span class="n">report</span><span class="p">[</span><span class="s1">&#39;total_assessments&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-324"><a id="__codelineno-0-324" name="__codelineno-0-324" href="#__codelineno-0-324"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Overall severity: </span><span class="si">{</span><span class="n">report</span><span class="p">[</span><span class="s1">&#39;overall_severity&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-325"><a id="__codelineno-0-325" name="__codelineno-0-325" href="#__codelineno-0-325"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Critical biases: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">report</span><span class="p">[</span><span class="s1">&#39;critical_biases&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-326"><a id="__codelineno-0-326" name="__codelineno-0-326" href="#__codelineno-0-326"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Affected groups: </span><span class="si">{</span><span class="n">report</span><span class="p">[</span><span class="s1">&#39;all_affected_groups&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-327"><a id="__codelineno-0-327" name="__codelineno-0-327" href="#__codelineno-0-327"></a>
</span><span id="__span-0-328"><a id="__codelineno-0-328" name="__codelineno-0-328" href="#__codelineno-0-328"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-0-329"><a id="__codelineno-0-329" name="__codelineno-0-329" href="#__codelineno-0-329"></a>    <span class="n">demonstrate_bias_analysis</span><span class="p">()</span>
</span></code></pre></div>
<h3 id="12-bias-detection-workflow">1.2 Bias Detection Workflow<a class="headerlink" href="#12-bias-detection-workflow" title="Permanent link">&para;</a></h3>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python"><span class="k">def</span><span class="w"> </span><span class="nf">create_bias_detection_pipeline</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a systematic pipeline for bias detection in ML workflows&quot;&quot;&quot;</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">BiasDetectionPipeline</span><span class="p">:</span>
        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">detection_stages</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;data_collection_review&quot;</span><span class="p">,</span>
                <span class="s2">&quot;dataset_composition_analysis&quot;</span><span class="p">,</span> 
                <span class="s2">&quot;labeling_process_audit&quot;</span><span class="p">,</span>
                <span class="s2">&quot;model_performance_evaluation&quot;</span><span class="p">,</span>
                <span class="s2">&quot;deployment_monitoring&quot;</span>
            <span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bias_checkpoints</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">stage_1_data_collection_review</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection_metadata</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Review data collection methodology for potential bias sources&quot;&quot;&quot;</span>
            <span class="n">review_results</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;collection_method&quot;</span><span class="p">:</span> <span class="n">collection_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;method&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">),</span>
                <span class="s2">&quot;sampling_strategy&quot;</span><span class="p">:</span> <span class="n">collection_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sampling&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">),</span>
                <span class="s2">&quot;time_period&quot;</span><span class="p">:</span> <span class="n">collection_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;timeframe&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">),</span>
                <span class="s2">&quot;geographic_coverage&quot;</span><span class="p">:</span> <span class="n">collection_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;geography&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">),</span>
                <span class="s2">&quot;potential_biases&quot;</span><span class="p">:</span> <span class="p">[]</span>
            <span class="p">}</span>

            <span class="c1"># Check for common collection biases</span>
            <span class="k">if</span> <span class="n">review_results</span><span class="p">[</span><span class="s2">&quot;sampling_strategy&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;convenience&quot;</span><span class="p">:</span>
                <span class="n">review_results</span><span class="p">[</span><span class="s2">&quot;potential_biases&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;convenience_sampling_bias&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">review_results</span><span class="p">[</span><span class="s2">&quot;geographic_coverage&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;limited&quot;</span><span class="p">:</span>
                <span class="n">review_results</span><span class="p">[</span><span class="s2">&quot;potential_biases&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;geographic_bias&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">review_results</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">stage_2_dataset_composition_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> 
                                               <span class="n">protected_attributes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Analyze dataset composition for representational biases&quot;&quot;&quot;</span>
            <span class="n">composition_analysis</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;total_samples&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">),</span>
                <span class="s2">&quot;attribute_distributions&quot;</span><span class="p">:</span> <span class="p">{},</span>
                <span class="s2">&quot;missing_data_patterns&quot;</span><span class="p">:</span> <span class="p">{},</span>
                <span class="s2">&quot;correlation_analysis&quot;</span><span class="p">:</span> <span class="p">{}</span>
            <span class="p">}</span>

            <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">protected_attributes</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                    <span class="c1"># Distribution analysis</span>
                    <span class="n">dist</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="n">composition_analysis</span><span class="p">[</span><span class="s2">&quot;attribute_distributions&quot;</span><span class="p">][</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

                    <span class="c1"># Missing data analysis</span>
                    <span class="n">missing_rate</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                    <span class="n">composition_analysis</span><span class="p">[</span><span class="s2">&quot;missing_data_patterns&quot;</span><span class="p">][</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="n">missing_rate</span>

            <span class="k">return</span> <span class="n">composition_analysis</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">run_full_pipeline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">metadata</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> 
                            <span class="n">protected_attrs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Run complete bias detection pipeline&quot;&quot;&quot;</span>
            <span class="n">pipeline_results</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="c1"># Stage 1: Data collection review</span>
            <span class="n">pipeline_results</span><span class="p">[</span><span class="s2">&quot;collection_review&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stage_1_data_collection_review</span><span class="p">(</span><span class="n">metadata</span><span class="p">)</span>

            <span class="c1"># Stage 2: Dataset composition analysis  </span>
            <span class="n">pipeline_results</span><span class="p">[</span><span class="s2">&quot;composition_analysis&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stage_2_dataset_composition_analysis</span><span class="p">(</span>
                <span class="n">dataset</span><span class="p">,</span> <span class="n">protected_attrs</span>
            <span class="p">)</span>

            <span class="c1"># Aggregate findings</span>
            <span class="n">all_biases</span> <span class="o">=</span> <span class="n">pipeline_results</span><span class="p">[</span><span class="s2">&quot;collection_review&quot;</span><span class="p">][</span><span class="s2">&quot;potential_biases&quot;</span><span class="p">]</span>

            <span class="n">pipeline_results</span><span class="p">[</span><span class="s2">&quot;summary&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;total_bias_indicators&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_biases</span><span class="p">),</span>
                <span class="s2">&quot;bias_types_found&quot;</span><span class="p">:</span> <span class="n">all_biases</span><span class="p">,</span>
                <span class="s2">&quot;severity_assessment&quot;</span><span class="p">:</span> <span class="s2">&quot;high&quot;</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_biases</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="k">else</span> <span class="s2">&quot;moderate&quot;</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_biases</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;low&quot;</span><span class="p">,</span>
                <span class="s2">&quot;recommendations&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_recommendations</span><span class="p">(</span><span class="n">all_biases</span><span class="p">)</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="n">pipeline_results</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_generate_recommendations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bias_indicators</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Generate recommendations based on detected bias indicators&quot;&quot;&quot;</span>
            <span class="n">recommendations</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">if</span> <span class="s2">&quot;convenience_sampling_bias&quot;</span> <span class="ow">in</span> <span class="n">bias_indicators</span><span class="p">:</span>
                <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Implement stratified random sampling&quot;</span><span class="p">)</span>
                <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Ensure diverse recruitment channels&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="s2">&quot;geographic_bias&quot;</span> <span class="ow">in</span> <span class="n">bias_indicators</span><span class="p">:</span>
                <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Expand data collection to multiple regions&quot;</span><span class="p">)</span>
                <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Weight samples by population demographics&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">recommendations</span><span class="p">:</span>
                <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Continue monitoring for emerging biases&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">recommendations</span>

    <span class="k">return</span> <span class="n">BiasDetectionPipeline</span><span class="p">()</span>

<span class="c1"># Example usage</span>
<span class="k">def</span><span class="w"> </span><span class="nf">demonstrate_bias_detection_pipeline</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrate the bias detection pipeline&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Bias Detection Pipeline Demonstration ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Create sample dataset and metadata</span>
    <span class="n">sample_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">500</span><span class="p">),</span>
        <span class="s1">&#39;gender&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">],</span> <span class="mi">500</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]),</span>
        <span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;urban&#39;</span><span class="p">,</span> <span class="s1">&#39;rural&#39;</span><span class="p">],</span> <span class="mi">500</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]),</span>
        <span class="s1">&#39;outcome&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
    <span class="p">})</span>

    <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;online_survey&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sampling&quot;</span><span class="p">:</span> <span class="s2">&quot;convenience&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;timeframe&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-Q1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;geography&quot;</span><span class="p">:</span> <span class="s2">&quot;limited&quot;</span>
    <span class="p">}</span>

    <span class="n">pipeline</span> <span class="o">=</span> <span class="n">create_bias_detection_pipeline</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">run_full_pipeline</span><span class="p">(</span>
        <span class="n">sample_data</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">,</span> <span class="s1">&#39;location&#39;</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pipeline Results:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Bias indicators found: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">][</span><span class="s1">&#39;total_bias_indicators&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Severity: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">][</span><span class="s1">&#39;severity_assessment&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Bias types: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">][</span><span class="s1">&#39;bias_types_found&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Recommendations: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">][</span><span class="s1">&#39;recommendations&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">demonstrate_bias_detection_pipeline</span><span class="p">()</span>
</code></pre>
</div>
<h2 id="part-2-practical-bias-investigation-tools">Part 2: Practical Bias Investigation Tools<a class="headerlink" href="#part-2-practical-bias-investigation-tools" title="Permanent link">&para;</a></h2>
<p>Now I&rsquo;ll implement comprehensive tools for investigating bias through dataset provenance, missing groups detection, and measurement bias assessment.</p>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python"><span class="k">class</span><span class="w"> </span><span class="nc">DatasetProvenanceAnalyzer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Tools for analyzing dataset provenance and potential bias introduction points&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">provenance_metadata</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bias_risk_factors</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;data_source&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;web_scraping&#39;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span>  <span class="c1"># High risk due to selection bias</span>
                <span class="s1">&#39;surveys&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>        <span class="c1"># Moderate risk due to response bias</span>
                <span class="s1">&#39;administrative&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>  <span class="c1"># Lower risk but historical bias possible</span>
                <span class="s1">&#39;sensors&#39;</span><span class="p">:</span> <span class="mf">0.2</span>          <span class="c1"># Low risk for bias but can have measurement bias</span>
            <span class="p">},</span>
            <span class="s1">&#39;collection_method&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;convenience&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
                <span class="s1">&#39;voluntary&#39;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span>
                <span class="s1">&#39;random&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
                <span class="s1">&#39;stratified&#39;</span><span class="p">:</span> <span class="mf">0.1</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_data_lineage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_metadata</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Analyze data lineage to identify potential bias introduction points</span>

<span class="sd">        Args:</span>
<span class="sd">            dataset_metadata: Metadata about dataset creation and processing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lineage_analysis</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;source_analysis&#39;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s1">&#39;transformation_risks&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;bias_risk_score&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
            <span class="s1">&#39;recommendations&#39;</span><span class="p">:</span> <span class="p">[]</span>
        <span class="p">}</span>

        <span class="c1"># Analyze data sources</span>
        <span class="n">sources</span> <span class="o">=</span> <span class="n">dataset_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sources&#39;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">total_source_risk</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">:</span>
            <span class="n">source_type</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;unknown&#39;</span><span class="p">)</span>
            <span class="n">collection_method</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;collection_method&#39;</span><span class="p">,</span> <span class="s1">&#39;unknown&#39;</span><span class="p">)</span>

            <span class="n">source_risk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias_risk_factors</span><span class="p">[</span><span class="s1">&#39;data_source&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">source_type</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
            <span class="n">method_risk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias_risk_factors</span><span class="p">[</span><span class="s1">&#39;collection_method&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">collection_method</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>

            <span class="n">combined_risk</span> <span class="o">=</span> <span class="p">(</span><span class="n">source_risk</span> <span class="o">+</span> <span class="n">method_risk</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="n">total_source_risk</span> <span class="o">+=</span> <span class="n">combined_risk</span>

            <span class="n">lineage_analysis</span><span class="p">[</span><span class="s1">&#39;source_analysis&#39;</span><span class="p">][</span><span class="n">source</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;unnamed&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">source_type</span><span class="p">,</span>
                <span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="n">collection_method</span><span class="p">,</span>
                <span class="s1">&#39;risk_score&#39;</span><span class="p">:</span> <span class="n">combined_risk</span><span class="p">,</span>
                <span class="s1">&#39;bias_indicators&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_identify_source_bias_indicators</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
            <span class="p">}</span>

        <span class="c1"># Analyze data transformations</span>
        <span class="n">transformations</span> <span class="o">=</span> <span class="n">dataset_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;transformations&#39;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">for</span> <span class="n">transform</span> <span class="ow">in</span> <span class="n">transformations</span><span class="p">:</span>
            <span class="n">risk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_assess_transformation_bias_risk</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">risk</span><span class="p">[</span><span class="s1">&#39;risk_level&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.3</span><span class="p">:</span>
                <span class="n">lineage_analysis</span><span class="p">[</span><span class="s1">&#39;transformation_risks&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">risk</span><span class="p">)</span>

        <span class="c1"># Calculate overall bias risk</span>
        <span class="n">lineage_analysis</span><span class="p">[</span><span class="s1">&#39;bias_risk_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">total_source_risk</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sources</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">)</span>

        <span class="c1"># Generate recommendations</span>
        <span class="n">lineage_analysis</span><span class="p">[</span><span class="s1">&#39;recommendations&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_provenance_recommendations</span><span class="p">(</span>
            <span class="n">lineage_analysis</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">lineage_analysis</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_identify_source_bias_indicators</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Identify potential bias indicators in a data source&quot;&quot;&quot;</span>
        <span class="n">indicators</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">source</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;geographic_scope&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;limited&#39;</span><span class="p">:</span>
            <span class="n">indicators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;geographic_bias&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">source</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;time_period_days&#39;</span><span class="p">,</span> <span class="mi">365</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
            <span class="n">indicators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;temporal_bias&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">source</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;response_rate&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="n">indicators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;non_response_bias&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">source</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;access_requirements&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;internet_required&#39;</span><span class="p">:</span>
            <span class="n">indicators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;digital_divide_bias&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">indicators</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_assess_transformation_bias_risk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transformation</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Assess bias risk introduced by data transformations&quot;&quot;&quot;</span>
        <span class="n">transform_type</span> <span class="o">=</span> <span class="n">transformation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;unknown&#39;</span><span class="p">)</span>

        <span class="n">risk_levels</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;filtering&#39;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">,</span>      <span class="c1"># Can remove important subgroups</span>
            <span class="s1">&#39;sampling&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>       <span class="c1"># May introduce sampling bias</span>
            <span class="s1">&#39;feature_selection&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span>  <span class="c1"># Could remove bias-relevant features</span>
            <span class="s1">&#39;normalization&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>   <span class="c1"># Generally lower risk</span>
            <span class="s1">&#39;encoding&#39;</span><span class="p">:</span> <span class="mf">0.1</span>        <span class="c1"># Low risk for bias</span>
        <span class="p">}</span>

        <span class="n">risk_level</span> <span class="o">=</span> <span class="n">risk_levels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">transform_type</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;transformation&#39;</span><span class="p">:</span> <span class="n">transform_type</span><span class="p">,</span>
            <span class="s1">&#39;parameters&#39;</span><span class="p">:</span> <span class="n">transformation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;parameters&#39;</span><span class="p">,</span> <span class="p">{}),</span>
            <span class="s1">&#39;risk_level&#39;</span><span class="p">:</span> <span class="n">risk_level</span><span class="p">,</span>
            <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="n">transformation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;description&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_provenance_recommendations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">analysis</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate recommendations based on provenance analysis&quot;&quot;&quot;</span>
        <span class="n">recommendations</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;bias_risk_score&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.7</span><span class="p">:</span>
            <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;High bias risk detected - consider alternative data sources&quot;</span><span class="p">)</span>
            <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Implement bias testing before model deployment&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;transformation_risks&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Multiple transformation risks identified - review processing pipeline&quot;</span><span class="p">)</span>

        <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Document all data transformations for reproducibility&quot;</span><span class="p">)</span>
        <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Implement version control for dataset lineage tracking&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">recommendations</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MissingGroupsDetector</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Tools for detecting underrepresented or missing demographic groups&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">demographic_benchmarks</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minimum_representation_threshold</span> <span class="o">=</span> <span class="mf">0.05</span>  <span class="c1"># 5% minimum representation</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_population_benchmarks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">benchmarks</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set population benchmarks for comparison</span>

<span class="sd">        Args:</span>
<span class="sd">            benchmarks: Dict mapping demographic attributes to expected distributions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">demographic_benchmarks</span> <span class="o">=</span> <span class="n">benchmarks</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">detect_missing_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> 
                            <span class="n">demographic_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect missing or underrepresented demographic groups</span>

<span class="sd">        Args:</span>
<span class="sd">            dataset: Dataset to analyze</span>
<span class="sd">            demographic_columns: List of demographic attribute columns</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">detection_results</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;missing_groups&#39;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s1">&#39;underrepresented_groups&#39;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s1">&#39;representation_analysis&#39;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s1">&#39;severity_scores&#39;</span><span class="p">:</span> <span class="p">{}</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">demographic_columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">detection_results</span><span class="p">[</span><span class="s1">&#39;missing_groups&#39;</span><span class="p">][</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Column not present in dataset&quot;</span>
                <span class="k">continue</span>

            <span class="c1"># Calculate actual distribution</span>
            <span class="n">actual_dist</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="c1"># Compare with benchmarks if available</span>
            <span class="k">if</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">demographic_benchmarks</span><span class="p">:</span>
                <span class="n">benchmark</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">demographic_benchmarks</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>
                <span class="n">missing_groups</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">underrepresented_groups</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">expected_prop</span> <span class="ow">in</span> <span class="n">benchmark</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">actual_prop</span> <span class="o">=</span> <span class="n">actual_dist</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">actual_prop</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">missing_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">actual_prop</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimum_representation_threshold</span><span class="p">:</span>
                        <span class="n">underrepresented_groups</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                            <span class="s1">&#39;group&#39;</span><span class="p">:</span> <span class="n">group</span><span class="p">,</span>
                            <span class="s1">&#39;actual_proportion&#39;</span><span class="p">:</span> <span class="n">actual_prop</span><span class="p">,</span>
                            <span class="s1">&#39;expected_proportion&#39;</span><span class="p">:</span> <span class="n">expected_prop</span><span class="p">,</span>
                            <span class="s1">&#39;representation_ratio&#39;</span><span class="p">:</span> <span class="n">actual_prop</span> <span class="o">/</span> <span class="n">expected_prop</span> <span class="k">if</span> <span class="n">expected_prop</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
                        <span class="p">})</span>

                <span class="n">detection_results</span><span class="p">[</span><span class="s1">&#39;missing_groups&#39;</span><span class="p">][</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">missing_groups</span>
                <span class="n">detection_results</span><span class="p">[</span><span class="s1">&#39;underrepresented_groups&#39;</span><span class="p">][</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">underrepresented_groups</span>

                <span class="c1"># Calculate severity score</span>
                <span class="n">missing_severity</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">missing_groups</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">benchmark</span><span class="p">)</span>
                <span class="n">underrep_severity</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
                    <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">group</span><span class="p">[</span><span class="s1">&#39;representation_ratio&#39;</span><span class="p">])</span> 
                    <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">underrepresented_groups</span>
                <span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">benchmark</span><span class="p">)</span>

                <span class="n">detection_results</span><span class="p">[</span><span class="s1">&#39;severity_scores&#39;</span><span class="p">][</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">missing_severity</span> <span class="o">+</span> <span class="n">underrep_severity</span>

            <span class="n">detection_results</span><span class="p">[</span><span class="s1">&#39;representation_analysis&#39;</span><span class="p">][</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">actual_dist</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">detection_results</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_sampling_strategy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">detection_results</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate targeted sampling strategy to address missing groups&quot;&quot;&quot;</span>
        <span class="n">sampling_strategy</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;priority_groups&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;collection_targets&#39;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s1">&#39;methods&#39;</span><span class="p">:</span> <span class="p">[]</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">column</span><span class="p">,</span> <span class="n">missing_groups</span> <span class="ow">in</span> <span class="n">detection_results</span><span class="p">[</span><span class="s1">&#39;missing_groups&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">missing_groups</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="n">missing_groups</span><span class="p">:</span>
                <span class="n">sampling_strategy</span><span class="p">[</span><span class="s1">&#39;priority_groups&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                    <span class="p">[(</span><span class="n">column</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span> <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">missing_groups</span><span class="p">]</span>
                <span class="p">)</span>

        <span class="k">for</span> <span class="n">column</span><span class="p">,</span> <span class="n">underrep_groups</span> <span class="ow">in</span> <span class="n">detection_results</span><span class="p">[</span><span class="s1">&#39;underrepresented_groups&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">underrep_groups</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">group_info</span> <span class="ow">in</span> <span class="n">underrep_groups</span><span class="p">:</span>
                    <span class="n">group</span> <span class="o">=</span> <span class="n">group_info</span><span class="p">[</span><span class="s1">&#39;group&#39;</span><span class="p">]</span>
                    <span class="n">current_prop</span> <span class="o">=</span> <span class="n">group_info</span><span class="p">[</span><span class="s1">&#39;actual_proportion&#39;</span><span class="p">]</span>
                    <span class="n">target_prop</span> <span class="o">=</span> <span class="n">group_info</span><span class="p">[</span><span class="s1">&#39;expected_proportion&#39;</span><span class="p">]</span>

                    <span class="c1"># Calculate how many additional samples needed</span>
                    <span class="n">additional_samples_needed</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
                        <span class="p">(</span><span class="n">target_prop</span> <span class="o">-</span> <span class="n">current_prop</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span>  <span class="c1"># Assuming target of 1000 total samples</span>
                    <span class="p">)</span>

                    <span class="n">sampling_strategy</span><span class="p">[</span><span class="s1">&#39;collection_targets&#39;</span><span class="p">][(</span><span class="n">column</span><span class="p">,</span> <span class="n">group</span><span class="p">)]</span> <span class="o">=</span> <span class="n">additional_samples_needed</span>

        <span class="c1"># Suggest collection methods</span>
        <span class="k">if</span> <span class="n">sampling_strategy</span><span class="p">[</span><span class="s1">&#39;priority_groups&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">sampling_strategy</span><span class="p">[</span><span class="s1">&#39;collection_targets&#39;</span><span class="p">]:</span>
            <span class="n">sampling_strategy</span><span class="p">[</span><span class="s1">&#39;methods&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;Targeted outreach to underrepresented communities&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Partner with organizations serving missing demographic groups&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Implement quota sampling to ensure representation&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Use online platforms with diverse user bases&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Conduct follow-up studies focused on missing groups&quot;</span>
            <span class="p">]</span>

        <span class="k">return</span> <span class="n">sampling_strategy</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MeasurementBiasAnalyzer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Tools for detecting and analyzing measurement bias in datasets&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bias_indicators</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_measurement_consistency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> 
                                      <span class="n">measurement_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                                      <span class="n">grouping_variable</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Analyze measurement consistency across different groups</span>

<span class="sd">        Args:</span>
<span class="sd">            dataset: Dataset to analyze</span>
<span class="sd">            measurement_columns: Columns containing measurements to analyze</span>
<span class="sd">            grouping_variable: Variable to group by (e.g., demographic group)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">consistency_analysis</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;group_statistics&#39;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s1">&#39;variance_analysis&#39;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s1">&#39;bias_indicators&#39;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s1">&#39;recommendations&#39;</span><span class="p">:</span> <span class="p">[]</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">measure_col</span> <span class="ow">in</span> <span class="n">measurement_columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">measure_col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">group_stats</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">grouping_variable</span><span class="p">)[</span><span class="n">measure_col</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span>
                <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span>
            <span class="p">])</span>

            <span class="n">consistency_analysis</span><span class="p">[</span><span class="s1">&#39;group_statistics&#39;</span><span class="p">][</span><span class="n">measure_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">group_stats</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

            <span class="c1"># Analyze variance differences (potential measurement bias indicator)</span>
            <span class="n">std_values</span> <span class="o">=</span> <span class="n">group_stats</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">std_ratio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">std_values</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">std_values</span><span class="p">)</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">std_values</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

            <span class="n">consistency_analysis</span><span class="p">[</span><span class="s1">&#39;variance_analysis&#39;</span><span class="p">][</span><span class="n">measure_col</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;std_ratio&#39;</span><span class="p">:</span> <span class="n">std_ratio</span><span class="p">,</span>
                <span class="s1">&#39;variance_heterogeneity&#39;</span><span class="p">:</span> <span class="n">std_ratio</span> <span class="o">&gt;</span> <span class="mf">2.0</span><span class="p">,</span>  <span class="c1"># Flag if ratio &gt; 2</span>
                <span class="s1">&#39;group_count_balance&#39;</span><span class="p">:</span> <span class="n">group_stats</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">/</span> <span class="n">group_stats</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="p">}</span>

            <span class="c1"># Identify bias indicators</span>
            <span class="n">bias_indicators</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">std_ratio</span> <span class="o">&gt;</span> <span class="mf">3.0</span><span class="p">:</span>
                <span class="n">bias_indicators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;high_variance_heterogeneity&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">group_stats</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
                <span class="n">bias_indicators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;insufficient_group_sample_size&#39;</span><span class="p">)</span>

            <span class="c1"># Check for systematic differences in means</span>
            <span class="n">mean_values</span> <span class="o">=</span> <span class="n">group_stats</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">mean_values</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">mean_values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">mean_values</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">bias_indicators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;systematic_group_differences&#39;</span><span class="p">)</span>

            <span class="n">consistency_analysis</span><span class="p">[</span><span class="s1">&#39;bias_indicators&#39;</span><span class="p">][</span><span class="n">measure_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">bias_indicators</span>

        <span class="c1"># Generate recommendations</span>
        <span class="n">all_indicators</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">indicator</span> <span class="k">for</span> <span class="n">indicators</span> <span class="ow">in</span> <span class="n">consistency_analysis</span><span class="p">[</span><span class="s1">&#39;bias_indicators&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">indicator</span> <span class="ow">in</span> <span class="n">indicators</span>
        <span class="p">]</span>

        <span class="k">if</span> <span class="s1">&#39;high_variance_heterogeneity&#39;</span> <span class="ow">in</span> <span class="n">all_indicators</span><span class="p">:</span>
            <span class="n">consistency_analysis</span><span class="p">[</span><span class="s1">&#39;recommendations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s2">&quot;Investigate measurement procedures across groups for consistency&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;insufficient_group_sample_size&#39;</span> <span class="ow">in</span> <span class="n">all_indicators</span><span class="p">:</span>
            <span class="n">consistency_analysis</span><span class="p">[</span><span class="s1">&#39;recommendations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s2">&quot;Increase sample sizes for underrepresented groups&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;systematic_group_differences&#39;</span> <span class="ow">in</span> <span class="n">all_indicators</span><span class="p">:</span>
            <span class="n">consistency_analysis</span><span class="p">[</span><span class="s1">&#39;recommendations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="s2">&quot;Examine whether group differences reflect true differences or measurement bias&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">consistency_analysis</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">detect_instrument_bias</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> 
                             <span class="n">instrument_variable</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                             <span class="n">outcome_variables</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect potential instrument bias (different measurement tools/methods)</span>

<span class="sd">        Args:</span>
<span class="sd">            dataset: Dataset to analyze</span>
<span class="sd">            instrument_variable: Variable indicating measurement instrument/method</span>
<span class="sd">            outcome_variables: Variables measured by different instruments</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">instrument_analysis</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;instrument_effects&#39;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s1">&#39;bias_assessment&#39;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s1">&#39;calibration_needs&#39;</span><span class="p">:</span> <span class="p">[]</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="n">outcome_variables</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">outcome</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="c1"># Analyze outcome distributions by instrument</span>
            <span class="n">instrument_stats</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">instrument_variable</span><span class="p">)[</span><span class="n">outcome</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span>
                <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span>
            <span class="p">])</span>

            <span class="c1"># Calculate effect sizes between instruments</span>
            <span class="n">instruments</span> <span class="o">=</span> <span class="n">instrument_stats</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">effect_sizes</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">instruments</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">instruments</span><span class="p">)):</span>
                    <span class="n">inst1</span><span class="p">,</span> <span class="n">inst2</span> <span class="o">=</span> <span class="n">instruments</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">instruments</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                    <span class="n">mean1</span> <span class="o">=</span> <span class="n">instrument_stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">inst1</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">]</span>
                    <span class="n">mean2</span> <span class="o">=</span> <span class="n">instrument_stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">inst2</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">]</span>
                    <span class="n">std1</span> <span class="o">=</span> <span class="n">instrument_stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">inst1</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">]</span>
                    <span class="n">std2</span> <span class="o">=</span> <span class="n">instrument_stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">inst2</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">]</span>

                    <span class="c1"># Cohen&#39;s d</span>
                    <span class="n">pooled_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">std1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">std2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="n">cohens_d</span> <span class="o">=</span> <span class="p">(</span><span class="n">mean1</span> <span class="o">-</span> <span class="n">mean2</span><span class="p">)</span> <span class="o">/</span> <span class="n">pooled_std</span> <span class="k">if</span> <span class="n">pooled_std</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>

                    <span class="n">effect_sizes</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">inst1</span><span class="si">}</span><span class="s2">_vs_</span><span class="si">{</span><span class="n">inst2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cohens_d</span>

            <span class="n">instrument_analysis</span><span class="p">[</span><span class="s1">&#39;instrument_effects&#39;</span><span class="p">][</span><span class="n">outcome</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;statistics&#39;</span><span class="p">:</span> <span class="n">instrument_stats</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span>
                <span class="s1">&#39;effect_sizes&#39;</span><span class="p">:</span> <span class="n">effect_sizes</span>
            <span class="p">}</span>

            <span class="c1"># Assess bias severity</span>
            <span class="n">max_effect_size</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">es</span><span class="p">)</span> <span class="k">for</span> <span class="n">es</span> <span class="ow">in</span> <span class="n">effect_sizes</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="k">if</span> <span class="n">effect_sizes</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">bias_severity</span> <span class="o">=</span> <span class="s2">&quot;low&quot;</span> <span class="k">if</span> <span class="n">max_effect_size</span> <span class="o">&lt;</span> <span class="mf">0.2</span> <span class="k">else</span> <span class="s2">&quot;moderate&quot;</span> <span class="k">if</span> <span class="n">max_effect_size</span> <span class="o">&lt;</span> <span class="mf">0.5</span> <span class="k">else</span> <span class="s2">&quot;high&quot;</span>

            <span class="n">instrument_analysis</span><span class="p">[</span><span class="s1">&#39;bias_assessment&#39;</span><span class="p">][</span><span class="n">outcome</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;max_effect_size&#39;</span><span class="p">:</span> <span class="n">max_effect_size</span><span class="p">,</span>
                <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="n">bias_severity</span><span class="p">,</span>
                <span class="s1">&#39;requires_calibration&#39;</span><span class="p">:</span> <span class="n">max_effect_size</span> <span class="o">&gt;</span> <span class="mf">0.3</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="n">max_effect_size</span> <span class="o">&gt;</span> <span class="mf">0.3</span><span class="p">:</span>
                <span class="n">instrument_analysis</span><span class="p">[</span><span class="s1">&#39;calibration_needs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">instrument_analysis</span>

<span class="c1"># Demonstration function</span>
<span class="k">def</span><span class="w"> </span><span class="nf">demonstrate_practical_investigation_tools</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrate practical bias investigation tools&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Practical Bias Investigation Tools Demonstration ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Create sample dataset with bias issues</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">n_samples</span> <span class="o">=</span> <span class="mi">1000</span>

    <span class="c1"># Simulate missing groups and measurement bias</span>
    <span class="n">age_groups</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;18-25&#39;</span><span class="p">,</span> <span class="s1">&#39;26-40&#39;</span><span class="p">,</span> <span class="s1">&#39;41-60&#39;</span><span class="p">],</span> <span class="n">n_samples</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>  <span class="c1"># Missing 60+</span>
    <span class="n">regions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;urban&#39;</span><span class="p">,</span> <span class="s1">&#39;suburban&#39;</span><span class="p">],</span> <span class="n">n_samples</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>  <span class="c1"># Missing rural</span>

    <span class="c1"># Simulate measurement bias - different instruments give different readings</span>
    <span class="n">instrument</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">n_samples</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>
    <span class="n">base_score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span>
    <span class="c1"># Instrument A systematically reads higher</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">instrument</span> <span class="o">==</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">base_score</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">,</span> <span class="n">base_score</span><span class="p">)</span>

    <span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s1">&#39;age_group&#39;</span><span class="p">:</span> <span class="n">age_groups</span><span class="p">,</span>
        <span class="s1">&#39;region&#39;</span><span class="p">:</span> <span class="n">regions</span><span class="p">,</span>
        <span class="s1">&#39;instrument&#39;</span><span class="p">:</span> <span class="n">instrument</span><span class="p">,</span>
        <span class="s1">&#39;test_score&#39;</span><span class="p">:</span> <span class="n">score</span><span class="p">,</span>
        <span class="s1">&#39;income&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">50000</span><span class="p">,</span> <span class="mi">20000</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span>
    <span class="p">})</span>

    <span class="c1"># 1. Dataset Provenance Analysis</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1. Dataset Provenance Analysis:&quot;</span><span class="p">)</span>
    <span class="n">provenance_analyzer</span> <span class="o">=</span> <span class="n">DatasetProvenanceAnalyzer</span><span class="p">()</span>

    <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;sources&#39;</span><span class="p">:</span> <span class="p">[{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;online_survey&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;surveys&#39;</span><span class="p">,</span>
            <span class="s1">&#39;collection_method&#39;</span><span class="p">:</span> <span class="s1">&#39;convenience&#39;</span><span class="p">,</span>
            <span class="s1">&#39;geographic_scope&#39;</span><span class="p">:</span> <span class="s1">&#39;limited&#39;</span><span class="p">,</span>
            <span class="s1">&#39;response_rate&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
            <span class="s1">&#39;access_requirements&#39;</span><span class="p">:</span> <span class="s1">&#39;internet_required&#39;</span>
        <span class="p">}],</span>
        <span class="s1">&#39;transformations&#39;</span><span class="p">:</span> <span class="p">[{</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;filtering&#39;</span><span class="p">,</span>
            <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Removed incomplete responses&#39;</span><span class="p">,</span>
            <span class="s1">&#39;parameters&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;min_completion&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">}</span>
        <span class="p">}]</span>
    <span class="p">}</span>

    <span class="n">lineage_analysis</span> <span class="o">=</span> <span class="n">provenance_analyzer</span><span class="o">.</span><span class="n">analyze_data_lineage</span><span class="p">(</span><span class="n">metadata</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Bias risk score: </span><span class="si">{</span><span class="n">lineage_analysis</span><span class="p">[</span><span class="s1">&#39;bias_risk_score&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Transformation risks: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lineage_analysis</span><span class="p">[</span><span class="s1">&#39;transformation_risks&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="c1"># 2. Missing Groups Detection</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2. Missing Groups Detection:&quot;</span><span class="p">)</span>
    <span class="n">missing_detector</span> <span class="o">=</span> <span class="n">MissingGroupsDetector</span><span class="p">()</span>

    <span class="c1"># Set population benchmarks</span>
    <span class="n">benchmarks</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;age_group&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;18-25&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span> <span class="s1">&#39;26-40&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span> <span class="s1">&#39;41-60&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span> <span class="s1">&#39;60+&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">},</span>
        <span class="s1">&#39;region&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;urban&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;suburban&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span> <span class="s1">&#39;rural&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">}</span>
    <span class="p">}</span>
    <span class="n">missing_detector</span><span class="o">.</span><span class="n">set_population_benchmarks</span><span class="p">(</span><span class="n">benchmarks</span><span class="p">)</span>

    <span class="n">missing_analysis</span> <span class="o">=</span> <span class="n">missing_detector</span><span class="o">.</span><span class="n">detect_missing_groups</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;age_group&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Missing groups: </span><span class="si">{</span><span class="n">missing_analysis</span><span class="p">[</span><span class="s1">&#39;missing_groups&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Severity scores: </span><span class="si">{</span><span class="n">missing_analysis</span><span class="p">[</span><span class="s1">&#39;severity_scores&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="c1"># 3. Measurement Bias Analysis</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;3. Measurement Bias Analysis:&quot;</span><span class="p">)</span>
    <span class="n">measurement_analyzer</span> <span class="o">=</span> <span class="n">MeasurementBiasAnalyzer</span><span class="p">()</span>

    <span class="n">consistency_analysis</span> <span class="o">=</span> <span class="n">measurement_analyzer</span><span class="o">.</span><span class="n">analyze_measurement_consistency</span><span class="p">(</span>
        <span class="n">dataset</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;test_score&#39;</span><span class="p">,</span> <span class="s1">&#39;income&#39;</span><span class="p">],</span> <span class="s1">&#39;age_group&#39;</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Bias indicators: </span><span class="si">{</span><span class="n">consistency_analysis</span><span class="p">[</span><span class="s1">&#39;bias_indicators&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">instrument_analysis</span> <span class="o">=</span> <span class="n">measurement_analyzer</span><span class="o">.</span><span class="n">detect_instrument_bias</span><span class="p">(</span>
        <span class="n">dataset</span><span class="p">,</span> <span class="s1">&#39;instrument&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;test_score&#39;</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Instrument bias assessment: </span><span class="si">{</span><span class="n">instrument_analysis</span><span class="p">[</span><span class="s1">&#39;bias_assessment&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Calibration needed for: </span><span class="si">{</span><span class="n">instrument_analysis</span><span class="p">[</span><span class="s1">&#39;calibration_needs&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">demonstrate_practical_investigation_tools</span><span class="p">()</span>
</code></pre>
</div>
<h2 id="part-3-bias-mitigation-strategies">Part 3: Bias Mitigation Strategies<a class="headerlink" href="#part-3-bias-mitigation-strategies" title="Permanent link">&para;</a></h2>
<p>This section implements comprehensive <span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A pre-built structure providing a foundation and tools for developing software applications more efficiently." data-glossary-term="Framework">frameworks</span> for mitigating bias through diverse data collection, reweighting techniques, and fairness-aware metrics.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.utils.class_weight</span><span class="w"> </span><span class="kn">import</span> <span class="n">compute_class_weight</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="k">class</span><span class="w"> </span><span class="nc">DiverseDataCollectionFramework</span><span class="p">:</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Framework for implementing diverse and representative data collection strategies&quot;&quot;&quot;</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">collection_strategies</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>            <span class="s1">&#39;stratified_sampling&#39;</span><span class="p">:</span> <span class="s1">&#39;Ensure proportional representation across groups&#39;</span><span class="p">,</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>            <span class="s1">&#39;quota_sampling&#39;</span><span class="p">:</span> <span class="s1">&#39;Set minimum representation targets for each group&#39;</span><span class="p">,</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>            <span class="s1">&#39;snowball_sampling&#39;</span><span class="p">:</span> <span class="s1">&#39;Use existing participants to reach underrepresented groups&#39;</span><span class="p">,</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>            <span class="s1">&#39;adaptive_sampling&#39;</span><span class="p">:</span> <span class="s1">&#39;Adjust collection based on ongoing representativeness analysis&#39;</span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>        <span class="p">}</span>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">diversity_metrics</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">design_stratified_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_population</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span> 
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>                                   <span class="n">total_sample_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="sd">        Design stratified sampling strategy to ensure representative collection</span>
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="sd">        Args:</span>
</span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a><span class="sd">            target_population: Target distributions for each demographic attribute</span>
</span><span id="__span-1-26"><a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a><span class="sd">            total_sample_size: Total number of samples to collect</span>
</span><span id="__span-1-27"><a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-1-28"><a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a>        <span class="n">collection_plan</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-1-29"><a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a>            <span class="s1">&#39;strategy&#39;</span><span class="p">:</span> <span class="s1">&#39;stratified_sampling&#39;</span><span class="p">,</span>
</span><span id="__span-1-30"><a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a>            <span class="s1">&#39;total_size&#39;</span><span class="p">:</span> <span class="n">total_sample_size</span><span class="p">,</span>
</span><span id="__span-1-31"><a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a>            <span class="s1">&#39;strata_targets&#39;</span><span class="p">:</span> <span class="p">{},</span>
</span><span id="__span-1-32"><a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a>            <span class="s1">&#39;collection_priorities&#39;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="__span-1-33"><a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a>            <span class="s1">&#39;quality_checks&#39;</span><span class="p">:</span> <span class="p">[]</span>
</span><span id="__span-1-34"><a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a>        <span class="p">}</span>
</span><span id="__span-1-35"><a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a>
</span><span id="__span-1-36"><a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a>        <span class="c1"># Calculate sample sizes for each stratum</span>
</span><span id="__span-1-37"><a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a>        <span class="k">for</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">distribution</span> <span class="ow">in</span> <span class="n">target_population</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-1-38"><a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a>            <span class="n">strata_sizes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-1-39"><a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a>            <span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">proportion</span> <span class="ow">in</span> <span class="n">distribution</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-1-40"><a id="__codelineno-1-40" name="__codelineno-1-40" href="#__codelineno-1-40"></a>                <span class="n">target_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">total_sample_size</span> <span class="o">*</span> <span class="n">proportion</span><span class="p">)</span>
</span><span id="__span-1-41"><a id="__codelineno-1-41" name="__codelineno-1-41" href="#__codelineno-1-41"></a>                <span class="n">strata_sizes</span><span class="p">[</span><span class="n">group</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">target_size</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>  <span class="c1"># Minimum 30 per group</span>
</span><span id="__span-1-42"><a id="__codelineno-1-42" name="__codelineno-1-42" href="#__codelineno-1-42"></a>
</span><span id="__span-1-43"><a id="__codelineno-1-43" name="__codelineno-1-43" href="#__codelineno-1-43"></a>            <span class="n">collection_plan</span><span class="p">[</span><span class="s1">&#39;strata_targets&#39;</span><span class="p">][</span><span class="n">attribute</span><span class="p">]</span> <span class="o">=</span> <span class="n">strata_sizes</span>
</span><span id="__span-1-44"><a id="__codelineno-1-44" name="__codelineno-1-44" href="#__codelineno-1-44"></a>
</span><span id="__span-1-45"><a id="__codelineno-1-45" name="__codelineno-1-45" href="#__codelineno-1-45"></a>        <span class="c1"># Identify collection priorities (hardest to reach groups)</span>
</span><span id="__span-1-46"><a id="__codelineno-1-46" name="__codelineno-1-46" href="#__codelineno-1-46"></a>        <span class="n">collection_plan</span><span class="p">[</span><span class="s1">&#39;collection_priorities&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-1-47"><a id="__codelineno-1-47" name="__codelineno-1-47" href="#__codelineno-1-47"></a>            <span class="s1">&#39;rural_populations&#39;</span><span class="p">,</span>
</span><span id="__span-1-48"><a id="__codelineno-1-48" name="__codelineno-1-48" href="#__codelineno-1-48"></a>            <span class="s1">&#39;elderly_demographics&#39;</span><span class="p">,</span>
</span><span id="__span-1-49"><a id="__codelineno-1-49" name="__codelineno-1-49" href="#__codelineno-1-49"></a>            <span class="s1">&#39;low_income_groups&#39;</span><span class="p">,</span>
</span><span id="__span-1-50"><a id="__codelineno-1-50" name="__codelineno-1-50" href="#__codelineno-1-50"></a>            <span class="s1">&#39;minority_communities&#39;</span><span class="p">,</span>
</span><span id="__span-1-51"><a id="__codelineno-1-51" name="__codelineno-1-51" href="#__codelineno-1-51"></a>            <span class="s1">&#39;disability_communities&#39;</span>
</span><span id="__span-1-52"><a id="__codelineno-1-52" name="__codelineno-1-52" href="#__codelineno-1-52"></a>        <span class="p">]</span>
</span><span id="__span-1-53"><a id="__codelineno-1-53" name="__codelineno-1-53" href="#__codelineno-1-53"></a>
</span><span id="__span-1-54"><a id="__codelineno-1-54" name="__codelineno-1-54" href="#__codelineno-1-54"></a>        <span class="c1"># Define quality checks</span>
</span><span id="__span-1-55"><a id="__codelineno-1-55" name="__codelineno-1-55" href="#__codelineno-1-55"></a>        <span class="n">collection_plan</span><span class="p">[</span><span class="s1">&#39;quality_checks&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-1-56"><a id="__codelineno-1-56" name="__codelineno-1-56" href="#__codelineno-1-56"></a>            <span class="s1">&#39;weekly_representativeness_analysis&#39;</span><span class="p">,</span>
</span><span id="__span-1-57"><a id="__codelineno-1-57" name="__codelineno-1-57" href="#__codelineno-1-57"></a>            <span class="s1">&#39;response_quality_assessment&#39;</span><span class="p">,</span>
</span><span id="__span-1-58"><a id="__codelineno-1-58" name="__codelineno-1-58" href="#__codelineno-1-58"></a>            <span class="s1">&#39;completion_rate_monitoring&#39;</span><span class="p">,</span>
</span><span id="__span-1-59"><a id="__codelineno-1-59" name="__codelineno-1-59" href="#__codelineno-1-59"></a>            <span class="s1">&#39;demographic_balance_tracking&#39;</span>
</span><span id="__span-1-60"><a id="__codelineno-1-60" name="__codelineno-1-60" href="#__codelineno-1-60"></a>        <span class="p">]</span>
</span><span id="__span-1-61"><a id="__codelineno-1-61" name="__codelineno-1-61" href="#__codelineno-1-61"></a>
</span><span id="__span-1-62"><a id="__codelineno-1-62" name="__codelineno-1-62" href="#__codelineno-1-62"></a>        <span class="k">return</span> <span class="n">collection_plan</span>
</span><span id="__span-1-63"><a id="__codelineno-1-63" name="__codelineno-1-63" href="#__codelineno-1-63"></a>
</span><span id="__span-1-64"><a id="__codelineno-1-64" name="__codelineno-1-64" href="#__codelineno-1-64"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">implement_quota_sampling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_sample</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> 
</span><span id="__span-1-65"><a id="__codelineno-1-65" name="__codelineno-1-65" href="#__codelineno-1-65"></a>                                <span class="n">target_quotas</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span>
</span><span id="__span-1-66"><a id="__codelineno-1-66" name="__codelineno-1-66" href="#__codelineno-1-66"></a>                                <span class="n">demographic_cols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
</span><span id="__span-1-67"><a id="__codelineno-1-67" name="__codelineno-1-67" href="#__codelineno-1-67"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-1-68"><a id="__codelineno-1-68" name="__codelineno-1-68" href="#__codelineno-1-68"></a><span class="sd">        Implement quota sampling to meet representation targets</span>
</span><span id="__span-1-69"><a id="__codelineno-1-69" name="__codelineno-1-69" href="#__codelineno-1-69"></a>
</span><span id="__span-1-70"><a id="__codelineno-1-70" name="__codelineno-1-70" href="#__codelineno-1-70"></a><span class="sd">        Args:</span>
</span><span id="__span-1-71"><a id="__codelineno-1-71" name="__codelineno-1-71" href="#__codelineno-1-71"></a><span class="sd">            current_sample: Existing collected data</span>
</span><span id="__span-1-72"><a id="__codelineno-1-72" name="__codelineno-1-72" href="#__codelineno-1-72"></a><span class="sd">            target_quotas: Target sample sizes for each group</span>
</span><span id="__span-1-73"><a id="__codelineno-1-73" name="__codelineno-1-73" href="#__codelineno-1-73"></a><span class="sd">            demographic_cols: Demographic columns to consider</span>
</span><span id="__span-1-74"><a id="__codelineno-1-74" name="__codelineno-1-74" href="#__codelineno-1-74"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-1-75"><a id="__codelineno-1-75" name="__codelineno-1-75" href="#__codelineno-1-75"></a>        <span class="n">quota_analysis</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-1-76"><a id="__codelineno-1-76" name="__codelineno-1-76" href="#__codelineno-1-76"></a>            <span class="s1">&#39;current_status&#39;</span><span class="p">:</span> <span class="p">{},</span>
</span><span id="__span-1-77"><a id="__codelineno-1-77" name="__codelineno-1-77" href="#__codelineno-1-77"></a>            <span class="s1">&#39;remaining_quotas&#39;</span><span class="p">:</span> <span class="p">{},</span>
</span><span id="__span-1-78"><a id="__codelineno-1-78" name="__codelineno-1-78" href="#__codelineno-1-78"></a>            <span class="s1">&#39;collection_adjustments&#39;</span><span class="p">:</span> <span class="p">{},</span>
</span><span id="__span-1-79"><a id="__codelineno-1-79" name="__codelineno-1-79" href="#__codelineno-1-79"></a>            <span class="s1">&#39;completion_rate&#39;</span><span class="p">:</span> <span class="mf">0.0</span>
</span><span id="__span-1-80"><a id="__codelineno-1-80" name="__codelineno-1-80" href="#__codelineno-1-80"></a>        <span class="p">}</span>
</span><span id="__span-1-81"><a id="__codelineno-1-81" name="__codelineno-1-81" href="#__codelineno-1-81"></a>
</span><span id="__span-1-82"><a id="__codelineno-1-82" name="__codelineno-1-82" href="#__codelineno-1-82"></a>        <span class="n">total_collected</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-1-83"><a id="__codelineno-1-83" name="__codelineno-1-83" href="#__codelineno-1-83"></a>        <span class="n">total_target</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-1-84"><a id="__codelineno-1-84" name="__codelineno-1-84" href="#__codelineno-1-84"></a>
</span><span id="__span-1-85"><a id="__codelineno-1-85" name="__codelineno-1-85" href="#__codelineno-1-85"></a>        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">demographic_cols</span><span class="p">:</span>
</span><span id="__span-1-86"><a id="__codelineno-1-86" name="__codelineno-1-86" href="#__codelineno-1-86"></a>            <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">current_sample</span><span class="o">.</span><span class="n">columns</span> <span class="ow">or</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">target_quotas</span><span class="p">:</span>
</span><span id="__span-1-87"><a id="__codelineno-1-87" name="__codelineno-1-87" href="#__codelineno-1-87"></a>                <span class="k">continue</span>
</span><span id="__span-1-88"><a id="__codelineno-1-88" name="__codelineno-1-88" href="#__codelineno-1-88"></a>
</span><span id="__span-1-89"><a id="__codelineno-1-89" name="__codelineno-1-89" href="#__codelineno-1-89"></a>            <span class="n">current_counts</span> <span class="o">=</span> <span class="n">current_sample</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
</span><span id="__span-1-90"><a id="__codelineno-1-90" name="__codelineno-1-90" href="#__codelineno-1-90"></a>            <span class="n">target_counts</span> <span class="o">=</span> <span class="n">target_quotas</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
</span><span id="__span-1-91"><a id="__codelineno-1-91" name="__codelineno-1-91" href="#__codelineno-1-91"></a>
</span><span id="__span-1-92"><a id="__codelineno-1-92" name="__codelineno-1-92" href="#__codelineno-1-92"></a>            <span class="n">quota_analysis</span><span class="p">[</span><span class="s1">&#39;current_status&#39;</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_counts</span>
</span><span id="__span-1-93"><a id="__codelineno-1-93" name="__codelineno-1-93" href="#__codelineno-1-93"></a>            <span class="n">quota_analysis</span><span class="p">[</span><span class="s1">&#39;remaining_quotas&#39;</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-1-94"><a id="__codelineno-1-94" name="__codelineno-1-94" href="#__codelineno-1-94"></a>
</span><span id="__span-1-95"><a id="__codelineno-1-95" name="__codelineno-1-95" href="#__codelineno-1-95"></a>            <span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">target_counts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-1-96"><a id="__codelineno-1-96" name="__codelineno-1-96" href="#__codelineno-1-96"></a>                <span class="n">current</span> <span class="o">=</span> <span class="n">current_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="__span-1-97"><a id="__codelineno-1-97" name="__codelineno-1-97" href="#__codelineno-1-97"></a>                <span class="n">remaining</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">target</span> <span class="o">-</span> <span class="n">current</span><span class="p">)</span>
</span><span id="__span-1-98"><a id="__codelineno-1-98" name="__codelineno-1-98" href="#__codelineno-1-98"></a>                <span class="n">quota_analysis</span><span class="p">[</span><span class="s1">&#39;remaining_quotas&#39;</span><span class="p">][</span><span class="n">col</span><span class="p">][</span><span class="n">group</span><span class="p">]</span> <span class="o">=</span> <span class="n">remaining</span>
</span><span id="__span-1-99"><a id="__codelineno-1-99" name="__codelineno-1-99" href="#__codelineno-1-99"></a>
</span><span id="__span-1-100"><a id="__codelineno-1-100" name="__codelineno-1-100" href="#__codelineno-1-100"></a>                <span class="n">total_collected</span> <span class="o">+=</span> <span class="n">current</span>
</span><span id="__span-1-101"><a id="__codelineno-1-101" name="__codelineno-1-101" href="#__codelineno-1-101"></a>                <span class="n">total_target</span> <span class="o">+=</span> <span class="n">target</span>
</span><span id="__span-1-102"><a id="__codelineno-1-102" name="__codelineno-1-102" href="#__codelineno-1-102"></a>
</span><span id="__span-1-103"><a id="__codelineno-1-103" name="__codelineno-1-103" href="#__codelineno-1-103"></a>        <span class="n">quota_analysis</span><span class="p">[</span><span class="s1">&#39;completion_rate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">total_collected</span> <span class="o">/</span> <span class="n">total_target</span> <span class="k">if</span> <span class="n">total_target</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="__span-1-104"><a id="__codelineno-1-104" name="__codelineno-1-104" href="#__codelineno-1-104"></a>
</span><span id="__span-1-105"><a id="__codelineno-1-105" name="__codelineno-1-105" href="#__codelineno-1-105"></a>        <span class="c1"># Generate collection adjustments</span>
</span><span id="__span-1-106"><a id="__codelineno-1-106" name="__codelineno-1-106" href="#__codelineno-1-106"></a>        <span class="n">quota_analysis</span><span class="p">[</span><span class="s1">&#39;collection_adjustments&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_collection_adjustments</span><span class="p">(</span>
</span><span id="__span-1-107"><a id="__codelineno-1-107" name="__codelineno-1-107" href="#__codelineno-1-107"></a>            <span class="n">quota_analysis</span><span class="p">[</span><span class="s1">&#39;remaining_quotas&#39;</span><span class="p">]</span>
</span><span id="__span-1-108"><a id="__codelineno-1-108" name="__codelineno-1-108" href="#__codelineno-1-108"></a>        <span class="p">)</span>
</span><span id="__span-1-109"><a id="__codelineno-1-109" name="__codelineno-1-109" href="#__codelineno-1-109"></a>
</span><span id="__span-1-110"><a id="__codelineno-1-110" name="__codelineno-1-110" href="#__codelineno-1-110"></a>        <span class="k">return</span> <span class="n">quota_analysis</span>
</span><span id="__span-1-111"><a id="__codelineno-1-111" name="__codelineno-1-111" href="#__codelineno-1-111"></a>
</span><span id="__span-1-112"><a id="__codelineno-1-112" name="__codelineno-1-112" href="#__codelineno-1-112"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_collection_adjustments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">remaining_quotas</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="__span-1-113"><a id="__codelineno-1-113" name="__codelineno-1-113" href="#__codelineno-1-113"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate specific collection adjustment recommendations&quot;&quot;&quot;</span>
</span><span id="__span-1-114"><a id="__codelineno-1-114" name="__codelineno-1-114" href="#__codelineno-1-114"></a>        <span class="n">adjustments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-1-115"><a id="__codelineno-1-115" name="__codelineno-1-115" href="#__codelineno-1-115"></a>
</span><span id="__span-1-116"><a id="__codelineno-1-116" name="__codelineno-1-116" href="#__codelineno-1-116"></a>        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">quotas</span> <span class="ow">in</span> <span class="n">remaining_quotas</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-1-117"><a id="__codelineno-1-117" name="__codelineno-1-117" href="#__codelineno-1-117"></a>            <span class="n">high_need_groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">group</span> <span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">need</span> <span class="ow">in</span> <span class="n">quotas</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">need</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">]</span>
</span><span id="__span-1-118"><a id="__codelineno-1-118" name="__codelineno-1-118" href="#__codelineno-1-118"></a>            <span class="k">if</span> <span class="n">high_need_groups</span><span class="p">:</span>
</span><span id="__span-1-119"><a id="__codelineno-1-119" name="__codelineno-1-119" href="#__codelineno-1-119"></a>                <span class="n">adjustments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Priority collection needed for </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">high_need_groups</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-1-120"><a id="__codelineno-1-120" name="__codelineno-1-120" href="#__codelineno-1-120"></a>                <span class="n">adjustments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Consider targeted outreach campaigns for underrepresented </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2"> groups&quot;</span><span class="p">)</span>
</span><span id="__span-1-121"><a id="__codelineno-1-121" name="__codelineno-1-121" href="#__codelineno-1-121"></a>
</span><span id="__span-1-122"><a id="__codelineno-1-122" name="__codelineno-1-122" href="#__codelineno-1-122"></a>        <span class="k">return</span> <span class="n">adjustments</span>
</span><span id="__span-1-123"><a id="__codelineno-1-123" name="__codelineno-1-123" href="#__codelineno-1-123"></a>
</span><span id="__span-1-124"><a id="__codelineno-1-124" name="__codelineno-1-124" href="#__codelineno-1-124"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_diversity_score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> 
</span><span id="__span-1-125"><a id="__codelineno-1-125" name="__codelineno-1-125" href="#__codelineno-1-125"></a>                                <span class="n">demographic_cols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="__span-1-126"><a id="__codelineno-1-126" name="__codelineno-1-126" href="#__codelineno-1-126"></a>                                <span class="n">target_distributions</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="__span-1-127"><a id="__codelineno-1-127" name="__codelineno-1-127" href="#__codelineno-1-127"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-1-128"><a id="__codelineno-1-128" name="__codelineno-1-128" href="#__codelineno-1-128"></a><span class="sd">        Calculate overall diversity score for the dataset</span>
</span><span id="__span-1-129"><a id="__codelineno-1-129" name="__codelineno-1-129" href="#__codelineno-1-129"></a>
</span><span id="__span-1-130"><a id="__codelineno-1-130" name="__codelineno-1-130" href="#__codelineno-1-130"></a><span class="sd">        Args:</span>
</span><span id="__span-1-131"><a id="__codelineno-1-131" name="__codelineno-1-131" href="#__codelineno-1-131"></a><span class="sd">            dataset: Dataset to evaluate</span>
</span><span id="__span-1-132"><a id="__codelineno-1-132" name="__codelineno-1-132" href="#__codelineno-1-132"></a><span class="sd">            demographic_cols: Demographic columns to consider  </span>
</span><span id="__span-1-133"><a id="__codelineno-1-133" name="__codelineno-1-133" href="#__codelineno-1-133"></a><span class="sd">            target_distributions: Target distributions for comparison</span>
</span><span id="__span-1-134"><a id="__codelineno-1-134" name="__codelineno-1-134" href="#__codelineno-1-134"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-1-135"><a id="__codelineno-1-135" name="__codelineno-1-135" href="#__codelineno-1-135"></a>        <span class="n">diversity_scores</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-1-136"><a id="__codelineno-1-136" name="__codelineno-1-136" href="#__codelineno-1-136"></a>
</span><span id="__span-1-137"><a id="__codelineno-1-137" name="__codelineno-1-137" href="#__codelineno-1-137"></a>        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">demographic_cols</span><span class="p">:</span>
</span><span id="__span-1-138"><a id="__codelineno-1-138" name="__codelineno-1-138" href="#__codelineno-1-138"></a>            <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">columns</span> <span class="ow">or</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">target_distributions</span><span class="p">:</span>
</span><span id="__span-1-139"><a id="__codelineno-1-139" name="__codelineno-1-139" href="#__codelineno-1-139"></a>                <span class="k">continue</span>
</span><span id="__span-1-140"><a id="__codelineno-1-140" name="__codelineno-1-140" href="#__codelineno-1-140"></a>
</span><span id="__span-1-141"><a id="__codelineno-1-141" name="__codelineno-1-141" href="#__codelineno-1-141"></a>            <span class="n">actual_dist</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
</span><span id="__span-1-142"><a id="__codelineno-1-142" name="__codelineno-1-142" href="#__codelineno-1-142"></a>            <span class="n">target_dist</span> <span class="o">=</span> <span class="n">target_distributions</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
</span><span id="__span-1-143"><a id="__codelineno-1-143" name="__codelineno-1-143" href="#__codelineno-1-143"></a>
</span><span id="__span-1-144"><a id="__codelineno-1-144" name="__codelineno-1-144" href="#__codelineno-1-144"></a>            <span class="c1"># Calculate Jensen-Shannon divergence as diversity metric</span>
</span><span id="__span-1-145"><a id="__codelineno-1-145" name="__codelineno-1-145" href="#__codelineno-1-145"></a>            <span class="n">all_groups</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">actual_dist</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">target_dist</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="__span-1-146"><a id="__codelineno-1-146" name="__codelineno-1-146" href="#__codelineno-1-146"></a>
</span><span id="__span-1-147"><a id="__codelineno-1-147" name="__codelineno-1-147" href="#__codelineno-1-147"></a>            <span class="n">actual_probs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">actual_dist</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">all_groups</span><span class="p">])</span>
</span><span id="__span-1-148"><a id="__codelineno-1-148" name="__codelineno-1-148" href="#__codelineno-1-148"></a>            <span class="n">target_probs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">target_dist</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">all_groups</span><span class="p">])</span>
</span><span id="__span-1-149"><a id="__codelineno-1-149" name="__codelineno-1-149" href="#__codelineno-1-149"></a>
</span><span id="__span-1-150"><a id="__codelineno-1-150" name="__codelineno-1-150" href="#__codelineno-1-150"></a>            <span class="c1"># Normalize probabilities</span>
</span><span id="__span-1-151"><a id="__codelineno-1-151" name="__codelineno-1-151" href="#__codelineno-1-151"></a>            <span class="n">actual_probs</span> <span class="o">=</span> <span class="n">actual_probs</span> <span class="o">/</span> <span class="n">actual_probs</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="k">if</span> <span class="n">actual_probs</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">actual_probs</span>
</span><span id="__span-1-152"><a id="__codelineno-1-152" name="__codelineno-1-152" href="#__codelineno-1-152"></a>            <span class="n">target_probs</span> <span class="o">=</span> <span class="n">target_probs</span> <span class="o">/</span> <span class="n">target_probs</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="k">if</span> <span class="n">target_probs</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">target_probs</span>
</span><span id="__span-1-153"><a id="__codelineno-1-153" name="__codelineno-1-153" href="#__codelineno-1-153"></a>
</span><span id="__span-1-154"><a id="__codelineno-1-154" name="__codelineno-1-154" href="#__codelineno-1-154"></a>            <span class="c1"># Calculate JS divergence (simplified)</span>
</span><span id="__span-1-155"><a id="__codelineno-1-155" name="__codelineno-1-155" href="#__codelineno-1-155"></a>            <span class="n">avg_probs</span> <span class="o">=</span> <span class="p">(</span><span class="n">actual_probs</span> <span class="o">+</span> <span class="n">target_probs</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="__span-1-156"><a id="__codelineno-1-156" name="__codelineno-1-156" href="#__codelineno-1-156"></a>
</span><span id="__span-1-157"><a id="__codelineno-1-157" name="__codelineno-1-157" href="#__codelineno-1-157"></a>            <span class="k">def</span><span class="w"> </span><span class="nf">kl_divergence</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
</span><span id="__span-1-158"><a id="__codelineno-1-158" name="__codelineno-1-158" href="#__codelineno-1-158"></a>                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">p</span> <span class="o">+</span> <span class="mf">1e-10</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">q</span> <span class="o">+</span> <span class="mf">1e-10</span><span class="p">)))</span>
</span><span id="__span-1-159"><a id="__codelineno-1-159" name="__codelineno-1-159" href="#__codelineno-1-159"></a>
</span><span id="__span-1-160"><a id="__codelineno-1-160" name="__codelineno-1-160" href="#__codelineno-1-160"></a>            <span class="n">js_div</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">kl_divergence</span><span class="p">(</span><span class="n">actual_probs</span><span class="p">,</span> <span class="n">avg_probs</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">kl_divergence</span><span class="p">(</span><span class="n">target_probs</span><span class="p">,</span> <span class="n">avg_probs</span><span class="p">)</span>
</span><span id="__span-1-161"><a id="__codelineno-1-161" name="__codelineno-1-161" href="#__codelineno-1-161"></a>            <span class="n">diversity_score</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">js_div</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>  <span class="c1"># Convert to similarity score</span>
</span><span id="__span-1-162"><a id="__codelineno-1-162" name="__codelineno-1-162" href="#__codelineno-1-162"></a>
</span><span id="__span-1-163"><a id="__codelineno-1-163" name="__codelineno-1-163" href="#__codelineno-1-163"></a>            <span class="n">diversity_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diversity_score</span><span class="p">)</span>
</span><span id="__span-1-164"><a id="__codelineno-1-164" name="__codelineno-1-164" href="#__codelineno-1-164"></a>
</span><span id="__span-1-165"><a id="__codelineno-1-165" name="__codelineno-1-165" href="#__codelineno-1-165"></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">diversity_scores</span><span class="p">)</span> <span class="k">if</span> <span class="n">diversity_scores</span> <span class="k">else</span> <span class="mf">0.0</span>
</span><span id="__span-1-166"><a id="__codelineno-1-166" name="__codelineno-1-166" href="#__codelineno-1-166"></a>
</span><span id="__span-1-167"><a id="__codelineno-1-167" name="__codelineno-1-167" href="#__codelineno-1-167"></a><span class="k">class</span><span class="w"> </span><span class="nc">BiasReweightingFramework</span><span class="p">:</span>
</span><span id="__span-1-168"><a id="__codelineno-1-168" name="__codelineno-1-168" href="#__codelineno-1-168"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Framework for implementing various bias mitigation through reweighting techniques&quot;&quot;&quot;</span>
</span><span id="__span-1-169"><a id="__codelineno-1-169" name="__codelineno-1-169" href="#__codelineno-1-169"></a>
</span><span id="__span-1-170"><a id="__codelineno-1-170" name="__codelineno-1-170" href="#__codelineno-1-170"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-1-171"><a id="__codelineno-1-171" name="__codelineno-1-171" href="#__codelineno-1-171"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reweighting_methods</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-1-172"><a id="__codelineno-1-172" name="__codelineno-1-172" href="#__codelineno-1-172"></a>            <span class="s1">&#39;inverse_propensity&#39;</span><span class="p">:</span> <span class="s1">&#39;Weight samples inversely proportional to group representation&#39;</span><span class="p">,</span>
</span><span id="__span-1-173"><a id="__codelineno-1-173" name="__codelineno-1-173" href="#__codelineno-1-173"></a>            <span class="s1">&#39;fairness_constraints&#39;</span><span class="p">:</span> <span class="s1">&#39;Apply constraints to ensure group-wise fairness&#39;</span><span class="p">,</span>
</span><span id="__span-1-174"><a id="__codelineno-1-174" name="__codelineno-1-174" href="#__codelineno-1-174"></a>            <span class="s1">&#39;adversarial_debiasing&#39;</span><span class="p">:</span> <span class="s1">&#39;Use adversarial training to remove demographic dependencies&#39;</span>
</span><span id="__span-1-175"><a id="__codelineno-1-175" name="__codelineno-1-175" href="#__codelineno-1-175"></a>        <span class="p">}</span>
</span><span id="__span-1-176"><a id="__codelineno-1-176" name="__codelineno-1-176" href="#__codelineno-1-176"></a>
</span><span id="__span-1-177"><a id="__codelineno-1-177" name="__codelineno-1-177" href="#__codelineno-1-177"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_inverse_propensity_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
</span><span id="__span-1-178"><a id="__codelineno-1-178" name="__codelineno-1-178" href="#__codelineno-1-178"></a>                                           <span class="n">protected_attribute</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-1-179"><a id="__codelineno-1-179" name="__codelineno-1-179" href="#__codelineno-1-179"></a>                                           <span class="n">target_distribution</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="__span-1-180"><a id="__codelineno-1-180" name="__codelineno-1-180" href="#__codelineno-1-180"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-1-181"><a id="__codelineno-1-181" name="__codelineno-1-181" href="#__codelineno-1-181"></a><span class="sd">        Calculate inverse propensity weights to balance group representation</span>
</span><span id="__span-1-182"><a id="__codelineno-1-182" name="__codelineno-1-182" href="#__codelineno-1-182"></a>
</span><span id="__span-1-183"><a id="__codelineno-1-183" name="__codelineno-1-183" href="#__codelineno-1-183"></a><span class="sd">        Args:</span>
</span><span id="__span-1-184"><a id="__codelineno-1-184" name="__codelineno-1-184" href="#__codelineno-1-184"></a><span class="sd">            dataset: Dataset to reweight</span>
</span><span id="__span-1-185"><a id="__codelineno-1-185" name="__codelineno-1-185" href="#__codelineno-1-185"></a><span class="sd">            protected_attribute: Protected attribute column</span>
</span><span id="__span-1-186"><a id="__codelineno-1-186" name="__codelineno-1-186" href="#__codelineno-1-186"></a><span class="sd">            target_distribution: Target distribution (uniform if None)</span>
</span><span id="__span-1-187"><a id="__codelineno-1-187" name="__codelineno-1-187" href="#__codelineno-1-187"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-1-188"><a id="__codelineno-1-188" name="__codelineno-1-188" href="#__codelineno-1-188"></a>        <span class="n">group_counts</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="n">protected_attribute</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</span><span id="__span-1-189"><a id="__codelineno-1-189" name="__codelineno-1-189" href="#__codelineno-1-189"></a>        <span class="n">total_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</span><span id="__span-1-190"><a id="__codelineno-1-190" name="__codelineno-1-190" href="#__codelineno-1-190"></a>
</span><span id="__span-1-191"><a id="__codelineno-1-191" name="__codelineno-1-191" href="#__codelineno-1-191"></a>        <span class="k">if</span> <span class="n">target_distribution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-1-192"><a id="__codelineno-1-192" name="__codelineno-1-192" href="#__codelineno-1-192"></a>            <span class="c1"># Uniform distribution</span>
</span><span id="__span-1-193"><a id="__codelineno-1-193" name="__codelineno-1-193" href="#__codelineno-1-193"></a>            <span class="n">n_groups</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">group_counts</span><span class="p">)</span>
</span><span id="__span-1-194"><a id="__codelineno-1-194" name="__codelineno-1-194" href="#__codelineno-1-194"></a>            <span class="n">target_distribution</span> <span class="o">=</span> <span class="p">{</span><span class="n">group</span><span class="p">:</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">n_groups</span> <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">group_counts</span><span class="o">.</span><span class="n">index</span><span class="p">}</span>
</span><span id="__span-1-195"><a id="__codelineno-1-195" name="__codelineno-1-195" href="#__codelineno-1-195"></a>
</span><span id="__span-1-196"><a id="__codelineno-1-196" name="__codelineno-1-196" href="#__codelineno-1-196"></a>        <span class="c1"># Calculate weights</span>
</span><span id="__span-1-197"><a id="__codelineno-1-197" name="__codelineno-1-197" href="#__codelineno-1-197"></a>        <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">))</span>
</span><span id="__span-1-198"><a id="__codelineno-1-198" name="__codelineno-1-198" href="#__codelineno-1-198"></a>
</span><span id="__span-1-199"><a id="__codelineno-1-199" name="__codelineno-1-199" href="#__codelineno-1-199"></a>        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">group_counts</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
</span><span id="__span-1-200"><a id="__codelineno-1-200" name="__codelineno-1-200" href="#__codelineno-1-200"></a>            <span class="n">group_mask</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="n">protected_attribute</span><span class="p">]</span> <span class="o">==</span> <span class="n">group</span>
</span><span id="__span-1-201"><a id="__codelineno-1-201" name="__codelineno-1-201" href="#__codelineno-1-201"></a>            <span class="n">current_prop</span> <span class="o">=</span> <span class="n">group_counts</span><span class="p">[</span><span class="n">group</span><span class="p">]</span> <span class="o">/</span> <span class="n">total_samples</span>
</span><span id="__span-1-202"><a id="__codelineno-1-202" name="__codelineno-1-202" href="#__codelineno-1-202"></a>            <span class="n">target_prop</span> <span class="o">=</span> <span class="n">target_distribution</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">current_prop</span><span class="p">)</span>
</span><span id="__span-1-203"><a id="__codelineno-1-203" name="__codelineno-1-203" href="#__codelineno-1-203"></a>
</span><span id="__span-1-204"><a id="__codelineno-1-204" name="__codelineno-1-204" href="#__codelineno-1-204"></a>            <span class="k">if</span> <span class="n">current_prop</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-1-205"><a id="__codelineno-1-205" name="__codelineno-1-205" href="#__codelineno-1-205"></a>                <span class="n">weight</span> <span class="o">=</span> <span class="n">target_prop</span> <span class="o">/</span> <span class="n">current_prop</span>
</span><span id="__span-1-206"><a id="__codelineno-1-206" name="__codelineno-1-206" href="#__codelineno-1-206"></a>                <span class="n">weights</span><span class="p">[</span><span class="n">group_mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">weight</span>
</span><span id="__span-1-207"><a id="__codelineno-1-207" name="__codelineno-1-207" href="#__codelineno-1-207"></a>
</span><span id="__span-1-208"><a id="__codelineno-1-208" name="__codelineno-1-208" href="#__codelineno-1-208"></a>        <span class="c1"># Normalize weights to sum to original dataset size</span>
</span><span id="__span-1-209"><a id="__codelineno-1-209" name="__codelineno-1-209" href="#__codelineno-1-209"></a>        <span class="n">weights</span> <span class="o">=</span> <span class="n">weights</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span> <span class="o">/</span> <span class="n">weights</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</span><span id="__span-1-210"><a id="__codelineno-1-210" name="__codelineno-1-210" href="#__codelineno-1-210"></a>
</span><span id="__span-1-211"><a id="__codelineno-1-211" name="__codelineno-1-211" href="#__codelineno-1-211"></a>        <span class="k">return</span> <span class="n">weights</span>
</span><span id="__span-1-212"><a id="__codelineno-1-212" name="__codelineno-1-212" href="#__codelineno-1-212"></a>
</span><span id="__span-1-213"><a id="__codelineno-1-213" name="__codelineno-1-213" href="#__codelineno-1-213"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">apply_fairness_constraints_reweighting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="__span-1-214"><a id="__codelineno-1-214" name="__codelineno-1-214" href="#__codelineno-1-214"></a>                                             <span class="n">protected_attr</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="__span-1-215"><a id="__codelineno-1-215" name="__codelineno-1-215" href="#__codelineno-1-215"></a>                                             <span class="n">fairness_metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;demographic_parity&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="__span-1-216"><a id="__codelineno-1-216" name="__codelineno-1-216" href="#__codelineno-1-216"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-1-217"><a id="__codelineno-1-217" name="__codelineno-1-217" href="#__codelineno-1-217"></a><span class="sd">        Apply reweighting to satisfy fairness constraints</span>
</span><span id="__span-1-218"><a id="__codelineno-1-218" name="__codelineno-1-218" href="#__codelineno-1-218"></a>
</span><span id="__span-1-219"><a id="__codelineno-1-219" name="__codelineno-1-219" href="#__codelineno-1-219"></a><span class="sd">        Args:</span>
</span><span id="__span-1-220"><a id="__codelineno-1-220" name="__codelineno-1-220" href="#__codelineno-1-220"></a><span class="sd">            X: Feature matrix</span>
</span><span id="__span-1-221"><a id="__codelineno-1-221" name="__codelineno-1-221" href="#__codelineno-1-221"></a><span class="sd">            y: Target labels</span>
</span><span id="__span-1-222"><a id="__codelineno-1-222" name="__codelineno-1-222" href="#__codelineno-1-222"></a><span class="sd">            protected_attr: Protected attribute values</span>
</span><span id="__span-1-223"><a id="__codelineno-1-223" name="__codelineno-1-223" href="#__codelineno-1-223"></a><span class="sd">            fairness_metric: Type of fairness to optimize for</span>
</span><span id="__span-1-224"><a id="__codelineno-1-224" name="__codelineno-1-224" href="#__codelineno-1-224"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-1-225"><a id="__codelineno-1-225" name="__codelineno-1-225" href="#__codelineno-1-225"></a>        <span class="n">unique_groups</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">protected_attr</span><span class="p">)</span>
</span><span id="__span-1-226"><a id="__codelineno-1-226" name="__codelineno-1-226" href="#__codelineno-1-226"></a>        <span class="n">unique_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="__span-1-227"><a id="__codelineno-1-227" name="__codelineno-1-227" href="#__codelineno-1-227"></a>
</span><span id="__span-1-228"><a id="__codelineno-1-228" name="__codelineno-1-228" href="#__codelineno-1-228"></a>        <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
</span><span id="__span-1-229"><a id="__codelineno-1-229" name="__codelineno-1-229" href="#__codelineno-1-229"></a>
</span><span id="__span-1-230"><a id="__codelineno-1-230" name="__codelineno-1-230" href="#__codelineno-1-230"></a>        <span class="k">if</span> <span class="n">fairness_metric</span> <span class="o">==</span> <span class="s1">&#39;demographic_parity&#39;</span><span class="p">:</span>
</span><span id="__span-1-231"><a id="__codelineno-1-231" name="__codelineno-1-231" href="#__codelineno-1-231"></a>            <span class="c1"># Balance positive prediction rates across groups</span>
</span><span id="__span-1-232"><a id="__codelineno-1-232" name="__codelineno-1-232" href="#__codelineno-1-232"></a>            <span class="n">overall_positive_rate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="__span-1-233"><a id="__codelineno-1-233" name="__codelineno-1-233" href="#__codelineno-1-233"></a>
</span><span id="__span-1-234"><a id="__codelineno-1-234" name="__codelineno-1-234" href="#__codelineno-1-234"></a>            <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">unique_groups</span><span class="p">:</span>
</span><span id="__span-1-235"><a id="__codelineno-1-235" name="__codelineno-1-235" href="#__codelineno-1-235"></a>                <span class="n">group_mask</span> <span class="o">=</span> <span class="n">protected_attr</span> <span class="o">==</span> <span class="n">group</span>
</span><span id="__span-1-236"><a id="__codelineno-1-236" name="__codelineno-1-236" href="#__codelineno-1-236"></a>                <span class="n">group_positive_rate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">group_mask</span><span class="p">])</span>
</span><span id="__span-1-237"><a id="__codelineno-1-237" name="__codelineno-1-237" href="#__codelineno-1-237"></a>
</span><span id="__span-1-238"><a id="__codelineno-1-238" name="__codelineno-1-238" href="#__codelineno-1-238"></a>                <span class="k">if</span> <span class="n">group_positive_rate</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-1-239"><a id="__codelineno-1-239" name="__codelineno-1-239" href="#__codelineno-1-239"></a>                    <span class="c1"># Adjust weights to match overall positive rate</span>
</span><span id="__span-1-240"><a id="__codelineno-1-240" name="__codelineno-1-240" href="#__codelineno-1-240"></a>                    <span class="n">positive_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">protected_attr</span> <span class="o">==</span> <span class="n">group</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-1-241"><a id="__codelineno-1-241" name="__codelineno-1-241" href="#__codelineno-1-241"></a>                    <span class="n">negative_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">protected_attr</span> <span class="o">==</span> <span class="n">group</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="__span-1-242"><a id="__codelineno-1-242" name="__codelineno-1-242" href="#__codelineno-1-242"></a>
</span><span id="__span-1-243"><a id="__codelineno-1-243" name="__codelineno-1-243" href="#__codelineno-1-243"></a>                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">positive_mask</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-1-244"><a id="__codelineno-1-244" name="__codelineno-1-244" href="#__codelineno-1-244"></a>                        <span class="n">weights</span><span class="p">[</span><span class="n">positive_mask</span><span class="p">]</span> <span class="o">*=</span> <span class="p">(</span><span class="n">overall_positive_rate</span> <span class="o">/</span> <span class="n">group_positive_rate</span><span class="p">)</span>
</span><span id="__span-1-245"><a id="__codelineno-1-245" name="__codelineno-1-245" href="#__codelineno-1-245"></a>                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">negative_mask</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-1-246"><a id="__codelineno-1-246" name="__codelineno-1-246" href="#__codelineno-1-246"></a>                        <span class="n">weights</span><span class="p">[</span><span class="n">negative_mask</span><span class="p">]</span> <span class="o">*=</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">overall_positive_rate</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">group_positive_rate</span><span class="p">))</span>
</span><span id="__span-1-247"><a id="__codelineno-1-247" name="__codelineno-1-247" href="#__codelineno-1-247"></a>
</span><span id="__span-1-248"><a id="__codelineno-1-248" name="__codelineno-1-248" href="#__codelineno-1-248"></a>        <span class="k">elif</span> <span class="n">fairness_metric</span> <span class="o">==</span> <span class="s1">&#39;equalized_odds&#39;</span><span class="p">:</span>
</span><span id="__span-1-249"><a id="__codelineno-1-249" name="__codelineno-1-249" href="#__codelineno-1-249"></a>            <span class="c1"># Balance true positive and false positive rates across groups</span>
</span><span id="__span-1-250"><a id="__codelineno-1-250" name="__codelineno-1-250" href="#__codelineno-1-250"></a>            <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">unique_labels</span><span class="p">:</span>
</span><span id="__span-1-251"><a id="__codelineno-1-251" name="__codelineno-1-251" href="#__codelineno-1-251"></a>                <span class="n">label_mask</span> <span class="o">=</span> <span class="n">y</span> <span class="o">==</span> <span class="n">label</span>
</span><span id="__span-1-252"><a id="__codelineno-1-252" name="__codelineno-1-252" href="#__codelineno-1-252"></a>                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">label_mask</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-1-253"><a id="__codelineno-1-253" name="__codelineno-1-253" href="#__codelineno-1-253"></a>                    <span class="k">continue</span>
</span><span id="__span-1-254"><a id="__codelineno-1-254" name="__codelineno-1-254" href="#__codelineno-1-254"></a>
</span><span id="__span-1-255"><a id="__codelineno-1-255" name="__codelineno-1-255" href="#__codelineno-1-255"></a>                <span class="n">overall_rate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">label_mask</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="__span-1-256"><a id="__codelineno-1-256" name="__codelineno-1-256" href="#__codelineno-1-256"></a>
</span><span id="__span-1-257"><a id="__codelineno-1-257" name="__codelineno-1-257" href="#__codelineno-1-257"></a>                <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">unique_groups</span><span class="p">:</span>
</span><span id="__span-1-258"><a id="__codelineno-1-258" name="__codelineno-1-258" href="#__codelineno-1-258"></a>                    <span class="n">group_label_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">protected_attr</span> <span class="o">==</span> <span class="n">group</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">label_mask</span>
</span><span id="__span-1-259"><a id="__codelineno-1-259" name="__codelineno-1-259" href="#__codelineno-1-259"></a>                    <span class="n">group_mask</span> <span class="o">=</span> <span class="n">protected_attr</span> <span class="o">==</span> <span class="n">group</span>
</span><span id="__span-1-260"><a id="__codelineno-1-260" name="__codelineno-1-260" href="#__codelineno-1-260"></a>
</span><span id="__span-1-261"><a id="__codelineno-1-261" name="__codelineno-1-261" href="#__codelineno-1-261"></a>                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">group_mask</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-1-262"><a id="__codelineno-1-262" name="__codelineno-1-262" href="#__codelineno-1-262"></a>                        <span class="n">group_rate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">group_label_mask</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">group_mask</span><span class="p">)</span>
</span><span id="__span-1-263"><a id="__codelineno-1-263" name="__codelineno-1-263" href="#__codelineno-1-263"></a>                        <span class="k">if</span> <span class="n">group_rate</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-1-264"><a id="__codelineno-1-264" name="__codelineno-1-264" href="#__codelineno-1-264"></a>                            <span class="n">adjustment</span> <span class="o">=</span> <span class="n">overall_rate</span> <span class="o">/</span> <span class="n">group_rate</span>
</span><span id="__span-1-265"><a id="__codelineno-1-265" name="__codelineno-1-265" href="#__codelineno-1-265"></a>                            <span class="n">weights</span><span class="p">[</span><span class="n">group_label_mask</span><span class="p">]</span> <span class="o">*=</span> <span class="n">adjustment</span>
</span><span id="__span-1-266"><a id="__codelineno-1-266" name="__codelineno-1-266" href="#__codelineno-1-266"></a>
</span><span id="__span-1-267"><a id="__codelineno-1-267" name="__codelineno-1-267" href="#__codelineno-1-267"></a>        <span class="c1"># Normalize weights</span>
</span><span id="__span-1-268"><a id="__codelineno-1-268" name="__codelineno-1-268" href="#__codelineno-1-268"></a>        <span class="n">weights</span> <span class="o">=</span> <span class="n">weights</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">/</span> <span class="n">weights</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</span><span id="__span-1-269"><a id="__codelineno-1-269" name="__codelineno-1-269" href="#__codelineno-1-269"></a>
</span><span id="__span-1-270"><a id="__codelineno-1-270" name="__codelineno-1-270" href="#__codelineno-1-270"></a>        <span class="k">return</span> <span class="n">weights</span>
</span><span id="__span-1-271"><a id="__codelineno-1-271" name="__codelineno-1-271" href="#__codelineno-1-271"></a>
</span><span id="__span-1-272"><a id="__codelineno-1-272" name="__codelineno-1-272" href="#__codelineno-1-272"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">implement_adversarial_debiasing_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
</span><span id="__span-1-273"><a id="__codelineno-1-273" name="__codelineno-1-273" href="#__codelineno-1-273"></a>                                              <span class="n">protected_attr</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="__span-1-274"><a id="__codelineno-1-274" name="__codelineno-1-274" href="#__codelineno-1-274"></a>                                              <span class="n">learning_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="__span-1-275"><a id="__codelineno-1-275" name="__codelineno-1-275" href="#__codelineno-1-275"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-1-276"><a id="__codelineno-1-276" name="__codelineno-1-276" href="#__codelineno-1-276"></a><span class="sd">        Implement adversarial debiasing through sample reweighting</span>
</span><span id="__span-1-277"><a id="__codelineno-1-277" name="__codelineno-1-277" href="#__codelineno-1-277"></a>
</span><span id="__span-1-278"><a id="__codelineno-1-278" name="__codelineno-1-278" href="#__codelineno-1-278"></a><span class="sd">        Args:</span>
</span><span id="__span-1-279"><a id="__codelineno-1-279" name="__codelineno-1-279" href="#__codelineno-1-279"></a><span class="sd">            X: Feature matrix</span>
</span><span id="__span-1-280"><a id="__codelineno-1-280" name="__codelineno-1-280" href="#__codelineno-1-280"></a><span class="sd">            protected_attr: Protected attribute values</span>
</span><span id="__span-1-281"><a id="__codelineno-1-281" name="__codelineno-1-281" href="#__codelineno-1-281"></a><span class="sd">            learning_rate: Learning rate for weight updates</span>
</span><span id="__span-1-282"><a id="__codelineno-1-282" name="__codelineno-1-282" href="#__codelineno-1-282"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-1-283"><a id="__codelineno-1-283" name="__codelineno-1-283" href="#__codelineno-1-283"></a>        <span class="c1"># Simplified adversarial reweighting</span>
</span><span id="__span-1-284"><a id="__codelineno-1-284" name="__codelineno-1-284" href="#__codelineno-1-284"></a>        <span class="c1"># In practice, this would involve training adversarial networks</span>
</span><span id="__span-1-285"><a id="__codelineno-1-285" name="__codelineno-1-285" href="#__codelineno-1-285"></a>
</span><span id="__span-1-286"><a id="__codelineno-1-286" name="__codelineno-1-286" href="#__codelineno-1-286"></a>        <span class="n">n_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="__span-1-287"><a id="__codelineno-1-287" name="__codelineno-1-287" href="#__codelineno-1-287"></a>        <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span>
</span><span id="__span-1-288"><a id="__codelineno-1-288" name="__codelineno-1-288" href="#__codelineno-1-288"></a>
</span><span id="__span-1-289"><a id="__codelineno-1-289" name="__codelineno-1-289" href="#__codelineno-1-289"></a>        <span class="c1"># Calculate feature importance for predicting protected attribute</span>
</span><span id="__span-1-290"><a id="__codelineno-1-290" name="__codelineno-1-290" href="#__codelineno-1-290"></a>        <span class="c1"># Use correlation as a simple proxy</span>
</span><span id="__span-1-291"><a id="__codelineno-1-291" name="__codelineno-1-291" href="#__codelineno-1-291"></a>        <span class="n">feature_correlations</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-1-292"><a id="__codelineno-1-292" name="__codelineno-1-292" href="#__codelineno-1-292"></a>        <span class="k">for</span> <span class="n">feature_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="__span-1-293"><a id="__codelineno-1-293" name="__codelineno-1-293" href="#__codelineno-1-293"></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="n">feature_idx</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-1-294"><a id="__codelineno-1-294" name="__codelineno-1-294" href="#__codelineno-1-294"></a>                <span class="n">corr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="n">feature_idx</span><span class="p">],</span> <span class="n">protected_attr</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="__span-1-295"><a id="__codelineno-1-295" name="__codelineno-1-295" href="#__codelineno-1-295"></a>                <span class="n">feature_correlations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">corr</span><span class="p">))</span>
</span><span id="__span-1-296"><a id="__codelineno-1-296" name="__codelineno-1-296" href="#__codelineno-1-296"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-1-297"><a id="__codelineno-1-297" name="__codelineno-1-297" href="#__codelineno-1-297"></a>                <span class="n">feature_correlations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-1-298"><a id="__codelineno-1-298" name="__codelineno-1-298" href="#__codelineno-1-298"></a>
</span><span id="__span-1-299"><a id="__codelineno-1-299" name="__codelineno-1-299" href="#__codelineno-1-299"></a>        <span class="n">feature_correlations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">feature_correlations</span><span class="p">)</span>
</span><span id="__span-1-300"><a id="__codelineno-1-300" name="__codelineno-1-300" href="#__codelineno-1-300"></a>
</span><span id="__span-1-301"><a id="__codelineno-1-301" name="__codelineno-1-301" href="#__codelineno-1-301"></a>        <span class="c1"># Reweight samples based on how predictive their features are of protected attribute</span>
</span><span id="__span-1-302"><a id="__codelineno-1-302" name="__codelineno-1-302" href="#__codelineno-1-302"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_samples</span><span class="p">):</span>
</span><span id="__span-1-303"><a id="__codelineno-1-303" name="__codelineno-1-303" href="#__codelineno-1-303"></a>            <span class="n">sample_predictiveness</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">feature_correlations</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]))</span>
</span><span id="__span-1-304"><a id="__codelineno-1-304" name="__codelineno-1-304" href="#__codelineno-1-304"></a>            <span class="c1"># Lower weight for samples that make protected attribute easy to predict</span>
</span><span id="__span-1-305"><a id="__codelineno-1-305" name="__codelineno-1-305" href="#__codelineno-1-305"></a>            <span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">sample_predictiveness</span><span class="p">)</span>
</span><span id="__span-1-306"><a id="__codelineno-1-306" name="__codelineno-1-306" href="#__codelineno-1-306"></a>
</span><span id="__span-1-307"><a id="__codelineno-1-307" name="__codelineno-1-307" href="#__codelineno-1-307"></a>        <span class="c1"># Normalize weights</span>
</span><span id="__span-1-308"><a id="__codelineno-1-308" name="__codelineno-1-308" href="#__codelineno-1-308"></a>        <span class="n">weights</span> <span class="o">=</span> <span class="n">weights</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_samples</span> <span class="o">/</span> <span class="n">weights</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</span><span id="__span-1-309"><a id="__codelineno-1-309" name="__codelineno-1-309" href="#__codelineno-1-309"></a>
</span><span id="__span-1-310"><a id="__codelineno-1-310" name="__codelineno-1-310" href="#__codelineno-1-310"></a>        <span class="k">return</span> <span class="n">weights</span>
</span><span id="__span-1-311"><a id="__codelineno-1-311" name="__codelineno-1-311" href="#__codelineno-1-311"></a>
</span><span id="__span-1-312"><a id="__codelineno-1-312" name="__codelineno-1-312" href="#__codelineno-1-312"></a><span class="k">class</span><span class="w"> </span><span class="nc">FairnessAwareMetrics</span><span class="p">:</span>
</span><span id="__span-1-313"><a id="__codelineno-1-313" name="__codelineno-1-313" href="#__codelineno-1-313"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Framework for implementing and calculating fairness-aware evaluation metrics&quot;&quot;&quot;</span>
</span><span id="__span-1-314"><a id="__codelineno-1-314" name="__codelineno-1-314" href="#__codelineno-1-314"></a>
</span><span id="__span-1-315"><a id="__codelineno-1-315" name="__codelineno-1-315" href="#__codelineno-1-315"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-1-316"><a id="__codelineno-1-316" name="__codelineno-1-316" href="#__codelineno-1-316"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fairness_metrics</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-1-317"><a id="__codelineno-1-317" name="__codelineno-1-317" href="#__codelineno-1-317"></a>            <span class="s1">&#39;demographic_parity&#39;</span><span class="p">:</span> <span class="s1">&#39;Equal positive prediction rates across groups&#39;</span><span class="p">,</span>
</span><span id="__span-1-318"><a id="__codelineno-1-318" name="__codelineno-1-318" href="#__codelineno-1-318"></a>            <span class="s1">&#39;equalized_odds&#39;</span><span class="p">:</span> <span class="s1">&#39;Equal TPR and FPR across groups&#39;</span><span class="p">,</span>
</span><span id="__span-1-319"><a id="__codelineno-1-319" name="__codelineno-1-319" href="#__codelineno-1-319"></a>            <span class="s1">&#39;equal_opportunity&#39;</span><span class="p">:</span> <span class="s1">&#39;Equal TPR across groups&#39;</span><span class="p">,</span>
</span><span id="__span-1-320"><a id="__codelineno-1-320" name="__codelineno-1-320" href="#__codelineno-1-320"></a>            <span class="s1">&#39;calibration&#39;</span><span class="p">:</span> <span class="s1">&#39;Equal precision across groups for same confidence levels&#39;</span>
</span><span id="__span-1-321"><a id="__codelineno-1-321" name="__codelineno-1-321" href="#__codelineno-1-321"></a>        <span class="p">}</span>
</span><span id="__span-1-322"><a id="__codelineno-1-322" name="__codelineno-1-322" href="#__codelineno-1-322"></a>
</span><span id="__span-1-323"><a id="__codelineno-1-323" name="__codelineno-1-323" href="#__codelineno-1-323"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_demographic_parity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
</span><span id="__span-1-324"><a id="__codelineno-1-324" name="__codelineno-1-324" href="#__codelineno-1-324"></a>                                   <span class="n">protected_attr</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
</span><span id="__span-1-325"><a id="__codelineno-1-325" name="__codelineno-1-325" href="#__codelineno-1-325"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate demographic parity metrics&quot;&quot;&quot;</span>
</span><span id="__span-1-326"><a id="__codelineno-1-326" name="__codelineno-1-326" href="#__codelineno-1-326"></a>        <span class="n">groups</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">protected_attr</span><span class="p">)</span>
</span><span id="__span-1-327"><a id="__codelineno-1-327" name="__codelineno-1-327" href="#__codelineno-1-327"></a>        <span class="n">group_rates</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-1-328"><a id="__codelineno-1-328" name="__codelineno-1-328" href="#__codelineno-1-328"></a>
</span><span id="__span-1-329"><a id="__codelineno-1-329" name="__codelineno-1-329" href="#__codelineno-1-329"></a>        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
</span><span id="__span-1-330"><a id="__codelineno-1-330" name="__codelineno-1-330" href="#__codelineno-1-330"></a>            <span class="n">group_mask</span> <span class="o">=</span> <span class="n">protected_attr</span> <span class="o">==</span> <span class="n">group</span>
</span><span id="__span-1-331"><a id="__codelineno-1-331" name="__codelineno-1-331" href="#__codelineno-1-331"></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">group_mask</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-1-332"><a id="__codelineno-1-332" name="__codelineno-1-332" href="#__codelineno-1-332"></a>                <span class="n">positive_rate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_pred</span><span class="p">[</span><span class="n">group_mask</span><span class="p">])</span>
</span><span id="__span-1-333"><a id="__codelineno-1-333" name="__codelineno-1-333" href="#__codelineno-1-333"></a>                <span class="n">group_rates</span><span class="p">[</span><span class="n">group</span><span class="p">]</span> <span class="o">=</span> <span class="n">positive_rate</span>
</span><span id="__span-1-334"><a id="__codelineno-1-334" name="__codelineno-1-334" href="#__codelineno-1-334"></a>
</span><span id="__span-1-335"><a id="__codelineno-1-335" name="__codelineno-1-335" href="#__codelineno-1-335"></a>        <span class="c1"># Calculate parity measures</span>
</span><span id="__span-1-336"><a id="__codelineno-1-336" name="__codelineno-1-336" href="#__codelineno-1-336"></a>        <span class="n">rates</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">group_rates</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="__span-1-337"><a id="__codelineno-1-337" name="__codelineno-1-337" href="#__codelineno-1-337"></a>        <span class="n">parity_difference</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">rates</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">rates</span><span class="p">)</span> <span class="k">if</span> <span class="n">rates</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="__span-1-338"><a id="__codelineno-1-338" name="__codelineno-1-338" href="#__codelineno-1-338"></a>        <span class="n">parity_ratio</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">rates</span><span class="p">)</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">rates</span><span class="p">)</span> <span class="k">if</span> <span class="n">rates</span> <span class="ow">and</span> <span class="nb">max</span><span class="p">(</span><span class="n">rates</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span>
</span><span id="__span-1-339"><a id="__codelineno-1-339" name="__codelineno-1-339" href="#__codelineno-1-339"></a>
</span><span id="__span-1-340"><a id="__codelineno-1-340" name="__codelineno-1-340" href="#__codelineno-1-340"></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-1-341"><a id="__codelineno-1-341" name="__codelineno-1-341" href="#__codelineno-1-341"></a>            <span class="s1">&#39;group_rates&#39;</span><span class="p">:</span> <span class="n">group_rates</span><span class="p">,</span>
</span><span id="__span-1-342"><a id="__codelineno-1-342" name="__codelineno-1-342" href="#__codelineno-1-342"></a>            <span class="s1">&#39;parity_difference&#39;</span><span class="p">:</span> <span class="n">parity_difference</span><span class="p">,</span>
</span><span id="__span-1-343"><a id="__codelineno-1-343" name="__codelineno-1-343" href="#__codelineno-1-343"></a>            <span class="s1">&#39;parity_ratio&#39;</span><span class="p">:</span> <span class="n">parity_ratio</span><span class="p">,</span>
</span><span id="__span-1-344"><a id="__codelineno-1-344" name="__codelineno-1-344" href="#__codelineno-1-344"></a>            <span class="s1">&#39;is_fair&#39;</span><span class="p">:</span> <span class="n">parity_difference</span> <span class="o">&lt;</span> <span class="mf">0.1</span>  <span class="c1"># Common threshold</span>
</span><span id="__span-1-345"><a id="__codelineno-1-345" name="__codelineno-1-345" href="#__codelineno-1-345"></a>        <span class="p">}</span>
</span><span id="__span-1-346"><a id="__codelineno-1-346" name="__codelineno-1-346" href="#__codelineno-1-346"></a>
</span><span id="__span-1-347"><a id="__codelineno-1-347" name="__codelineno-1-347" href="#__codelineno-1-347"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_equalized_odds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_true</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="__span-1-348"><a id="__codelineno-1-348" name="__codelineno-1-348" href="#__codelineno-1-348"></a>                               <span class="n">protected_attr</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
</span><span id="__span-1-349"><a id="__codelineno-1-349" name="__codelineno-1-349" href="#__codelineno-1-349"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate equalized odds metrics&quot;&quot;&quot;</span>
</span><span id="__span-1-350"><a id="__codelineno-1-350" name="__codelineno-1-350" href="#__codelineno-1-350"></a>        <span class="n">groups</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">protected_attr</span><span class="p">)</span>
</span><span id="__span-1-351"><a id="__codelineno-1-351" name="__codelineno-1-351" href="#__codelineno-1-351"></a>        <span class="n">group_metrics</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-1-352"><a id="__codelineno-1-352" name="__codelineno-1-352" href="#__codelineno-1-352"></a>
</span><span id="__span-1-353"><a id="__codelineno-1-353" name="__codelineno-1-353" href="#__codelineno-1-353"></a>        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
</span><span id="__span-1-354"><a id="__codelineno-1-354" name="__codelineno-1-354" href="#__codelineno-1-354"></a>            <span class="n">group_mask</span> <span class="o">=</span> <span class="n">protected_attr</span> <span class="o">==</span> <span class="n">group</span>
</span><span id="__span-1-355"><a id="__codelineno-1-355" name="__codelineno-1-355" href="#__codelineno-1-355"></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">group_mask</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-1-356"><a id="__codelineno-1-356" name="__codelineno-1-356" href="#__codelineno-1-356"></a>                <span class="n">y_true_group</span> <span class="o">=</span> <span class="n">y_true</span><span class="p">[</span><span class="n">group_mask</span><span class="p">]</span>
</span><span id="__span-1-357"><a id="__codelineno-1-357" name="__codelineno-1-357" href="#__codelineno-1-357"></a>                <span class="n">y_pred_group</span> <span class="o">=</span> <span class="n">y_pred</span><span class="p">[</span><span class="n">group_mask</span><span class="p">]</span>
</span><span id="__span-1-358"><a id="__codelineno-1-358" name="__codelineno-1-358" href="#__codelineno-1-358"></a>
</span><span id="__span-1-359"><a id="__codelineno-1-359" name="__codelineno-1-359" href="#__codelineno-1-359"></a>                <span class="c1"># True Positive Rate</span>
</span><span id="__span-1-360"><a id="__codelineno-1-360" name="__codelineno-1-360" href="#__codelineno-1-360"></a>                <span class="n">tpr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_pred_group</span><span class="p">[</span><span class="n">y_true_group</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y_true_group</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="__span-1-361"><a id="__codelineno-1-361" name="__codelineno-1-361" href="#__codelineno-1-361"></a>
</span><span id="__span-1-362"><a id="__codelineno-1-362" name="__codelineno-1-362" href="#__codelineno-1-362"></a>                <span class="c1"># False Positive Rate  </span>
</span><span id="__span-1-363"><a id="__codelineno-1-363" name="__codelineno-1-363" href="#__codelineno-1-363"></a>                <span class="n">fpr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_pred_group</span><span class="p">[</span><span class="n">y_true_group</span> <span class="o">==</span> <span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y_true_group</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="__span-1-364"><a id="__codelineno-1-364" name="__codelineno-1-364" href="#__codelineno-1-364"></a>
</span><span id="__span-1-365"><a id="__codelineno-1-365" name="__codelineno-1-365" href="#__codelineno-1-365"></a>                <span class="n">group_metrics</span><span class="p">[</span><span class="n">group</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;tpr&#39;</span><span class="p">:</span> <span class="n">tpr</span><span class="p">,</span> <span class="s1">&#39;fpr&#39;</span><span class="p">:</span> <span class="n">fpr</span><span class="p">}</span>
</span><span id="__span-1-366"><a id="__codelineno-1-366" name="__codelineno-1-366" href="#__codelineno-1-366"></a>
</span><span id="__span-1-367"><a id="__codelineno-1-367" name="__codelineno-1-367" href="#__codelineno-1-367"></a>        <span class="c1"># Calculate equalized odds violations</span>
</span><span id="__span-1-368"><a id="__codelineno-1-368" name="__codelineno-1-368" href="#__codelineno-1-368"></a>        <span class="n">tprs</span> <span class="o">=</span> <span class="p">[</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;tpr&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">metrics</span> <span class="ow">in</span> <span class="n">group_metrics</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
</span><span id="__span-1-369"><a id="__codelineno-1-369" name="__codelineno-1-369" href="#__codelineno-1-369"></a>        <span class="n">fprs</span> <span class="o">=</span> <span class="p">[</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;fpr&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">metrics</span> <span class="ow">in</span> <span class="n">group_metrics</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
</span><span id="__span-1-370"><a id="__codelineno-1-370" name="__codelineno-1-370" href="#__codelineno-1-370"></a>
</span><span id="__span-1-371"><a id="__codelineno-1-371" name="__codelineno-1-371" href="#__codelineno-1-371"></a>        <span class="n">tpr_difference</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">tprs</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">tprs</span><span class="p">)</span> <span class="k">if</span> <span class="n">tprs</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="__span-1-372"><a id="__codelineno-1-372" name="__codelineno-1-372" href="#__codelineno-1-372"></a>        <span class="n">fpr_difference</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">fprs</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">fprs</span><span class="p">)</span> <span class="k">if</span> <span class="n">fprs</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="__span-1-373"><a id="__codelineno-1-373" name="__codelineno-1-373" href="#__codelineno-1-373"></a>
</span><span id="__span-1-374"><a id="__codelineno-1-374" name="__codelineno-1-374" href="#__codelineno-1-374"></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-1-375"><a id="__codelineno-1-375" name="__codelineno-1-375" href="#__codelineno-1-375"></a>            <span class="s1">&#39;group_metrics&#39;</span><span class="p">:</span> <span class="n">group_metrics</span><span class="p">,</span>
</span><span id="__span-1-376"><a id="__codelineno-1-376" name="__codelineno-1-376" href="#__codelineno-1-376"></a>            <span class="s1">&#39;tpr_difference&#39;</span><span class="p">:</span> <span class="n">tpr_difference</span><span class="p">,</span>
</span><span id="__span-1-377"><a id="__codelineno-1-377" name="__codelineno-1-377" href="#__codelineno-1-377"></a>            <span class="s1">&#39;fpr_difference&#39;</span><span class="p">:</span> <span class="n">fpr_difference</span><span class="p">,</span>
</span><span id="__span-1-378"><a id="__codelineno-1-378" name="__codelineno-1-378" href="#__codelineno-1-378"></a>            <span class="s1">&#39;max_violation&#39;</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="n">tpr_difference</span><span class="p">,</span> <span class="n">fpr_difference</span><span class="p">),</span>
</span><span id="__span-1-379"><a id="__codelineno-1-379" name="__codelineno-1-379" href="#__codelineno-1-379"></a>            <span class="s1">&#39;is_fair&#39;</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="n">tpr_difference</span><span class="p">,</span> <span class="n">fpr_difference</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.1</span>
</span><span id="__span-1-380"><a id="__codelineno-1-380" name="__codelineno-1-380" href="#__codelineno-1-380"></a>        <span class="p">}</span>
</span><span id="__span-1-381"><a id="__codelineno-1-381" name="__codelineno-1-381" href="#__codelineno-1-381"></a>
</span><span id="__span-1-382"><a id="__codelineno-1-382" name="__codelineno-1-382" href="#__codelineno-1-382"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_calibration_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_true</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y_prob</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="__span-1-383"><a id="__codelineno-1-383" name="__codelineno-1-383" href="#__codelineno-1-383"></a>                                    <span class="n">protected_attr</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
</span><span id="__span-1-384"><a id="__codelineno-1-384" name="__codelineno-1-384" href="#__codelineno-1-384"></a>                                    <span class="n">n_bins</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
</span><span id="__span-1-385"><a id="__codelineno-1-385" name="__codelineno-1-385" href="#__codelineno-1-385"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate calibration fairness metrics&quot;&quot;&quot;</span>
</span><span id="__span-1-386"><a id="__codelineno-1-386" name="__codelineno-1-386" href="#__codelineno-1-386"></a>        <span class="n">groups</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">protected_attr</span><span class="p">)</span>
</span><span id="__span-1-387"><a id="__codelineno-1-387" name="__codelineno-1-387" href="#__codelineno-1-387"></a>        <span class="n">calibration_metrics</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-1-388"><a id="__codelineno-1-388" name="__codelineno-1-388" href="#__codelineno-1-388"></a>
</span><span id="__span-1-389"><a id="__codelineno-1-389" name="__codelineno-1-389" href="#__codelineno-1-389"></a>        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
</span><span id="__span-1-390"><a id="__codelineno-1-390" name="__codelineno-1-390" href="#__codelineno-1-390"></a>            <span class="n">group_mask</span> <span class="o">=</span> <span class="n">protected_attr</span> <span class="o">==</span> <span class="n">group</span>
</span><span id="__span-1-391"><a id="__codelineno-1-391" name="__codelineno-1-391" href="#__codelineno-1-391"></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">group_mask</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-1-392"><a id="__codelineno-1-392" name="__codelineno-1-392" href="#__codelineno-1-392"></a>                <span class="k">continue</span>
</span><span id="__span-1-393"><a id="__codelineno-1-393" name="__codelineno-1-393" href="#__codelineno-1-393"></a>
</span><span id="__span-1-394"><a id="__codelineno-1-394" name="__codelineno-1-394" href="#__codelineno-1-394"></a>            <span class="n">y_true_group</span> <span class="o">=</span> <span class="n">y_true</span><span class="p">[</span><span class="n">group_mask</span><span class="p">]</span>
</span><span id="__span-1-395"><a id="__codelineno-1-395" name="__codelineno-1-395" href="#__codelineno-1-395"></a>            <span class="n">y_prob_group</span> <span class="o">=</span> <span class="n">y_prob</span><span class="p">[</span><span class="n">group_mask</span><span class="p">]</span>
</span><span id="__span-1-396"><a id="__codelineno-1-396" name="__codelineno-1-396" href="#__codelineno-1-396"></a>
</span><span id="__span-1-397"><a id="__codelineno-1-397" name="__codelineno-1-397" href="#__codelineno-1-397"></a>            <span class="c1"># Calculate calibration curve</span>
</span><span id="__span-1-398"><a id="__codelineno-1-398" name="__codelineno-1-398" href="#__codelineno-1-398"></a>            <span class="n">bin_boundaries</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_bins</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-1-399"><a id="__codelineno-1-399" name="__codelineno-1-399" href="#__codelineno-1-399"></a>            <span class="n">bin_centers</span> <span class="o">=</span> <span class="p">(</span><span class="n">bin_boundaries</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">bin_boundaries</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="__span-1-400"><a id="__codelineno-1-400" name="__codelineno-1-400" href="#__codelineno-1-400"></a>
</span><span id="__span-1-401"><a id="__codelineno-1-401" name="__codelineno-1-401" href="#__codelineno-1-401"></a>            <span class="n">calibration_error</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-1-402"><a id="__codelineno-1-402" name="__codelineno-1-402" href="#__codelineno-1-402"></a>            <span class="n">bin_accuracies</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-1-403"><a id="__codelineno-1-403" name="__codelineno-1-403" href="#__codelineno-1-403"></a>            <span class="n">bin_confidences</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-1-404"><a id="__codelineno-1-404" name="__codelineno-1-404" href="#__codelineno-1-404"></a>
</span><span id="__span-1-405"><a id="__codelineno-1-405" name="__codelineno-1-405" href="#__codelineno-1-405"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_bins</span><span class="p">):</span>
</span><span id="__span-1-406"><a id="__codelineno-1-406" name="__codelineno-1-406" href="#__codelineno-1-406"></a>                <span class="n">bin_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_prob_group</span> <span class="o">&gt;=</span> <span class="n">bin_boundaries</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">y_prob_group</span> <span class="o">&lt;</span> <span class="n">bin_boundaries</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="__span-1-407"><a id="__codelineno-1-407" name="__codelineno-1-407" href="#__codelineno-1-407"></a>                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">bin_mask</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-1-408"><a id="__codelineno-1-408" name="__codelineno-1-408" href="#__codelineno-1-408"></a>                    <span class="n">bin_accuracy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_true_group</span><span class="p">[</span><span class="n">bin_mask</span><span class="p">])</span>
</span><span id="__span-1-409"><a id="__codelineno-1-409" name="__codelineno-1-409" href="#__codelineno-1-409"></a>                    <span class="n">bin_confidence</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_prob_group</span><span class="p">[</span><span class="n">bin_mask</span><span class="p">])</span>
</span><span id="__span-1-410"><a id="__codelineno-1-410" name="__codelineno-1-410" href="#__codelineno-1-410"></a>                    <span class="n">bin_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">bin_mask</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_prob_group</span><span class="p">)</span>
</span><span id="__span-1-411"><a id="__codelineno-1-411" name="__codelineno-1-411" href="#__codelineno-1-411"></a>
</span><span id="__span-1-412"><a id="__codelineno-1-412" name="__codelineno-1-412" href="#__codelineno-1-412"></a>                    <span class="n">calibration_error</span> <span class="o">+=</span> <span class="n">bin_weight</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">bin_accuracy</span> <span class="o">-</span> <span class="n">bin_confidence</span><span class="p">)</span>
</span><span id="__span-1-413"><a id="__codelineno-1-413" name="__codelineno-1-413" href="#__codelineno-1-413"></a>                    <span class="n">bin_accuracies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bin_accuracy</span><span class="p">)</span>
</span><span id="__span-1-414"><a id="__codelineno-1-414" name="__codelineno-1-414" href="#__codelineno-1-414"></a>                    <span class="n">bin_confidences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bin_confidence</span><span class="p">)</span>
</span><span id="__span-1-415"><a id="__codelineno-1-415" name="__codelineno-1-415" href="#__codelineno-1-415"></a>
</span><span id="__span-1-416"><a id="__codelineno-1-416" name="__codelineno-1-416" href="#__codelineno-1-416"></a>            <span class="n">calibration_metrics</span><span class="p">[</span><span class="n">group</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-1-417"><a id="__codelineno-1-417" name="__codelineno-1-417" href="#__codelineno-1-417"></a>                <span class="s1">&#39;calibration_error&#39;</span><span class="p">:</span> <span class="n">calibration_error</span><span class="p">,</span>
</span><span id="__span-1-418"><a id="__codelineno-1-418" name="__codelineno-1-418" href="#__codelineno-1-418"></a>                <span class="s1">&#39;bin_accuracies&#39;</span><span class="p">:</span> <span class="n">bin_accuracies</span><span class="p">,</span>
</span><span id="__span-1-419"><a id="__codelineno-1-419" name="__codelineno-1-419" href="#__codelineno-1-419"></a>                <span class="s1">&#39;bin_confidences&#39;</span><span class="p">:</span> <span class="n">bin_confidences</span>
</span><span id="__span-1-420"><a id="__codelineno-1-420" name="__codelineno-1-420" href="#__codelineno-1-420"></a>            <span class="p">}</span>
</span><span id="__span-1-421"><a id="__codelineno-1-421" name="__codelineno-1-421" href="#__codelineno-1-421"></a>
</span><span id="__span-1-422"><a id="__codelineno-1-422" name="__codelineno-1-422" href="#__codelineno-1-422"></a>        <span class="c1"># Calculate calibration fairness</span>
</span><span id="__span-1-423"><a id="__codelineno-1-423" name="__codelineno-1-423" href="#__codelineno-1-423"></a>        <span class="n">calibration_errors</span> <span class="o">=</span> <span class="p">[</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;calibration_error&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">metrics</span> <span class="ow">in</span> <span class="n">calibration_metrics</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
</span><span id="__span-1-424"><a id="__codelineno-1-424" name="__codelineno-1-424" href="#__codelineno-1-424"></a>        <span class="n">calibration_difference</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">calibration_errors</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">calibration_errors</span><span class="p">)</span> <span class="k">if</span> <span class="n">calibration_errors</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="__span-1-425"><a id="__codelineno-1-425" name="__codelineno-1-425" href="#__codelineno-1-425"></a>
</span><span id="__span-1-426"><a id="__codelineno-1-426" name="__codelineno-1-426" href="#__codelineno-1-426"></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-1-427"><a id="__codelineno-1-427" name="__codelineno-1-427" href="#__codelineno-1-427"></a>            <span class="s1">&#39;group_calibration&#39;</span><span class="p">:</span> <span class="n">calibration_metrics</span><span class="p">,</span>
</span><span id="__span-1-428"><a id="__codelineno-1-428" name="__codelineno-1-428" href="#__codelineno-1-428"></a>            <span class="s1">&#39;calibration_difference&#39;</span><span class="p">:</span> <span class="n">calibration_difference</span><span class="p">,</span>
</span><span id="__span-1-429"><a id="__codelineno-1-429" name="__codelineno-1-429" href="#__codelineno-1-429"></a>            <span class="s1">&#39;is_fair&#39;</span><span class="p">:</span> <span class="n">calibration_difference</span> <span class="o">&lt;</span> <span class="mf">0.05</span>
</span><span id="__span-1-430"><a id="__codelineno-1-430" name="__codelineno-1-430" href="#__codelineno-1-430"></a>        <span class="p">}</span>
</span><span id="__span-1-431"><a id="__codelineno-1-431" name="__codelineno-1-431" href="#__codelineno-1-431"></a>
</span><span id="__span-1-432"><a id="__codelineno-1-432" name="__codelineno-1-432" href="#__codelineno-1-432"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">comprehensive_fairness_evaluation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_true</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="__span-1-433"><a id="__codelineno-1-433" name="__codelineno-1-433" href="#__codelineno-1-433"></a>                                        <span class="n">y_prob</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">protected_attr</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
</span><span id="__span-1-434"><a id="__codelineno-1-434" name="__codelineno-1-434" href="#__codelineno-1-434"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform comprehensive fairness evaluation across multiple metrics&quot;&quot;&quot;</span>
</span><span id="__span-1-435"><a id="__codelineno-1-435" name="__codelineno-1-435" href="#__codelineno-1-435"></a>        <span class="n">evaluation</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-1-436"><a id="__codelineno-1-436" name="__codelineno-1-436" href="#__codelineno-1-436"></a>            <span class="s1">&#39;demographic_parity&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_demographic_parity</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">protected_attr</span><span class="p">),</span>
</span><span id="__span-1-437"><a id="__codelineno-1-437" name="__codelineno-1-437" href="#__codelineno-1-437"></a>            <span class="s1">&#39;equalized_odds&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_equalized_odds</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">protected_attr</span><span class="p">),</span>
</span><span id="__span-1-438"><a id="__codelineno-1-438" name="__codelineno-1-438" href="#__codelineno-1-438"></a>            <span class="s1">&#39;calibration&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_calibration_metrics</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_prob</span><span class="p">,</span> <span class="n">protected_attr</span><span class="p">)</span>
</span><span id="__span-1-439"><a id="__codelineno-1-439" name="__codelineno-1-439" href="#__codelineno-1-439"></a>        <span class="p">}</span>
</span><span id="__span-1-440"><a id="__codelineno-1-440" name="__codelineno-1-440" href="#__codelineno-1-440"></a>
</span><span id="__span-1-441"><a id="__codelineno-1-441" name="__codelineno-1-441" href="#__codelineno-1-441"></a>        <span class="c1"># Overall fairness assessment</span>
</span><span id="__span-1-442"><a id="__codelineno-1-442" name="__codelineno-1-442" href="#__codelineno-1-442"></a>        <span class="n">fairness_scores</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-1-443"><a id="__codelineno-1-443" name="__codelineno-1-443" href="#__codelineno-1-443"></a>            <span class="n">evaluation</span><span class="p">[</span><span class="s1">&#39;demographic_parity&#39;</span><span class="p">][</span><span class="s1">&#39;is_fair&#39;</span><span class="p">],</span>
</span><span id="__span-1-444"><a id="__codelineno-1-444" name="__codelineno-1-444" href="#__codelineno-1-444"></a>            <span class="n">evaluation</span><span class="p">[</span><span class="s1">&#39;equalized_odds&#39;</span><span class="p">][</span><span class="s1">&#39;is_fair&#39;</span><span class="p">],</span>
</span><span id="__span-1-445"><a id="__codelineno-1-445" name="__codelineno-1-445" href="#__codelineno-1-445"></a>            <span class="n">evaluation</span><span class="p">[</span><span class="s1">&#39;calibration&#39;</span><span class="p">][</span><span class="s1">&#39;is_fair&#39;</span><span class="p">]</span>
</span><span id="__span-1-446"><a id="__codelineno-1-446" name="__codelineno-1-446" href="#__codelineno-1-446"></a>        <span class="p">]</span>
</span><span id="__span-1-447"><a id="__codelineno-1-447" name="__codelineno-1-447" href="#__codelineno-1-447"></a>
</span><span id="__span-1-448"><a id="__codelineno-1-448" name="__codelineno-1-448" href="#__codelineno-1-448"></a>        <span class="n">evaluation</span><span class="p">[</span><span class="s1">&#39;overall_assessment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-1-449"><a id="__codelineno-1-449" name="__codelineno-1-449" href="#__codelineno-1-449"></a>            <span class="s1">&#39;fair_metrics_count&#39;</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">fairness_scores</span><span class="p">),</span>
</span><span id="__span-1-450"><a id="__codelineno-1-450" name="__codelineno-1-450" href="#__codelineno-1-450"></a>            <span class="s1">&#39;total_metrics&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">fairness_scores</span><span class="p">),</span>
</span><span id="__span-1-451"><a id="__codelineno-1-451" name="__codelineno-1-451" href="#__codelineno-1-451"></a>            <span class="s1">&#39;overall_fair&#39;</span><span class="p">:</span> <span class="nb">all</span><span class="p">(</span><span class="n">fairness_scores</span><span class="p">),</span>
</span><span id="__span-1-452"><a id="__codelineno-1-452" name="__codelineno-1-452" href="#__codelineno-1-452"></a>            <span class="s1">&#39;fairness_percentage&#39;</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">fairness_scores</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">fairness_scores</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="__span-1-453"><a id="__codelineno-1-453" name="__codelineno-1-453" href="#__codelineno-1-453"></a>        <span class="p">}</span>
</span><span id="__span-1-454"><a id="__codelineno-1-454" name="__codelineno-1-454" href="#__codelineno-1-454"></a>
</span><span id="__span-1-455"><a id="__codelineno-1-455" name="__codelineno-1-455" href="#__codelineno-1-455"></a>        <span class="k">return</span> <span class="n">evaluation</span>
</span><span id="__span-1-456"><a id="__codelineno-1-456" name="__codelineno-1-456" href="#__codelineno-1-456"></a>
</span><span id="__span-1-457"><a id="__codelineno-1-457" name="__codelineno-1-457" href="#__codelineno-1-457"></a><span class="c1"># Demonstration function for mitigation strategies</span>
</span><span id="__span-1-458"><a id="__codelineno-1-458" name="__codelineno-1-458" href="#__codelineno-1-458"></a><span class="k">def</span><span class="w"> </span><span class="nf">demonstrate_bias_mitigation_strategies</span><span class="p">():</span>
</span><span id="__span-1-459"><a id="__codelineno-1-459" name="__codelineno-1-459" href="#__codelineno-1-459"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrate comprehensive bias mitigation strategies&quot;&quot;&quot;</span>
</span><span id="__span-1-460"><a id="__codelineno-1-460" name="__codelineno-1-460" href="#__codelineno-1-460"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Bias Mitigation Strategies Demonstration ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-1-461"><a id="__codelineno-1-461" name="__codelineno-1-461" href="#__codelineno-1-461"></a>
</span><span id="__span-1-462"><a id="__codelineno-1-462" name="__codelineno-1-462" href="#__codelineno-1-462"></a>    <span class="c1"># Create biased synthetic dataset</span>
</span><span id="__span-1-463"><a id="__codelineno-1-463" name="__codelineno-1-463" href="#__codelineno-1-463"></a>    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
</span><span id="__span-1-464"><a id="__codelineno-1-464" name="__codelineno-1-464" href="#__codelineno-1-464"></a>    <span class="n">n_samples</span> <span class="o">=</span> <span class="mi">1000</span>
</span><span id="__span-1-465"><a id="__codelineno-1-465" name="__codelineno-1-465" href="#__codelineno-1-465"></a>
</span><span id="__span-1-466"><a id="__codelineno-1-466" name="__codelineno-1-466" href="#__codelineno-1-466"></a>    <span class="c1"># Biased gender distribution (70% male, 30% female)</span>
</span><span id="__span-1-467"><a id="__codelineno-1-467" name="__codelineno-1-467" href="#__codelineno-1-467"></a>    <span class="n">gender</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">],</span> <span class="n">n_samples</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>
</span><span id="__span-1-468"><a id="__codelineno-1-468" name="__codelineno-1-468" href="#__codelineno-1-468"></a>
</span><span id="__span-1-469"><a id="__codelineno-1-469" name="__codelineno-1-469" href="#__codelineno-1-469"></a>    <span class="c1"># Biased outcomes (males more likely to get positive outcomes)</span>
</span><span id="__span-1-470"><a id="__codelineno-1-470" name="__codelineno-1-470" href="#__codelineno-1-470"></a>    <span class="n">base_prob</span> <span class="o">=</span> <span class="mf">0.3</span>
</span><span id="__span-1-471"><a id="__codelineno-1-471" name="__codelineno-1-471" href="#__codelineno-1-471"></a>    <span class="n">prob_adjustment</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">gender</span> <span class="o">==</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">)</span>
</span><span id="__span-1-472"><a id="__codelineno-1-472" name="__codelineno-1-472" href="#__codelineno-1-472"></a>    <span class="n">outcomes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">base_prob</span> <span class="o">+</span> <span class="n">prob_adjustment</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span>
</span><span id="__span-1-473"><a id="__codelineno-1-473" name="__codelineno-1-473" href="#__codelineno-1-473"></a>
</span><span id="__span-1-474"><a id="__codelineno-1-474" name="__codelineno-1-474" href="#__codelineno-1-474"></a>    <span class="c1"># Features</span>
</span><span id="__span-1-475"><a id="__codelineno-1-475" name="__codelineno-1-475" href="#__codelineno-1-475"></a>    <span class="n">features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</span><span id="__span-1-476"><a id="__codelineno-1-476" name="__codelineno-1-476" href="#__codelineno-1-476"></a>
</span><span id="__span-1-477"><a id="__codelineno-1-477" name="__codelineno-1-477" href="#__codelineno-1-477"></a>    <span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
</span><span id="__span-1-478"><a id="__codelineno-1-478" name="__codelineno-1-478" href="#__codelineno-1-478"></a>        <span class="s1">&#39;gender&#39;</span><span class="p">:</span> <span class="n">gender</span><span class="p">,</span>
</span><span id="__span-1-479"><a id="__codelineno-1-479" name="__codelineno-1-479" href="#__codelineno-1-479"></a>        <span class="s1">&#39;outcome&#39;</span><span class="p">:</span> <span class="n">outcomes</span><span class="p">,</span>
</span><span id="__span-1-480"><a id="__codelineno-1-480" name="__codelineno-1-480" href="#__codelineno-1-480"></a>        <span class="s1">&#39;feature1&#39;</span><span class="p">:</span> <span class="n">features</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
</span><span id="__span-1-481"><a id="__codelineno-1-481" name="__codelineno-1-481" href="#__codelineno-1-481"></a>        <span class="s1">&#39;feature2&#39;</span><span class="p">:</span> <span class="n">features</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
</span><span id="__span-1-482"><a id="__codelineno-1-482" name="__codelineno-1-482" href="#__codelineno-1-482"></a>        <span class="s1">&#39;feature3&#39;</span><span class="p">:</span> <span class="n">features</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
</span><span id="__span-1-483"><a id="__codelineno-1-483" name="__codelineno-1-483" href="#__codelineno-1-483"></a>    <span class="p">})</span>
</span><span id="__span-1-484"><a id="__codelineno-1-484" name="__codelineno-1-484" href="#__codelineno-1-484"></a>
</span><span id="__span-1-485"><a id="__codelineno-1-485" name="__codelineno-1-485" href="#__codelineno-1-485"></a>    <span class="c1"># 1. Diverse Data Collection Framework</span>
</span><span id="__span-1-486"><a id="__codelineno-1-486" name="__codelineno-1-486" href="#__codelineno-1-486"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1. Diverse Data Collection Analysis:&quot;</span><span class="p">)</span>
</span><span id="__span-1-487"><a id="__codelineno-1-487" name="__codelineno-1-487" href="#__codelineno-1-487"></a>    <span class="n">collection_framework</span> <span class="o">=</span> <span class="n">DiverseDataCollectionFramework</span><span class="p">()</span>
</span><span id="__span-1-488"><a id="__codelineno-1-488" name="__codelineno-1-488" href="#__codelineno-1-488"></a>
</span><span id="__span-1-489"><a id="__codelineno-1-489" name="__codelineno-1-489" href="#__codelineno-1-489"></a>    <span class="n">target_distribution</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;gender&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">}}</span>
</span><span id="__span-1-490"><a id="__codelineno-1-490" name="__codelineno-1-490" href="#__codelineno-1-490"></a>    <span class="n">diversity_score</span> <span class="o">=</span> <span class="n">collection_framework</span><span class="o">.</span><span class="n">calculate_diversity_score</span><span class="p">(</span>
</span><span id="__span-1-491"><a id="__codelineno-1-491" name="__codelineno-1-491" href="#__codelineno-1-491"></a>        <span class="n">dataset</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">],</span> <span class="n">target_distribution</span>
</span><span id="__span-1-492"><a id="__codelineno-1-492" name="__codelineno-1-492" href="#__codelineno-1-492"></a>    <span class="p">)</span>
</span><span id="__span-1-493"><a id="__codelineno-1-493" name="__codelineno-1-493" href="#__codelineno-1-493"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Current diversity score: </span><span class="si">{</span><span class="n">diversity_score</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-1-494"><a id="__codelineno-1-494" name="__codelineno-1-494" href="#__codelineno-1-494"></a>
</span><span id="__span-1-495"><a id="__codelineno-1-495" name="__codelineno-1-495" href="#__codelineno-1-495"></a>    <span class="n">collection_plan</span> <span class="o">=</span> <span class="n">collection_framework</span><span class="o">.</span><span class="n">design_stratified_collection</span><span class="p">(</span>
</span><span id="__span-1-496"><a id="__codelineno-1-496" name="__codelineno-1-496" href="#__codelineno-1-496"></a>        <span class="n">target_distribution</span><span class="p">,</span> <span class="mi">1000</span>
</span><span id="__span-1-497"><a id="__codelineno-1-497" name="__codelineno-1-497" href="#__codelineno-1-497"></a>    <span class="p">)</span>
</span><span id="__span-1-498"><a id="__codelineno-1-498" name="__codelineno-1-498" href="#__codelineno-1-498"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Collection strategy: </span><span class="si">{</span><span class="n">collection_plan</span><span class="p">[</span><span class="s1">&#39;strategy&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-1-499"><a id="__codelineno-1-499" name="__codelineno-1-499" href="#__codelineno-1-499"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Target strata: </span><span class="si">{</span><span class="n">collection_plan</span><span class="p">[</span><span class="s1">&#39;strata_targets&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-1-500"><a id="__codelineno-1-500" name="__codelineno-1-500" href="#__codelineno-1-500"></a>    <span class="nb">print</span><span class="p">()</span>
</span><span id="__span-1-501"><a id="__codelineno-1-501" name="__codelineno-1-501" href="#__codelineno-1-501"></a>
</span><span id="__span-1-502"><a id="__codelineno-1-502" name="__codelineno-1-502" href="#__codelineno-1-502"></a>    <span class="c1"># 2. Bias Reweighting Framework</span>
</span><span id="__span-1-503"><a id="__codelineno-1-503" name="__codelineno-1-503" href="#__codelineno-1-503"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2. Bias Reweighting:&quot;</span><span class="p">)</span>
</span><span id="__span-1-504"><a id="__codelineno-1-504" name="__codelineno-1-504" href="#__codelineno-1-504"></a>    <span class="n">reweighting_framework</span> <span class="o">=</span> <span class="n">BiasReweightingFramework</span><span class="p">()</span>
</span><span id="__span-1-505"><a id="__codelineno-1-505" name="__codelineno-1-505" href="#__codelineno-1-505"></a>
</span><span id="__span-1-506"><a id="__codelineno-1-506" name="__codelineno-1-506" href="#__codelineno-1-506"></a>    <span class="c1"># Calculate inverse propensity weights</span>
</span><span id="__span-1-507"><a id="__codelineno-1-507" name="__codelineno-1-507" href="#__codelineno-1-507"></a>    <span class="n">ipw_weights</span> <span class="o">=</span> <span class="n">reweighting_framework</span><span class="o">.</span><span class="n">calculate_inverse_propensity_weights</span><span class="p">(</span>
</span><span id="__span-1-508"><a id="__codelineno-1-508" name="__codelineno-1-508" href="#__codelineno-1-508"></a>        <span class="n">dataset</span><span class="p">,</span> <span class="s1">&#39;gender&#39;</span>
</span><span id="__span-1-509"><a id="__codelineno-1-509" name="__codelineno-1-509" href="#__codelineno-1-509"></a>    <span class="p">)</span>
</span><span id="__span-1-510"><a id="__codelineno-1-510" name="__codelineno-1-510" href="#__codelineno-1-510"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Inverse propensity weights - Mean: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ipw_weights</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, Std: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ipw_weights</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-1-511"><a id="__codelineno-1-511" name="__codelineno-1-511" href="#__codelineno-1-511"></a>
</span><span id="__span-1-512"><a id="__codelineno-1-512" name="__codelineno-1-512" href="#__codelineno-1-512"></a>    <span class="c1"># Calculate fairness constraint weights</span>
</span><span id="__span-1-513"><a id="__codelineno-1-513" name="__codelineno-1-513" href="#__codelineno-1-513"></a>    <span class="n">protected_attr_numeric</span> <span class="o">=</span> <span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="__span-1-514"><a id="__codelineno-1-514" name="__codelineno-1-514" href="#__codelineno-1-514"></a>    <span class="n">fairness_weights</span> <span class="o">=</span> <span class="n">reweighting_framework</span><span class="o">.</span><span class="n">apply_fairness_constraints_reweighting</span><span class="p">(</span>
</span><span id="__span-1-515"><a id="__codelineno-1-515" name="__codelineno-1-515" href="#__codelineno-1-515"></a>        <span class="n">features</span><span class="p">,</span> <span class="n">outcomes</span><span class="p">,</span> <span class="n">protected_attr_numeric</span><span class="p">,</span> <span class="s1">&#39;demographic_parity&#39;</span>
</span><span id="__span-1-516"><a id="__codelineno-1-516" name="__codelineno-1-516" href="#__codelineno-1-516"></a>    <span class="p">)</span>
</span><span id="__span-1-517"><a id="__codelineno-1-517" name="__codelineno-1-517" href="#__codelineno-1-517"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Fairness constraint weights - Mean: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">fairness_weights</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, Std: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">fairness_weights</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-1-518"><a id="__codelineno-1-518" name="__codelineno-1-518" href="#__codelineno-1-518"></a>    <span class="nb">print</span><span class="p">()</span>
</span><span id="__span-1-519"><a id="__codelineno-1-519" name="__codelineno-1-519" href="#__codelineno-1-519"></a>
</span><span id="__span-1-520"><a id="__codelineno-1-520" name="__codelineno-1-520" href="#__codelineno-1-520"></a>    <span class="c1"># 3. Fairness-Aware Metrics</span>
</span><span id="__span-1-521"><a id="__codelineno-1-521" name="__codelineno-1-521" href="#__codelineno-1-521"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;3. Fairness-Aware Metrics:&quot;</span><span class="p">)</span>
</span><span id="__span-1-522"><a id="__codelineno-1-522" name="__codelineno-1-522" href="#__codelineno-1-522"></a>    <span class="n">fairness_metrics</span> <span class="o">=</span> <span class="n">FairnessAwareMetrics</span><span class="p">()</span>
</span><span id="__span-1-523"><a id="__codelineno-1-523" name="__codelineno-1-523" href="#__codelineno-1-523"></a>
</span><span id="__span-1-524"><a id="__codelineno-1-524" name="__codelineno-1-524" href="#__codelineno-1-524"></a>    <span class="c1"># Train simple model for evaluation</span>
</span><span id="__span-1-525"><a id="__codelineno-1-525" name="__codelineno-1-525" href="#__codelineno-1-525"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogisticRegression</span>
</span><span id="__span-1-526"><a id="__codelineno-1-526" name="__codelineno-1-526" href="#__codelineno-1-526"></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</span><span id="__span-1-527"><a id="__codelineno-1-527" name="__codelineno-1-527" href="#__codelineno-1-527"></a>    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">outcomes</span><span class="p">)</span>
</span><span id="__span-1-528"><a id="__codelineno-1-528" name="__codelineno-1-528" href="#__codelineno-1-528"></a>    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
</span><span id="__span-1-529"><a id="__codelineno-1-529" name="__codelineno-1-529" href="#__codelineno-1-529"></a>    <span class="n">y_prob</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">features</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="__span-1-530"><a id="__codelineno-1-530" name="__codelineno-1-530" href="#__codelineno-1-530"></a>
</span><span id="__span-1-531"><a id="__codelineno-1-531" name="__codelineno-1-531" href="#__codelineno-1-531"></a>    <span class="c1"># Evaluate fairness</span>
</span><span id="__span-1-532"><a id="__codelineno-1-532" name="__codelineno-1-532" href="#__codelineno-1-532"></a>    <span class="n">fairness_eval</span> <span class="o">=</span> <span class="n">fairness_metrics</span><span class="o">.</span><span class="n">comprehensive_fairness_evaluation</span><span class="p">(</span>
</span><span id="__span-1-533"><a id="__codelineno-1-533" name="__codelineno-1-533" href="#__codelineno-1-533"></a>        <span class="n">outcomes</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">y_prob</span><span class="p">,</span> <span class="n">protected_attr_numeric</span>
</span><span id="__span-1-534"><a id="__codelineno-1-534" name="__codelineno-1-534" href="#__codelineno-1-534"></a>    <span class="p">)</span>
</span><span id="__span-1-535"><a id="__codelineno-1-535" name="__codelineno-1-535" href="#__codelineno-1-535"></a>
</span><span id="__span-1-536"><a id="__codelineno-1-536" name="__codelineno-1-536" href="#__codelineno-1-536"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Demographic Parity - Fair: </span><span class="si">{</span><span class="n">fairness_eval</span><span class="p">[</span><span class="s1">&#39;demographic_parity&#39;</span><span class="p">][</span><span class="s1">&#39;is_fair&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-1-537"><a id="__codelineno-1-537" name="__codelineno-1-537" href="#__codelineno-1-537"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Parity Difference: </span><span class="si">{</span><span class="n">fairness_eval</span><span class="p">[</span><span class="s1">&#39;demographic_parity&#39;</span><span class="p">][</span><span class="s1">&#39;parity_difference&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-1-538"><a id="__codelineno-1-538" name="__codelineno-1-538" href="#__codelineno-1-538"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Equalized Odds - Fair: </span><span class="si">{</span><span class="n">fairness_eval</span><span class="p">[</span><span class="s1">&#39;equalized_odds&#39;</span><span class="p">][</span><span class="s1">&#39;is_fair&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-1-539"><a id="__codelineno-1-539" name="__codelineno-1-539" href="#__codelineno-1-539"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Overall Fairness: </span><span class="si">{</span><span class="n">fairness_eval</span><span class="p">[</span><span class="s1">&#39;overall_assessment&#39;</span><span class="p">][</span><span class="s1">&#39;fairness_percentage&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</span><span id="__span-1-540"><a id="__codelineno-1-540" name="__codelineno-1-540" href="#__codelineno-1-540"></a>
</span><span id="__span-1-541"><a id="__codelineno-1-541" name="__codelineno-1-541" href="#__codelineno-1-541"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-1-542"><a id="__codelineno-1-542" name="__codelineno-1-542" href="#__codelineno-1-542"></a>    <span class="n">demonstrate_bias_mitigation_strategies</span><span class="p">()</span>
</span></code></pre></div>
<h2 id="part-4-transparency-and-accountability-tools">Part 4: Transparency and Accountability Tools<a class="headerlink" href="#part-4-transparency-and-accountability-tools" title="Permanent link">&para;</a></h2>
<p>This section implements comprehensive <span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A pre-built structure providing a foundation and tools for developing software applications more efficiently." data-glossary-term="Framework">frameworks</span> for <span class="glossary-term" data-glossary-category="Programming Fundamentals" data-glossary-definition="Written text or illustrations that accompany software, explaining how it works and how to use it, including comments, docstrings, and user guides." data-glossary-term="Documentation">documentation</span>, model cards, and reproducibility checks to ensure transparency in bias mitigation efforts.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="k">class</span><span class="w"> </span><span class="nc">ModelCardGenerator</span><span class="p">:</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Framework for generating comprehensive model cards for bias transparency&quot;&quot;&quot;</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">card_template</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>            <span class="s1">&#39;model_details&#39;</span><span class="p">:</span> <span class="p">{},</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>            <span class="s1">&#39;intended_use&#39;</span><span class="p">:</span> <span class="p">{},</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>            <span class="s1">&#39;factors&#39;</span><span class="p">:</span> <span class="p">{},</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>            <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{},</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>            <span class="s1">&#39;evaluation_data&#39;</span><span class="p">:</span> <span class="p">{},</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>            <span class="s1">&#39;training_data&#39;</span><span class="p">:</span> <span class="p">{},</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>            <span class="s1">&#39;quantitative_analyses&#39;</span><span class="p">:</span> <span class="p">{},</span>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>            <span class="s1">&#39;ethical_considerations&#39;</span><span class="p">:</span> <span class="p">{},</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>            <span class="s1">&#39;caveats_and_recommendations&#39;</span><span class="p">:</span> <span class="p">{}</span>
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>        <span class="p">}</span>
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_model_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_info</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">training_data_info</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a>                         <span class="n">evaluation_results</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">bias_analysis</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a><span class="sd">        Create comprehensive model card including bias analysis</span>
</span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a>
</span><span id="__span-2-28"><a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a><span class="sd">        Args:</span>
</span><span id="__span-2-29"><a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a><span class="sd">            model_info: Basic model information</span>
</span><span id="__span-2-30"><a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a><span class="sd">            training_data_info: Training data characteristics</span>
</span><span id="__span-2-31"><a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a><span class="sd">            evaluation_results: Model evaluation metrics</span>
</span><span id="__span-2-32"><a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a><span class="sd">            bias_analysis: Bias assessment results</span>
</span><span id="__span-2-33"><a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-2-34"><a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a>        <span class="n">model_card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">card_template</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="__span-2-35"><a id="__codelineno-2-35" name="__codelineno-2-35" href="#__codelineno-2-35"></a>
</span><span id="__span-2-36"><a id="__codelineno-2-36" name="__codelineno-2-36" href="#__codelineno-2-36"></a>        <span class="c1"># Model Details</span>
</span><span id="__span-2-37"><a id="__codelineno-2-37" name="__codelineno-2-37" href="#__codelineno-2-37"></a>        <span class="n">model_card</span><span class="p">[</span><span class="s1">&#39;model_details&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-2-38"><a id="__codelineno-2-38" name="__codelineno-2-38" href="#__codelineno-2-38"></a>            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">model_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;Unnamed Model&#39;</span><span class="p">),</span>
</span><span id="__span-2-39"><a id="__codelineno-2-39" name="__codelineno-2-39" href="#__codelineno-2-39"></a>            <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="n">model_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;version&#39;</span><span class="p">,</span> <span class="s1">&#39;1.0&#39;</span><span class="p">),</span>
</span><span id="__span-2-40"><a id="__codelineno-2-40" name="__codelineno-2-40" href="#__codelineno-2-40"></a>            <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
</span><span id="__span-2-41"><a id="__codelineno-2-41" name="__codelineno-2-41" href="#__codelineno-2-41"></a>            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">model_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;Classification&#39;</span><span class="p">),</span>
</span><span id="__span-2-42"><a id="__codelineno-2-42" name="__codelineno-2-42" href="#__codelineno-2-42"></a>            <span class="s1">&#39;architecture&#39;</span><span class="p">:</span> <span class="n">model_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;architecture&#39;</span><span class="p">,</span> <span class="s1">&#39;Not specified&#39;</span><span class="p">),</span>
</span><span id="__span-2-43"><a id="__codelineno-2-43" name="__codelineno-2-43" href="#__codelineno-2-43"></a>            <span class="s1">&#39;paper_or_resources&#39;</span><span class="p">:</span> <span class="n">model_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;references&#39;</span><span class="p">,</span> <span class="p">[]),</span>
</span><span id="__span-2-44"><a id="__codelineno-2-44" name="__codelineno-2-44" href="#__codelineno-2-44"></a>            <span class="s1">&#39;license&#39;</span><span class="p">:</span> <span class="n">model_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;license&#39;</span><span class="p">,</span> <span class="s1">&#39;Not specified&#39;</span><span class="p">),</span>
</span><span id="__span-2-45"><a id="__codelineno-2-45" name="__codelineno-2-45" href="#__codelineno-2-45"></a>            <span class="s1">&#39;feedback&#39;</span><span class="p">:</span> <span class="n">model_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;contact&#39;</span><span class="p">,</span> <span class="s1">&#39;Not provided&#39;</span><span class="p">)</span>
</span><span id="__span-2-46"><a id="__codelineno-2-46" name="__codelineno-2-46" href="#__codelineno-2-46"></a>        <span class="p">}</span>
</span><span id="__span-2-47"><a id="__codelineno-2-47" name="__codelineno-2-47" href="#__codelineno-2-47"></a>
</span><span id="__span-2-48"><a id="__codelineno-2-48" name="__codelineno-2-48" href="#__codelineno-2-48"></a>        <span class="c1"># Intended Use</span>
</span><span id="__span-2-49"><a id="__codelineno-2-49" name="__codelineno-2-49" href="#__codelineno-2-49"></a>        <span class="n">model_card</span><span class="p">[</span><span class="s1">&#39;intended_use&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-2-50"><a id="__codelineno-2-50" name="__codelineno-2-50" href="#__codelineno-2-50"></a>            <span class="s1">&#39;primary_intended_uses&#39;</span><span class="p">:</span> <span class="n">model_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;intended_uses&#39;</span><span class="p">,</span> <span class="p">[]),</span>
</span><span id="__span-2-51"><a id="__codelineno-2-51" name="__codelineno-2-51" href="#__codelineno-2-51"></a>            <span class="s1">&#39;primary_intended_users&#39;</span><span class="p">:</span> <span class="n">model_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;intended_users&#39;</span><span class="p">,</span> <span class="p">[]),</span>
</span><span id="__span-2-52"><a id="__codelineno-2-52" name="__codelineno-2-52" href="#__codelineno-2-52"></a>            <span class="s1">&#39;out_of_scope_use_cases&#39;</span><span class="p">:</span> <span class="n">model_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;out_of_scope&#39;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="__span-2-53"><a id="__codelineno-2-53" name="__codelineno-2-53" href="#__codelineno-2-53"></a>        <span class="p">}</span>
</span><span id="__span-2-54"><a id="__codelineno-2-54" name="__codelineno-2-54" href="#__codelineno-2-54"></a>
</span><span id="__span-2-55"><a id="__codelineno-2-55" name="__codelineno-2-55" href="#__codelineno-2-55"></a>        <span class="c1"># Factors (bias-relevant demographics and other factors)</span>
</span><span id="__span-2-56"><a id="__codelineno-2-56" name="__codelineno-2-56" href="#__codelineno-2-56"></a>        <span class="n">model_card</span><span class="p">[</span><span class="s1">&#39;factors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-2-57"><a id="__codelineno-2-57" name="__codelineno-2-57" href="#__codelineno-2-57"></a>            <span class="s1">&#39;relevant_factors&#39;</span><span class="p">:</span> <span class="n">training_data_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;demographic_factors&#39;</span><span class="p">,</span> <span class="p">[]),</span>
</span><span id="__span-2-58"><a id="__codelineno-2-58" name="__codelineno-2-58" href="#__codelineno-2-58"></a>            <span class="s1">&#39;evaluation_factors&#39;</span><span class="p">:</span> <span class="n">bias_analysis</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;analyzed_factors&#39;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="__span-2-59"><a id="__codelineno-2-59" name="__codelineno-2-59" href="#__codelineno-2-59"></a>        <span class="p">}</span>
</span><span id="__span-2-60"><a id="__codelineno-2-60" name="__codelineno-2-60" href="#__codelineno-2-60"></a>
</span><span id="__span-2-61"><a id="__codelineno-2-61" name="__codelineno-2-61" href="#__codelineno-2-61"></a>        <span class="c1"># Metrics</span>
</span><span id="__span-2-62"><a id="__codelineno-2-62" name="__codelineno-2-62" href="#__codelineno-2-62"></a>        <span class="n">model_card</span><span class="p">[</span><span class="s1">&#39;metrics&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-2-63"><a id="__codelineno-2-63" name="__codelineno-2-63" href="#__codelineno-2-63"></a>            <span class="s1">&#39;model_performance_measures&#39;</span><span class="p">:</span> <span class="n">evaluation_results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;performance_metrics&#39;</span><span class="p">,</span> <span class="p">{}),</span>
</span><span id="__span-2-64"><a id="__codelineno-2-64" name="__codelineno-2-64" href="#__codelineno-2-64"></a>            <span class="s1">&#39;decision_thresholds&#39;</span><span class="p">:</span> <span class="n">evaluation_results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;thresholds&#39;</span><span class="p">,</span> <span class="p">{}),</span>
</span><span id="__span-2-65"><a id="__codelineno-2-65" name="__codelineno-2-65" href="#__codelineno-2-65"></a>            <span class="s1">&#39;variation_approaches&#39;</span><span class="p">:</span> <span class="n">evaluation_results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;variation_analysis&#39;</span><span class="p">,</span> <span class="p">{})</span>
</span><span id="__span-2-66"><a id="__codelineno-2-66" name="__codelineno-2-66" href="#__codelineno-2-66"></a>        <span class="p">}</span>
</span><span id="__span-2-67"><a id="__codelineno-2-67" name="__codelineno-2-67" href="#__codelineno-2-67"></a>
</span><span id="__span-2-68"><a id="__codelineno-2-68" name="__codelineno-2-68" href="#__codelineno-2-68"></a>        <span class="c1"># Training Data</span>
</span><span id="__span-2-69"><a id="__codelineno-2-69" name="__codelineno-2-69" href="#__codelineno-2-69"></a>        <span class="n">model_card</span><span class="p">[</span><span class="s1">&#39;training_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-2-70"><a id="__codelineno-2-70" name="__codelineno-2-70" href="#__codelineno-2-70"></a>            <span class="s1">&#39;dataset_name&#39;</span><span class="p">:</span> <span class="n">training_data_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;Not specified&#39;</span><span class="p">),</span>
</span><span id="__span-2-71"><a id="__codelineno-2-71" name="__codelineno-2-71" href="#__codelineno-2-71"></a>            <span class="s1">&#39;data_collection_method&#39;</span><span class="p">:</span> <span class="n">training_data_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;collection_method&#39;</span><span class="p">,</span> <span class="s1">&#39;Not specified&#39;</span><span class="p">),</span>
</span><span id="__span-2-72"><a id="__codelineno-2-72" name="__codelineno-2-72" href="#__codelineno-2-72"></a>            <span class="s1">&#39;data_preprocessing&#39;</span><span class="p">:</span> <span class="n">training_data_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;preprocessing_steps&#39;</span><span class="p">,</span> <span class="p">[]),</span>
</span><span id="__span-2-73"><a id="__codelineno-2-73" name="__codelineno-2-73" href="#__codelineno-2-73"></a>            <span class="s1">&#39;demographic_distribution&#39;</span><span class="p">:</span> <span class="n">training_data_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;demographic_distribution&#39;</span><span class="p">,</span> <span class="p">{}),</span>
</span><span id="__span-2-74"><a id="__codelineno-2-74" name="__codelineno-2-74" href="#__codelineno-2-74"></a>            <span class="s1">&#39;bias_mitigation_applied&#39;</span><span class="p">:</span> <span class="n">training_data_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bias_mitigation&#39;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="__span-2-75"><a id="__codelineno-2-75" name="__codelineno-2-75" href="#__codelineno-2-75"></a>        <span class="p">}</span>
</span><span id="__span-2-76"><a id="__codelineno-2-76" name="__codelineno-2-76" href="#__codelineno-2-76"></a>
</span><span id="__span-2-77"><a id="__codelineno-2-77" name="__codelineno-2-77" href="#__codelineno-2-77"></a>        <span class="c1"># Quantitative Analyses (bias-focused)</span>
</span><span id="__span-2-78"><a id="__codelineno-2-78" name="__codelineno-2-78" href="#__codelineno-2-78"></a>        <span class="n">model_card</span><span class="p">[</span><span class="s1">&#39;quantitative_analyses&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-2-79"><a id="__codelineno-2-79" name="__codelineno-2-79" href="#__codelineno-2-79"></a>            <span class="s1">&#39;unitary_results&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_bias_results</span><span class="p">(</span><span class="n">bias_analysis</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;overall_metrics&#39;</span><span class="p">,</span> <span class="p">{})),</span>
</span><span id="__span-2-80"><a id="__codelineno-2-80" name="__codelineno-2-80" href="#__codelineno-2-80"></a>            <span class="s1">&#39;intersectional_results&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_intersectional_analysis</span><span class="p">(</span>
</span><span id="__span-2-81"><a id="__codelineno-2-81" name="__codelineno-2-81" href="#__codelineno-2-81"></a>                <span class="n">bias_analysis</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;intersectional_analysis&#39;</span><span class="p">,</span> <span class="p">{})</span>
</span><span id="__span-2-82"><a id="__codelineno-2-82" name="__codelineno-2-82" href="#__codelineno-2-82"></a>            <span class="p">)</span>
</span><span id="__span-2-83"><a id="__codelineno-2-83" name="__codelineno-2-83" href="#__codelineno-2-83"></a>        <span class="p">}</span>
</span><span id="__span-2-84"><a id="__codelineno-2-84" name="__codelineno-2-84" href="#__codelineno-2-84"></a>
</span><span id="__span-2-85"><a id="__codelineno-2-85" name="__codelineno-2-85" href="#__codelineno-2-85"></a>        <span class="c1"># Ethical Considerations</span>
</span><span id="__span-2-86"><a id="__codelineno-2-86" name="__codelineno-2-86" href="#__codelineno-2-86"></a>        <span class="n">model_card</span><span class="p">[</span><span class="s1">&#39;ethical_considerations&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-2-87"><a id="__codelineno-2-87" name="__codelineno-2-87" href="#__codelineno-2-87"></a>            <span class="s1">&#39;sensitive_data&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_identify_sensitive_data_usage</span><span class="p">(</span><span class="n">training_data_info</span><span class="p">),</span>
</span><span id="__span-2-88"><a id="__codelineno-2-88" name="__codelineno-2-88" href="#__codelineno-2-88"></a>            <span class="s1">&#39;human_life_impact&#39;</span><span class="p">:</span> <span class="n">model_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;human_impact_assessment&#39;</span><span class="p">,</span> <span class="s1">&#39;Not assessed&#39;</span><span class="p">),</span>
</span><span id="__span-2-89"><a id="__codelineno-2-89" name="__codelineno-2-89" href="#__codelineno-2-89"></a>            <span class="s1">&#39;mitigations&#39;</span><span class="p">:</span> <span class="n">bias_analysis</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mitigation_strategies&#39;</span><span class="p">,</span> <span class="p">[]),</span>
</span><span id="__span-2-90"><a id="__codelineno-2-90" name="__codelineno-2-90" href="#__codelineno-2-90"></a>            <span class="s1">&#39;risks_and_harms&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_assess_potential_harms</span><span class="p">(</span><span class="n">bias_analysis</span><span class="p">),</span>
</span><span id="__span-2-91"><a id="__codelineno-2-91" name="__codelineno-2-91" href="#__codelineno-2-91"></a>            <span class="s1">&#39;use_cases_to_avoid&#39;</span><span class="p">:</span> <span class="n">model_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;prohibited_uses&#39;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="__span-2-92"><a id="__codelineno-2-92" name="__codelineno-2-92" href="#__codelineno-2-92"></a>        <span class="p">}</span>
</span><span id="__span-2-93"><a id="__codelineno-2-93" name="__codelineno-2-93" href="#__codelineno-2-93"></a>
</span><span id="__span-2-94"><a id="__codelineno-2-94" name="__codelineno-2-94" href="#__codelineno-2-94"></a>        <span class="c1"># Caveats and Recommendations</span>
</span><span id="__span-2-95"><a id="__codelineno-2-95" name="__codelineno-2-95" href="#__codelineno-2-95"></a>        <span class="n">model_card</span><span class="p">[</span><span class="s1">&#39;caveats_and_recommendations&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-2-96"><a id="__codelineno-2-96" name="__codelineno-2-96" href="#__codelineno-2-96"></a>            <span class="s1">&#39;caveats&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_bias_caveats</span><span class="p">(</span><span class="n">bias_analysis</span><span class="p">),</span>
</span><span id="__span-2-97"><a id="__codelineno-2-97" name="__codelineno-2-97" href="#__codelineno-2-97"></a>            <span class="s1">&#39;recommendations&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_usage_recommendations</span><span class="p">(</span><span class="n">bias_analysis</span><span class="p">)</span>
</span><span id="__span-2-98"><a id="__codelineno-2-98" name="__codelineno-2-98" href="#__codelineno-2-98"></a>        <span class="p">}</span>
</span><span id="__span-2-99"><a id="__codelineno-2-99" name="__codelineno-2-99" href="#__codelineno-2-99"></a>
</span><span id="__span-2-100"><a id="__codelineno-2-100" name="__codelineno-2-100" href="#__codelineno-2-100"></a>        <span class="k">return</span> <span class="n">model_card</span>
</span><span id="__span-2-101"><a id="__codelineno-2-101" name="__codelineno-2-101" href="#__codelineno-2-101"></a>
</span><span id="__span-2-102"><a id="__codelineno-2-102" name="__codelineno-2-102" href="#__codelineno-2-102"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_format_bias_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bias_metrics</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
</span><span id="__span-2-103"><a id="__codelineno-2-103" name="__codelineno-2-103" href="#__codelineno-2-103"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Format bias analysis results for model card&quot;&quot;&quot;</span>
</span><span id="__span-2-104"><a id="__codelineno-2-104" name="__codelineno-2-104" href="#__codelineno-2-104"></a>        <span class="n">formatted_results</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-2-105"><a id="__codelineno-2-105" name="__codelineno-2-105" href="#__codelineno-2-105"></a>
</span><span id="__span-2-106"><a id="__codelineno-2-106" name="__codelineno-2-106" href="#__codelineno-2-106"></a>        <span class="k">for</span> <span class="n">metric_name</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">bias_metrics</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-2-107"><a id="__codelineno-2-107" name="__codelineno-2-107" href="#__codelineno-2-107"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="__span-2-108"><a id="__codelineno-2-108" name="__codelineno-2-108" href="#__codelineno-2-108"></a>                <span class="n">formatted_results</span><span class="p">[</span><span class="n">metric_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-2-109"><a id="__codelineno-2-109" name="__codelineno-2-109" href="#__codelineno-2-109"></a>                    <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;Not calculated&#39;</span><span class="p">),</span>
</span><span id="__span-2-110"><a id="__codelineno-2-110" name="__codelineno-2-110" href="#__codelineno-2-110"></a>                    <span class="s1">&#39;threshold&#39;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;threshold&#39;</span><span class="p">,</span> <span class="s1">&#39;Not specified&#39;</span><span class="p">),</span>
</span><span id="__span-2-111"><a id="__codelineno-2-111" name="__codelineno-2-111" href="#__codelineno-2-111"></a>                    <span class="s1">&#39;interpretation&#39;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;interpretation&#39;</span><span class="p">,</span> <span class="s1">&#39;See documentation&#39;</span><span class="p">)</span>
</span><span id="__span-2-112"><a id="__codelineno-2-112" name="__codelineno-2-112" href="#__codelineno-2-112"></a>                <span class="p">}</span>
</span><span id="__span-2-113"><a id="__codelineno-2-113" name="__codelineno-2-113" href="#__codelineno-2-113"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-2-114"><a id="__codelineno-2-114" name="__codelineno-2-114" href="#__codelineno-2-114"></a>                <span class="n">formatted_results</span><span class="p">[</span><span class="n">metric_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">result</span><span class="p">}</span>
</span><span id="__span-2-115"><a id="__codelineno-2-115" name="__codelineno-2-115" href="#__codelineno-2-115"></a>
</span><span id="__span-2-116"><a id="__codelineno-2-116" name="__codelineno-2-116" href="#__codelineno-2-116"></a>        <span class="k">return</span> <span class="n">formatted_results</span>
</span><span id="__span-2-117"><a id="__codelineno-2-117" name="__codelineno-2-117" href="#__codelineno-2-117"></a>
</span><span id="__span-2-118"><a id="__codelineno-2-118" name="__codelineno-2-118" href="#__codelineno-2-118"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_format_intersectional_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">intersectional_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
</span><span id="__span-2-119"><a id="__codelineno-2-119" name="__codelineno-2-119" href="#__codelineno-2-119"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Format intersectional bias analysis for model card&quot;&quot;&quot;</span>
</span><span id="__span-2-120"><a id="__codelineno-2-120" name="__codelineno-2-120" href="#__codelineno-2-120"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">intersectional_data</span><span class="p">:</span>
</span><span id="__span-2-121"><a id="__codelineno-2-121" name="__codelineno-2-121" href="#__codelineno-2-121"></a>            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;Not performed&#39;</span><span class="p">}</span>
</span><span id="__span-2-122"><a id="__codelineno-2-122" name="__codelineno-2-122" href="#__codelineno-2-122"></a>
</span><span id="__span-2-123"><a id="__codelineno-2-123" name="__codelineno-2-123" href="#__codelineno-2-123"></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-2-124"><a id="__codelineno-2-124" name="__codelineno-2-124" href="#__codelineno-2-124"></a>            <span class="s1">&#39;combinations_analyzed&#39;</span><span class="p">:</span> <span class="n">intersectional_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;combinations&#39;</span><span class="p">,</span> <span class="p">[]),</span>
</span><span id="__span-2-125"><a id="__codelineno-2-125" name="__codelineno-2-125" href="#__codelineno-2-125"></a>            <span class="s1">&#39;significant_disparities&#39;</span><span class="p">:</span> <span class="n">intersectional_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;disparities&#39;</span><span class="p">,</span> <span class="p">[]),</span>
</span><span id="__span-2-126"><a id="__codelineno-2-126" name="__codelineno-2-126" href="#__codelineno-2-126"></a>            <span class="s1">&#39;recommendations&#39;</span><span class="p">:</span> <span class="n">intersectional_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;recommendations&#39;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="__span-2-127"><a id="__codelineno-2-127" name="__codelineno-2-127" href="#__codelineno-2-127"></a>        <span class="p">}</span>
</span><span id="__span-2-128"><a id="__codelineno-2-128" name="__codelineno-2-128" href="#__codelineno-2-128"></a>
</span><span id="__span-2-129"><a id="__codelineno-2-129" name="__codelineno-2-129" href="#__codelineno-2-129"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_identify_sensitive_data_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">training_data_info</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="__span-2-130"><a id="__codelineno-2-130" name="__codelineno-2-130" href="#__codelineno-2-130"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Identify sensitive data elements used in training&quot;&quot;&quot;</span>
</span><span id="__span-2-131"><a id="__codelineno-2-131" name="__codelineno-2-131" href="#__codelineno-2-131"></a>        <span class="n">sensitive_indicators</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-2-132"><a id="__codelineno-2-132" name="__codelineno-2-132" href="#__codelineno-2-132"></a>
</span><span id="__span-2-133"><a id="__codelineno-2-133" name="__codelineno-2-133" href="#__codelineno-2-133"></a>        <span class="n">demographic_factors</span> <span class="o">=</span> <span class="n">training_data_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;demographic_factors&#39;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="__span-2-134"><a id="__codelineno-2-134" name="__codelineno-2-134" href="#__codelineno-2-134"></a>        <span class="n">sensitive_attributes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;race&#39;</span><span class="p">,</span> <span class="s1">&#39;gender&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;religion&#39;</span><span class="p">,</span> <span class="s1">&#39;sexual_orientation&#39;</span><span class="p">,</span> <span class="s1">&#39;disability&#39;</span><span class="p">]</span>
</span><span id="__span-2-135"><a id="__codelineno-2-135" name="__codelineno-2-135" href="#__codelineno-2-135"></a>
</span><span id="__span-2-136"><a id="__codelineno-2-136" name="__codelineno-2-136" href="#__codelineno-2-136"></a>        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">sensitive_attributes</span><span class="p">:</span>
</span><span id="__span-2-137"><a id="__codelineno-2-137" name="__codelineno-2-137" href="#__codelineno-2-137"></a>            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">attr</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">factor</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">factor</span> <span class="ow">in</span> <span class="n">demographic_factors</span><span class="p">):</span>
</span><span id="__span-2-138"><a id="__codelineno-2-138" name="__codelineno-2-138" href="#__codelineno-2-138"></a>                <span class="n">sensitive_indicators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
</span><span id="__span-2-139"><a id="__codelineno-2-139" name="__codelineno-2-139" href="#__codelineno-2-139"></a>
</span><span id="__span-2-140"><a id="__codelineno-2-140" name="__codelineno-2-140" href="#__codelineno-2-140"></a>        <span class="k">return</span> <span class="n">sensitive_indicators</span>
</span><span id="__span-2-141"><a id="__codelineno-2-141" name="__codelineno-2-141" href="#__codelineno-2-141"></a>
</span><span id="__span-2-142"><a id="__codelineno-2-142" name="__codelineno-2-142" href="#__codelineno-2-142"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_assess_potential_harms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bias_analysis</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="__span-2-143"><a id="__codelineno-2-143" name="__codelineno-2-143" href="#__codelineno-2-143"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Assess potential harms based on bias analysis&quot;&quot;&quot;</span>
</span><span id="__span-2-144"><a id="__codelineno-2-144" name="__codelineno-2-144" href="#__codelineno-2-144"></a>        <span class="n">potential_harms</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-2-145"><a id="__codelineno-2-145" name="__codelineno-2-145" href="#__codelineno-2-145"></a>
</span><span id="__span-2-146"><a id="__codelineno-2-146" name="__codelineno-2-146" href="#__codelineno-2-146"></a>        <span class="n">severity</span> <span class="o">=</span> <span class="n">bias_analysis</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;overall_severity&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="__span-2-147"><a id="__codelineno-2-147" name="__codelineno-2-147" href="#__codelineno-2-147"></a>        <span class="k">if</span> <span class="n">severity</span> <span class="o">&gt;</span> <span class="mf">0.7</span><span class="p">:</span>
</span><span id="__span-2-148"><a id="__codelineno-2-148" name="__codelineno-2-148" href="#__codelineno-2-148"></a>            <span class="n">potential_harms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;High risk of discriminatory outcomes&#39;</span><span class="p">)</span>
</span><span id="__span-2-149"><a id="__codelineno-2-149" name="__codelineno-2-149" href="#__codelineno-2-149"></a>            <span class="n">potential_harms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;May perpetuate or amplify existing social inequalities&#39;</span><span class="p">)</span>
</span><span id="__span-2-150"><a id="__codelineno-2-150" name="__codelineno-2-150" href="#__codelineno-2-150"></a>        <span class="k">elif</span> <span class="n">severity</span> <span class="o">&gt;</span> <span class="mf">0.4</span><span class="p">:</span>
</span><span id="__span-2-151"><a id="__codelineno-2-151" name="__codelineno-2-151" href="#__codelineno-2-151"></a>            <span class="n">potential_harms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Moderate risk of biased decisions&#39;</span><span class="p">)</span>
</span><span id="__span-2-152"><a id="__codelineno-2-152" name="__codelineno-2-152" href="#__codelineno-2-152"></a>            <span class="n">potential_harms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Potential for unfair treatment of certain groups&#39;</span><span class="p">)</span>
</span><span id="__span-2-153"><a id="__codelineno-2-153" name="__codelineno-2-153" href="#__codelineno-2-153"></a>
</span><span id="__span-2-154"><a id="__codelineno-2-154" name="__codelineno-2-154" href="#__codelineno-2-154"></a>        <span class="n">affected_groups</span> <span class="o">=</span> <span class="n">bias_analysis</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;affected_groups&#39;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="__span-2-155"><a id="__codelineno-2-155" name="__codelineno-2-155" href="#__codelineno-2-155"></a>        <span class="k">if</span> <span class="n">affected_groups</span><span class="p">:</span>
</span><span id="__span-2-156"><a id="__codelineno-2-156" name="__codelineno-2-156" href="#__codelineno-2-156"></a>            <span class="n">potential_harms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Particularly affects: </span><span class="si">{</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">affected_groups</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="__span-2-157"><a id="__codelineno-2-157" name="__codelineno-2-157" href="#__codelineno-2-157"></a>
</span><span id="__span-2-158"><a id="__codelineno-2-158" name="__codelineno-2-158" href="#__codelineno-2-158"></a>        <span class="k">return</span> <span class="n">potential_harms</span>
</span><span id="__span-2-159"><a id="__codelineno-2-159" name="__codelineno-2-159" href="#__codelineno-2-159"></a>
</span><span id="__span-2-160"><a id="__codelineno-2-160" name="__codelineno-2-160" href="#__codelineno-2-160"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_bias_caveats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bias_analysis</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="__span-2-161"><a id="__codelineno-2-161" name="__codelineno-2-161" href="#__codelineno-2-161"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate caveats based on bias analysis&quot;&quot;&quot;</span>
</span><span id="__span-2-162"><a id="__codelineno-2-162" name="__codelineno-2-162" href="#__codelineno-2-162"></a>        <span class="n">caveats</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-2-163"><a id="__codelineno-2-163" name="__codelineno-2-163" href="#__codelineno-2-163"></a>
</span><span id="__span-2-164"><a id="__codelineno-2-164" name="__codelineno-2-164" href="#__codelineno-2-164"></a>        <span class="k">if</span> <span class="n">bias_analysis</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data_limitations&#39;</span><span class="p">,</span> <span class="p">[]):</span>
</span><span id="__span-2-165"><a id="__codelineno-2-165" name="__codelineno-2-165" href="#__codelineno-2-165"></a>            <span class="n">caveats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Model trained on data with known representational limitations&#39;</span><span class="p">)</span>
</span><span id="__span-2-166"><a id="__codelineno-2-166" name="__codelineno-2-166" href="#__codelineno-2-166"></a>
</span><span id="__span-2-167"><a id="__codelineno-2-167" name="__codelineno-2-167" href="#__codelineno-2-167"></a>        <span class="k">if</span> <span class="n">bias_analysis</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;temporal_considerations&#39;</span><span class="p">,</span> <span class="p">{}):</span>
</span><span id="__span-2-168"><a id="__codelineno-2-168" name="__codelineno-2-168" href="#__codelineno-2-168"></a>            <span class="n">caveats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Model performance may degrade over time due to population drift&#39;</span><span class="p">)</span>
</span><span id="__span-2-169"><a id="__codelineno-2-169" name="__codelineno-2-169" href="#__codelineno-2-169"></a>
</span><span id="__span-2-170"><a id="__codelineno-2-170" name="__codelineno-2-170" href="#__codelineno-2-170"></a>        <span class="k">if</span> <span class="n">bias_analysis</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;geographic_limitations&#39;</span><span class="p">,</span> <span class="p">[]):</span>
</span><span id="__span-2-171"><a id="__codelineno-2-171" name="__codelineno-2-171" href="#__codelineno-2-171"></a>            <span class="n">caveats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Model may not generalize to different geographic regions&#39;</span><span class="p">)</span>
</span><span id="__span-2-172"><a id="__codelineno-2-172" name="__codelineno-2-172" href="#__codelineno-2-172"></a>
</span><span id="__span-2-173"><a id="__codelineno-2-173" name="__codelineno-2-173" href="#__codelineno-2-173"></a>        <span class="k">return</span> <span class="n">caveats</span>
</span><span id="__span-2-174"><a id="__codelineno-2-174" name="__codelineno-2-174" href="#__codelineno-2-174"></a>
</span><span id="__span-2-175"><a id="__codelineno-2-175" name="__codelineno-2-175" href="#__codelineno-2-175"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_usage_recommendations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bias_analysis</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="__span-2-176"><a id="__codelineno-2-176" name="__codelineno-2-176" href="#__codelineno-2-176"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate usage recommendations based on bias analysis&quot;&quot;&quot;</span>
</span><span id="__span-2-177"><a id="__codelineno-2-177" name="__codelineno-2-177" href="#__codelineno-2-177"></a>        <span class="n">recommendations</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-2-178"><a id="__codelineno-2-178" name="__codelineno-2-178" href="#__codelineno-2-178"></a>
</span><span id="__span-2-179"><a id="__codelineno-2-179" name="__codelineno-2-179" href="#__codelineno-2-179"></a>        <span class="k">if</span> <span class="n">bias_analysis</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;monitoring_needs&#39;</span><span class="p">,</span> <span class="p">[]):</span>
</span><span id="__span-2-180"><a id="__codelineno-2-180" name="__codelineno-2-180" href="#__codelineno-2-180"></a>            <span class="n">recommendations</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">bias_analysis</span><span class="p">[</span><span class="s1">&#39;monitoring_needs&#39;</span><span class="p">])</span>
</span><span id="__span-2-181"><a id="__codelineno-2-181" name="__codelineno-2-181" href="#__codelineno-2-181"></a>
</span><span id="__span-2-182"><a id="__codelineno-2-182" name="__codelineno-2-182" href="#__codelineno-2-182"></a>        <span class="n">recommendations</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
</span><span id="__span-2-183"><a id="__codelineno-2-183" name="__codelineno-2-183" href="#__codelineno-2-183"></a>            <span class="s1">&#39;Regular bias assessment in deployment environment&#39;</span><span class="p">,</span>
</span><span id="__span-2-184"><a id="__codelineno-2-184" name="__codelineno-2-184" href="#__codelineno-2-184"></a>            <span class="s1">&#39;Human oversight for high-stakes decisions&#39;</span><span class="p">,</span>
</span><span id="__span-2-185"><a id="__codelineno-2-185" name="__codelineno-2-185" href="#__codelineno-2-185"></a>            <span class="s1">&#39;Periodic retraining with updated, representative data&#39;</span>
</span><span id="__span-2-186"><a id="__codelineno-2-186" name="__codelineno-2-186" href="#__codelineno-2-186"></a>        <span class="p">])</span>
</span><span id="__span-2-187"><a id="__codelineno-2-187" name="__codelineno-2-187" href="#__codelineno-2-187"></a>
</span><span id="__span-2-188"><a id="__codelineno-2-188" name="__codelineno-2-188" href="#__codelineno-2-188"></a>        <span class="k">return</span> <span class="n">recommendations</span>
</span><span id="__span-2-189"><a id="__codelineno-2-189" name="__codelineno-2-189" href="#__codelineno-2-189"></a>
</span><span id="__span-2-190"><a id="__codelineno-2-190" name="__codelineno-2-190" href="#__codelineno-2-190"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">export_model_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_card</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">format_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;json&#39;</span><span class="p">,</span>
</span><span id="__span-2-191"><a id="__codelineno-2-191" name="__codelineno-2-191" href="#__codelineno-2-191"></a>                         <span class="n">filepath</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-2-192"><a id="__codelineno-2-192" name="__codelineno-2-192" href="#__codelineno-2-192"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Export model card in specified format&quot;&quot;&quot;</span>
</span><span id="__span-2-193"><a id="__codelineno-2-193" name="__codelineno-2-193" href="#__codelineno-2-193"></a>        <span class="k">if</span> <span class="n">format_type</span> <span class="o">==</span> <span class="s1">&#39;json&#39;</span><span class="p">:</span>
</span><span id="__span-2-194"><a id="__codelineno-2-194" name="__codelineno-2-194" href="#__codelineno-2-194"></a>            <span class="n">card_str</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">model_card</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
</span><span id="__span-2-195"><a id="__codelineno-2-195" name="__codelineno-2-195" href="#__codelineno-2-195"></a>        <span class="k">elif</span> <span class="n">format_type</span> <span class="o">==</span> <span class="s1">&#39;markdown&#39;</span><span class="p">:</span>
</span><span id="__span-2-196"><a id="__codelineno-2-196" name="__codelineno-2-196" href="#__codelineno-2-196"></a>            <span class="n">card_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_to_markdown</span><span class="p">(</span><span class="n">model_card</span><span class="p">)</span>
</span><span id="__span-2-197"><a id="__codelineno-2-197" name="__codelineno-2-197" href="#__codelineno-2-197"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-2-198"><a id="__codelineno-2-198" name="__codelineno-2-198" href="#__codelineno-2-198"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported format: </span><span class="si">{</span><span class="n">format_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-2-199"><a id="__codelineno-2-199" name="__codelineno-2-199" href="#__codelineno-2-199"></a>
</span><span id="__span-2-200"><a id="__codelineno-2-200" name="__codelineno-2-200" href="#__codelineno-2-200"></a>        <span class="k">if</span> <span class="n">filepath</span><span class="p">:</span>
</span><span id="__span-2-201"><a id="__codelineno-2-201" name="__codelineno-2-201" href="#__codelineno-2-201"></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-2-202"><a id="__codelineno-2-202" name="__codelineno-2-202" href="#__codelineno-2-202"></a>                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">card_str</span><span class="p">)</span>
</span><span id="__span-2-203"><a id="__codelineno-2-203" name="__codelineno-2-203" href="#__codelineno-2-203"></a>
</span><span id="__span-2-204"><a id="__codelineno-2-204" name="__codelineno-2-204" href="#__codelineno-2-204"></a>        <span class="k">return</span> <span class="n">card_str</span>
</span><span id="__span-2-205"><a id="__codelineno-2-205" name="__codelineno-2-205" href="#__codelineno-2-205"></a>
</span><span id="__span-2-206"><a id="__codelineno-2-206" name="__codelineno-2-206" href="#__codelineno-2-206"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_convert_to_markdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_card</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-2-207"><a id="__codelineno-2-207" name="__codelineno-2-207" href="#__codelineno-2-207"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert model card to markdown format&quot;&quot;&quot;</span>
</span><span id="__span-2-208"><a id="__codelineno-2-208" name="__codelineno-2-208" href="#__codelineno-2-208"></a>        <span class="n">markdown_sections</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;# Model Card</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">]</span>
</span><span id="__span-2-209"><a id="__codelineno-2-209" name="__codelineno-2-209" href="#__codelineno-2-209"></a>
</span><span id="__span-2-210"><a id="__codelineno-2-210" name="__codelineno-2-210" href="#__codelineno-2-210"></a>        <span class="k">for</span> <span class="n">section_name</span><span class="p">,</span> <span class="n">section_content</span> <span class="ow">in</span> <span class="n">model_card</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-2-211"><a id="__codelineno-2-211" name="__codelineno-2-211" href="#__codelineno-2-211"></a>            <span class="n">section_title</span> <span class="o">=</span> <span class="n">section_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>
</span><span id="__span-2-212"><a id="__codelineno-2-212" name="__codelineno-2-212" href="#__codelineno-2-212"></a>            <span class="n">markdown_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">## </span><span class="si">{</span><span class="n">section_title</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-2-213"><a id="__codelineno-2-213" name="__codelineno-2-213" href="#__codelineno-2-213"></a>
</span><span id="__span-2-214"><a id="__codelineno-2-214" name="__codelineno-2-214" href="#__codelineno-2-214"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">section_content</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="__span-2-215"><a id="__codelineno-2-215" name="__codelineno-2-215" href="#__codelineno-2-215"></a>                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">section_content</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-2-216"><a id="__codelineno-2-216" name="__codelineno-2-216" href="#__codelineno-2-216"></a>                    <span class="n">item_title</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>
</span><span id="__span-2-217"><a id="__codelineno-2-217" name="__codelineno-2-217" href="#__codelineno-2-217"></a>                    <span class="n">markdown_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">### </span><span class="si">{</span><span class="n">item_title</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-2-218"><a id="__codelineno-2-218" name="__codelineno-2-218" href="#__codelineno-2-218"></a>
</span><span id="__span-2-219"><a id="__codelineno-2-219" name="__codelineno-2-219" href="#__codelineno-2-219"></a>                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="__span-2-220"><a id="__codelineno-2-220" name="__codelineno-2-220" href="#__codelineno-2-220"></a>                        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
</span><span id="__span-2-221"><a id="__codelineno-2-221" name="__codelineno-2-221" href="#__codelineno-2-221"></a>                            <span class="n">markdown_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-2-222"><a id="__codelineno-2-222" name="__codelineno-2-222" href="#__codelineno-2-222"></a>                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="__span-2-223"><a id="__codelineno-2-223" name="__codelineno-2-223" href="#__codelineno-2-223"></a>                        <span class="k">for</span> <span class="n">subkey</span><span class="p">,</span> <span class="n">subvalue</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-2-224"><a id="__codelineno-2-224" name="__codelineno-2-224" href="#__codelineno-2-224"></a>                            <span class="n">markdown_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;**</span><span class="si">{</span><span class="n">subkey</span><span class="si">}</span><span class="s2">**: </span><span class="si">{</span><span class="n">subvalue</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-2-225"><a id="__codelineno-2-225" name="__codelineno-2-225" href="#__codelineno-2-225"></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-2-226"><a id="__codelineno-2-226" name="__codelineno-2-226" href="#__codelineno-2-226"></a>                        <span class="n">markdown_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-2-227"><a id="__codelineno-2-227" name="__codelineno-2-227" href="#__codelineno-2-227"></a>
</span><span id="__span-2-228"><a id="__codelineno-2-228" name="__codelineno-2-228" href="#__codelineno-2-228"></a>        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">markdown_sections</span><span class="p">)</span>
</span><span id="__span-2-229"><a id="__codelineno-2-229" name="__codelineno-2-229" href="#__codelineno-2-229"></a>
</span><span id="__span-2-230"><a id="__codelineno-2-230" name="__codelineno-2-230" href="#__codelineno-2-230"></a><span class="k">class</span><span class="w"> </span><span class="nc">BiasDocumentationFramework</span><span class="p">:</span>
</span><span id="__span-2-231"><a id="__codelineno-2-231" name="__codelineno-2-231" href="#__codelineno-2-231"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Framework for comprehensive bias documentation and audit trails&quot;&quot;&quot;</span>
</span><span id="__span-2-232"><a id="__codelineno-2-232" name="__codelineno-2-232" href="#__codelineno-2-232"></a>
</span><span id="__span-2-233"><a id="__codelineno-2-233" name="__codelineno-2-233" href="#__codelineno-2-233"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-2-234"><a id="__codelineno-2-234" name="__codelineno-2-234" href="#__codelineno-2-234"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">documentation_log</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-2-235"><a id="__codelineno-2-235" name="__codelineno-2-235" href="#__codelineno-2-235"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">audit_trail</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-2-236"><a id="__codelineno-2-236" name="__codelineno-2-236" href="#__codelineno-2-236"></a>
</span><span id="__span-2-237"><a id="__codelineno-2-237" name="__codelineno-2-237" href="#__codelineno-2-237"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">document_bias_assessment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assessment_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">assessment_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-2-238"><a id="__codelineno-2-238" name="__codelineno-2-238" href="#__codelineno-2-238"></a>                                <span class="n">methodology</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">results</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> 
</span><span id="__span-2-239"><a id="__codelineno-2-239" name="__codelineno-2-239" href="#__codelineno-2-239"></a>                                <span class="n">decisions_made</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
</span><span id="__span-2-240"><a id="__codelineno-2-240" name="__codelineno-2-240" href="#__codelineno-2-240"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-2-241"><a id="__codelineno-2-241" name="__codelineno-2-241" href="#__codelineno-2-241"></a><span class="sd">        Document a bias assessment with full methodology and results</span>
</span><span id="__span-2-242"><a id="__codelineno-2-242" name="__codelineno-2-242" href="#__codelineno-2-242"></a>
</span><span id="__span-2-243"><a id="__codelineno-2-243" name="__codelineno-2-243" href="#__codelineno-2-243"></a><span class="sd">        Args:</span>
</span><span id="__span-2-244"><a id="__codelineno-2-244" name="__codelineno-2-244" href="#__codelineno-2-244"></a><span class="sd">            assessment_id: Unique identifier for the assessment</span>
</span><span id="__span-2-245"><a id="__codelineno-2-245" name="__codelineno-2-245" href="#__codelineno-2-245"></a><span class="sd">            assessment_type: Type of bias assessment performed</span>
</span><span id="__span-2-246"><a id="__codelineno-2-246" name="__codelineno-2-246" href="#__codelineno-2-246"></a><span class="sd">            methodology: Detailed methodology used</span>
</span><span id="__span-2-247"><a id="__codelineno-2-247" name="__codelineno-2-247" href="#__codelineno-2-247"></a><span class="sd">            results: Assessment results</span>
</span><span id="__span-2-248"><a id="__codelineno-2-248" name="__codelineno-2-248" href="#__codelineno-2-248"></a><span class="sd">            decisions_made: Decisions made based on results</span>
</span><span id="__span-2-249"><a id="__codelineno-2-249" name="__codelineno-2-249" href="#__codelineno-2-249"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-2-250"><a id="__codelineno-2-250" name="__codelineno-2-250" href="#__codelineno-2-250"></a>        <span class="n">documentation</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-2-251"><a id="__codelineno-2-251" name="__codelineno-2-251" href="#__codelineno-2-251"></a>            <span class="s1">&#39;assessment_id&#39;</span><span class="p">:</span> <span class="n">assessment_id</span><span class="p">,</span>
</span><span id="__span-2-252"><a id="__codelineno-2-252" name="__codelineno-2-252" href="#__codelineno-2-252"></a>            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
</span><span id="__span-2-253"><a id="__codelineno-2-253" name="__codelineno-2-253" href="#__codelineno-2-253"></a>            <span class="s1">&#39;assessment_type&#39;</span><span class="p">:</span> <span class="n">assessment_type</span><span class="p">,</span>
</span><span id="__span-2-254"><a id="__codelineno-2-254" name="__codelineno-2-254" href="#__codelineno-2-254"></a>            <span class="s1">&#39;methodology&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-2-255"><a id="__codelineno-2-255" name="__codelineno-2-255" href="#__codelineno-2-255"></a>                <span class="s1">&#39;approach&#39;</span><span class="p">:</span> <span class="n">methodology</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;approach&#39;</span><span class="p">,</span> <span class="s1">&#39;Not specified&#39;</span><span class="p">),</span>
</span><span id="__span-2-256"><a id="__codelineno-2-256" name="__codelineno-2-256" href="#__codelineno-2-256"></a>                <span class="s1">&#39;tools_used&#39;</span><span class="p">:</span> <span class="n">methodology</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tools&#39;</span><span class="p">,</span> <span class="p">[]),</span>
</span><span id="__span-2-257"><a id="__codelineno-2-257" name="__codelineno-2-257" href="#__codelineno-2-257"></a>                <span class="s1">&#39;data_sources&#39;</span><span class="p">:</span> <span class="n">methodology</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data_sources&#39;</span><span class="p">,</span> <span class="p">[]),</span>
</span><span id="__span-2-258"><a id="__codelineno-2-258" name="__codelineno-2-258" href="#__codelineno-2-258"></a>                <span class="s1">&#39;evaluation_criteria&#39;</span><span class="p">:</span> <span class="n">methodology</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;criteria&#39;</span><span class="p">,</span> <span class="p">[]),</span>
</span><span id="__span-2-259"><a id="__codelineno-2-259" name="__codelineno-2-259" href="#__codelineno-2-259"></a>                <span class="s1">&#39;assumptions&#39;</span><span class="p">:</span> <span class="n">methodology</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;assumptions&#39;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="__span-2-260"><a id="__codelineno-2-260" name="__codelineno-2-260" href="#__codelineno-2-260"></a>            <span class="p">},</span>
</span><span id="__span-2-261"><a id="__codelineno-2-261" name="__codelineno-2-261" href="#__codelineno-2-261"></a>            <span class="s1">&#39;results&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-2-262"><a id="__codelineno-2-262" name="__codelineno-2-262" href="#__codelineno-2-262"></a>                <span class="s1">&#39;summary&#39;</span><span class="p">:</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;summary&#39;</span><span class="p">,</span> <span class="s1">&#39;Not provided&#39;</span><span class="p">),</span>
</span><span id="__span-2-263"><a id="__codelineno-2-263" name="__codelineno-2-263" href="#__codelineno-2-263"></a>                <span class="s1">&#39;detailed_findings&#39;</span><span class="p">:</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;detailed_findings&#39;</span><span class="p">,</span> <span class="p">{}),</span>
</span><span id="__span-2-264"><a id="__codelineno-2-264" name="__codelineno-2-264" href="#__codelineno-2-264"></a>                <span class="s1">&#39;severity_assessment&#39;</span><span class="p">:</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;severity&#39;</span><span class="p">,</span> <span class="s1">&#39;Not assessed&#39;</span><span class="p">),</span>
</span><span id="__span-2-265"><a id="__codelineno-2-265" name="__codelineno-2-265" href="#__codelineno-2-265"></a>                <span class="s1">&#39;affected_groups&#39;</span><span class="p">:</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;affected_groups&#39;</span><span class="p">,</span> <span class="p">[]),</span>
</span><span id="__span-2-266"><a id="__codelineno-2-266" name="__codelineno-2-266" href="#__codelineno-2-266"></a>                <span class="s1">&#39;confidence_level&#39;</span><span class="p">:</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;confidence&#39;</span><span class="p">,</span> <span class="s1">&#39;Not specified&#39;</span><span class="p">)</span>
</span><span id="__span-2-267"><a id="__codelineno-2-267" name="__codelineno-2-267" href="#__codelineno-2-267"></a>            <span class="p">},</span>
</span><span id="__span-2-268"><a id="__codelineno-2-268" name="__codelineno-2-268" href="#__codelineno-2-268"></a>            <span class="s1">&#39;decisions_and_actions&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-2-269"><a id="__codelineno-2-269" name="__codelineno-2-269" href="#__codelineno-2-269"></a>                <span class="s1">&#39;immediate_decisions&#39;</span><span class="p">:</span> <span class="n">decisions_made</span><span class="p">,</span>
</span><span id="__span-2-270"><a id="__codelineno-2-270" name="__codelineno-2-270" href="#__codelineno-2-270"></a>                <span class="s1">&#39;mitigation_actions&#39;</span><span class="p">:</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mitigation_actions&#39;</span><span class="p">,</span> <span class="p">[]),</span>
</span><span id="__span-2-271"><a id="__codelineno-2-271" name="__codelineno-2-271" href="#__codelineno-2-271"></a>                <span class="s1">&#39;follow_up_required&#39;</span><span class="p">:</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;follow_up&#39;</span><span class="p">,</span> <span class="p">[]),</span>
</span><span id="__span-2-272"><a id="__codelineno-2-272" name="__codelineno-2-272" href="#__codelineno-2-272"></a>                <span class="s1">&#39;approval_status&#39;</span><span class="p">:</span> <span class="s1">&#39;Pending Review&#39;</span>
</span><span id="__span-2-273"><a id="__codelineno-2-273" name="__codelineno-2-273" href="#__codelineno-2-273"></a>            <span class="p">},</span>
</span><span id="__span-2-274"><a id="__codelineno-2-274" name="__codelineno-2-274" href="#__codelineno-2-274"></a>            <span class="s1">&#39;review_and_validation&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-2-275"><a id="__codelineno-2-275" name="__codelineno-2-275" href="#__codelineno-2-275"></a>                <span class="s1">&#39;peer_reviewed&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-2-276"><a id="__codelineno-2-276" name="__codelineno-2-276" href="#__codelineno-2-276"></a>                <span class="s1">&#39;stakeholder_consulted&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-2-277"><a id="__codelineno-2-277" name="__codelineno-2-277" href="#__codelineno-2-277"></a>                <span class="s1">&#39;external_audit&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-2-278"><a id="__codelineno-2-278" name="__codelineno-2-278" href="#__codelineno-2-278"></a>                <span class="s1">&#39;review_comments&#39;</span><span class="p">:</span> <span class="p">[]</span>
</span><span id="__span-2-279"><a id="__codelineno-2-279" name="__codelineno-2-279" href="#__codelineno-2-279"></a>            <span class="p">}</span>
</span><span id="__span-2-280"><a id="__codelineno-2-280" name="__codelineno-2-280" href="#__codelineno-2-280"></a>        <span class="p">}</span>
</span><span id="__span-2-281"><a id="__codelineno-2-281" name="__codelineno-2-281" href="#__codelineno-2-281"></a>
</span><span id="__span-2-282"><a id="__codelineno-2-282" name="__codelineno-2-282" href="#__codelineno-2-282"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">documentation_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">documentation</span><span class="p">)</span>
</span><span id="__span-2-283"><a id="__codelineno-2-283" name="__codelineno-2-283" href="#__codelineno-2-283"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_update_audit_trail</span><span class="p">(</span><span class="s1">&#39;bias_assessment_documented&#39;</span><span class="p">,</span> <span class="n">assessment_id</span><span class="p">)</span>
</span><span id="__span-2-284"><a id="__codelineno-2-284" name="__codelineno-2-284" href="#__codelineno-2-284"></a>
</span><span id="__span-2-285"><a id="__codelineno-2-285" name="__codelineno-2-285" href="#__codelineno-2-285"></a>        <span class="k">return</span> <span class="n">documentation</span>
</span><span id="__span-2-286"><a id="__codelineno-2-286" name="__codelineno-2-286" href="#__codelineno-2-286"></a>
</span><span id="__span-2-287"><a id="__codelineno-2-287" name="__codelineno-2-287" href="#__codelineno-2-287"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">document_mitigation_implementation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mitigation_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-2-288"><a id="__codelineno-2-288" name="__codelineno-2-288" href="#__codelineno-2-288"></a>                                         <span class="n">mitigation_strategy</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
</span><span id="__span-2-289"><a id="__codelineno-2-289" name="__codelineno-2-289" href="#__codelineno-2-289"></a>                                         <span class="n">implementation_details</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
</span><span id="__span-2-290"><a id="__codelineno-2-290" name="__codelineno-2-290" href="#__codelineno-2-290"></a>                                         <span class="n">effectiveness_metrics</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
</span><span id="__span-2-291"><a id="__codelineno-2-291" name="__codelineno-2-291" href="#__codelineno-2-291"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-2-292"><a id="__codelineno-2-292" name="__codelineno-2-292" href="#__codelineno-2-292"></a><span class="sd">        Document bias mitigation implementation and effectiveness</span>
</span><span id="__span-2-293"><a id="__codelineno-2-293" name="__codelineno-2-293" href="#__codelineno-2-293"></a>
</span><span id="__span-2-294"><a id="__codelineno-2-294" name="__codelineno-2-294" href="#__codelineno-2-294"></a><span class="sd">        Args:</span>
</span><span id="__span-2-295"><a id="__codelineno-2-295" name="__codelineno-2-295" href="#__codelineno-2-295"></a><span class="sd">            mitigation_id: Unique identifier for mitigation effort</span>
</span><span id="__span-2-296"><a id="__codelineno-2-296" name="__codelineno-2-296" href="#__codelineno-2-296"></a><span class="sd">            mitigation_strategy: Strategy being implemented</span>
</span><span id="__span-2-297"><a id="__codelineno-2-297" name="__codelineno-2-297" href="#__codelineno-2-297"></a><span class="sd">            implementation_details: How the strategy was implemented</span>
</span><span id="__span-2-298"><a id="__codelineno-2-298" name="__codelineno-2-298" href="#__codelineno-2-298"></a><span class="sd">            effectiveness_metrics: Metrics showing effectiveness</span>
</span><span id="__span-2-299"><a id="__codelineno-2-299" name="__codelineno-2-299" href="#__codelineno-2-299"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-2-300"><a id="__codelineno-2-300" name="__codelineno-2-300" href="#__codelineno-2-300"></a>        <span class="n">mitigation_doc</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-2-301"><a id="__codelineno-2-301" name="__codelineno-2-301" href="#__codelineno-2-301"></a>            <span class="s1">&#39;mitigation_id&#39;</span><span class="p">:</span> <span class="n">mitigation_id</span><span class="p">,</span>
</span><span id="__span-2-302"><a id="__codelineno-2-302" name="__codelineno-2-302" href="#__codelineno-2-302"></a>            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
</span><span id="__span-2-303"><a id="__codelineno-2-303" name="__codelineno-2-303" href="#__codelineno-2-303"></a>            <span class="s1">&#39;strategy&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-2-304"><a id="__codelineno-2-304" name="__codelineno-2-304" href="#__codelineno-2-304"></a>                <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">mitigation_strategy</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;Unnamed Strategy&#39;</span><span class="p">),</span>
</span><span id="__span-2-305"><a id="__codelineno-2-305" name="__codelineno-2-305" href="#__codelineno-2-305"></a>                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">mitigation_strategy</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;Not specified&#39;</span><span class="p">),</span>
</span><span id="__span-2-306"><a id="__codelineno-2-306" name="__codelineno-2-306" href="#__codelineno-2-306"></a>                <span class="s1">&#39;target_bias&#39;</span><span class="p">:</span> <span class="n">mitigation_strategy</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;target_bias&#39;</span><span class="p">,</span> <span class="p">[]),</span>
</span><span id="__span-2-307"><a id="__codelineno-2-307" name="__codelineno-2-307" href="#__codelineno-2-307"></a>                <span class="s1">&#39;expected_outcomes&#39;</span><span class="p">:</span> <span class="n">mitigation_strategy</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;expected_outcomes&#39;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="__span-2-308"><a id="__codelineno-2-308" name="__codelineno-2-308" href="#__codelineno-2-308"></a>            <span class="p">},</span>
</span><span id="__span-2-309"><a id="__codelineno-2-309" name="__codelineno-2-309" href="#__codelineno-2-309"></a>            <span class="s1">&#39;implementation&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-2-310"><a id="__codelineno-2-310" name="__codelineno-2-310" href="#__codelineno-2-310"></a>                <span class="s1">&#39;start_date&#39;</span><span class="p">:</span> <span class="n">implementation_details</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;start_date&#39;</span><span class="p">,</span> <span class="s1">&#39;Not specified&#39;</span><span class="p">),</span>
</span><span id="__span-2-311"><a id="__codelineno-2-311" name="__codelineno-2-311" href="#__codelineno-2-311"></a>                <span class="s1">&#39;completion_date&#39;</span><span class="p">:</span> <span class="n">implementation_details</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;completion_date&#39;</span><span class="p">,</span> <span class="s1">&#39;Ongoing&#39;</span><span class="p">),</span>
</span><span id="__span-2-312"><a id="__codelineno-2-312" name="__codelineno-2-312" href="#__codelineno-2-312"></a>                <span class="s1">&#39;implementation_steps&#39;</span><span class="p">:</span> <span class="n">implementation_details</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;steps&#39;</span><span class="p">,</span> <span class="p">[]),</span>
</span><span id="__span-2-313"><a id="__codelineno-2-313" name="__codelineno-2-313" href="#__codelineno-2-313"></a>                <span class="s1">&#39;resources_used&#39;</span><span class="p">:</span> <span class="n">implementation_details</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;resources&#39;</span><span class="p">,</span> <span class="p">[]),</span>
</span><span id="__span-2-314"><a id="__codelineno-2-314" name="__codelineno-2-314" href="#__codelineno-2-314"></a>                <span class="s1">&#39;challenges_encountered&#39;</span><span class="p">:</span> <span class="n">implementation_details</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;challenges&#39;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="__span-2-315"><a id="__codelineno-2-315" name="__codelineno-2-315" href="#__codelineno-2-315"></a>            <span class="p">},</span>
</span><span id="__span-2-316"><a id="__codelineno-2-316" name="__codelineno-2-316" href="#__codelineno-2-316"></a>            <span class="s1">&#39;effectiveness_evaluation&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-2-317"><a id="__codelineno-2-317" name="__codelineno-2-317" href="#__codelineno-2-317"></a>                <span class="s1">&#39;metrics_used&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">effectiveness_metrics</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
</span><span id="__span-2-318"><a id="__codelineno-2-318" name="__codelineno-2-318" href="#__codelineno-2-318"></a>                <span class="s1">&#39;baseline_values&#39;</span><span class="p">:</span> <span class="n">effectiveness_metrics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span> <span class="p">{}),</span>
</span><span id="__span-2-319"><a id="__codelineno-2-319" name="__codelineno-2-319" href="#__codelineno-2-319"></a>                <span class="s1">&#39;post_mitigation_values&#39;</span><span class="p">:</span> <span class="n">effectiveness_metrics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;post_mitigation&#39;</span><span class="p">,</span> <span class="p">{}),</span>
</span><span id="__span-2-320"><a id="__codelineno-2-320" name="__codelineno-2-320" href="#__codelineno-2-320"></a>                <span class="s1">&#39;improvement_achieved&#39;</span><span class="p">:</span> <span class="n">effectiveness_metrics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;improvement&#39;</span><span class="p">,</span> <span class="p">{}),</span>
</span><span id="__span-2-321"><a id="__codelineno-2-321" name="__codelineno-2-321" href="#__codelineno-2-321"></a>                <span class="s1">&#39;success_criteria_met&#39;</span><span class="p">:</span> <span class="n">effectiveness_metrics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;success_criteria_met&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="__span-2-322"><a id="__codelineno-2-322" name="__codelineno-2-322" href="#__codelineno-2-322"></a>            <span class="p">},</span>
</span><span id="__span-2-323"><a id="__codelineno-2-323" name="__codelineno-2-323" href="#__codelineno-2-323"></a>            <span class="s1">&#39;lessons_learned&#39;</span><span class="p">:</span> <span class="n">implementation_details</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lessons_learned&#39;</span><span class="p">,</span> <span class="p">[]),</span>
</span><span id="__span-2-324"><a id="__codelineno-2-324" name="__codelineno-2-324" href="#__codelineno-2-324"></a>            <span class="s1">&#39;recommendations&#39;</span><span class="p">:</span> <span class="n">implementation_details</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;recommendations&#39;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="__span-2-325"><a id="__codelineno-2-325" name="__codelineno-2-325" href="#__codelineno-2-325"></a>        <span class="p">}</span>
</span><span id="__span-2-326"><a id="__codelineno-2-326" name="__codelineno-2-326" href="#__codelineno-2-326"></a>
</span><span id="__span-2-327"><a id="__codelineno-2-327" name="__codelineno-2-327" href="#__codelineno-2-327"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">documentation_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mitigation_doc</span><span class="p">)</span>
</span><span id="__span-2-328"><a id="__codelineno-2-328" name="__codelineno-2-328" href="#__codelineno-2-328"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_update_audit_trail</span><span class="p">(</span><span class="s1">&#39;mitigation_implemented&#39;</span><span class="p">,</span> <span class="n">mitigation_id</span><span class="p">)</span>
</span><span id="__span-2-329"><a id="__codelineno-2-329" name="__codelineno-2-329" href="#__codelineno-2-329"></a>
</span><span id="__span-2-330"><a id="__codelineno-2-330" name="__codelineno-2-330" href="#__codelineno-2-330"></a>        <span class="k">return</span> <span class="n">mitigation_doc</span>
</span><span id="__span-2-331"><a id="__codelineno-2-331" name="__codelineno-2-331" href="#__codelineno-2-331"></a>
</span><span id="__span-2-332"><a id="__codelineno-2-332" name="__codelineno-2-332" href="#__codelineno-2-332"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_update_audit_trail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">entity_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">details</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
</span><span id="__span-2-333"><a id="__codelineno-2-333" name="__codelineno-2-333" href="#__codelineno-2-333"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update audit trail with action&quot;&quot;&quot;</span>
</span><span id="__span-2-334"><a id="__codelineno-2-334" name="__codelineno-2-334" href="#__codelineno-2-334"></a>        <span class="n">audit_entry</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-2-335"><a id="__codelineno-2-335" name="__codelineno-2-335" href="#__codelineno-2-335"></a>            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
</span><span id="__span-2-336"><a id="__codelineno-2-336" name="__codelineno-2-336" href="#__codelineno-2-336"></a>            <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="n">action</span><span class="p">,</span>
</span><span id="__span-2-337"><a id="__codelineno-2-337" name="__codelineno-2-337" href="#__codelineno-2-337"></a>            <span class="s1">&#39;entity_id&#39;</span><span class="p">:</span> <span class="n">entity_id</span><span class="p">,</span>
</span><span id="__span-2-338"><a id="__codelineno-2-338" name="__codelineno-2-338" href="#__codelineno-2-338"></a>            <span class="s1">&#39;details&#39;</span><span class="p">:</span> <span class="n">details</span><span class="p">,</span>
</span><span id="__span-2-339"><a id="__codelineno-2-339" name="__codelineno-2-339" href="#__codelineno-2-339"></a>            <span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="s1">&#39;system&#39;</span>  <span class="c1"># In practice, would capture actual user</span>
</span><span id="__span-2-340"><a id="__codelineno-2-340" name="__codelineno-2-340" href="#__codelineno-2-340"></a>        <span class="p">}</span>
</span><span id="__span-2-341"><a id="__codelineno-2-341" name="__codelineno-2-341" href="#__codelineno-2-341"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">audit_trail</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">audit_entry</span><span class="p">)</span>
</span><span id="__span-2-342"><a id="__codelineno-2-342" name="__codelineno-2-342" href="#__codelineno-2-342"></a>
</span><span id="__span-2-343"><a id="__codelineno-2-343" name="__codelineno-2-343" href="#__codelineno-2-343"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate_compliance_report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">compliance_framework</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;general&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
</span><span id="__span-2-344"><a id="__codelineno-2-344" name="__codelineno-2-344" href="#__codelineno-2-344"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate compliance report for bias management&quot;&quot;&quot;</span>
</span><span id="__span-2-345"><a id="__codelineno-2-345" name="__codelineno-2-345" href="#__codelineno-2-345"></a>        <span class="n">assessments_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span><span class="n">doc</span> <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">documentation_log</span> 
</span><span id="__span-2-346"><a id="__codelineno-2-346" name="__codelineno-2-346" href="#__codelineno-2-346"></a>                               <span class="k">if</span> <span class="s1">&#39;assessment_type&#39;</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">])</span>
</span><span id="__span-2-347"><a id="__codelineno-2-347" name="__codelineno-2-347" href="#__codelineno-2-347"></a>        <span class="n">mitigations_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span><span class="n">doc</span> <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">documentation_log</span> 
</span><span id="__span-2-348"><a id="__codelineno-2-348" name="__codelineno-2-348" href="#__codelineno-2-348"></a>                               <span class="k">if</span> <span class="s1">&#39;strategy&#39;</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">])</span>
</span><span id="__span-2-349"><a id="__codelineno-2-349" name="__codelineno-2-349" href="#__codelineno-2-349"></a>
</span><span id="__span-2-350"><a id="__codelineno-2-350" name="__codelineno-2-350" href="#__codelineno-2-350"></a>        <span class="n">compliance_report</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-2-351"><a id="__codelineno-2-351" name="__codelineno-2-351" href="#__codelineno-2-351"></a>            <span class="s1">&#39;report_date&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
</span><span id="__span-2-352"><a id="__codelineno-2-352" name="__codelineno-2-352" href="#__codelineno-2-352"></a>            <span class="s1">&#39;compliance_framework&#39;</span><span class="p">:</span> <span class="n">compliance_framework</span><span class="p">,</span>
</span><span id="__span-2-353"><a id="__codelineno-2-353" name="__codelineno-2-353" href="#__codelineno-2-353"></a>            <span class="s1">&#39;summary_statistics&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-2-354"><a id="__codelineno-2-354" name="__codelineno-2-354" href="#__codelineno-2-354"></a>                <span class="s1">&#39;total_bias_assessments&#39;</span><span class="p">:</span> <span class="n">assessments_count</span><span class="p">,</span>
</span><span id="__span-2-355"><a id="__codelineno-2-355" name="__codelineno-2-355" href="#__codelineno-2-355"></a>                <span class="s1">&#39;total_mitigation_efforts&#39;</span><span class="p">:</span> <span class="n">mitigations_count</span><span class="p">,</span>
</span><span id="__span-2-356"><a id="__codelineno-2-356" name="__codelineno-2-356" href="#__codelineno-2-356"></a>                <span class="s1">&#39;documentation_completeness&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_assess_documentation_completeness</span><span class="p">(),</span>
</span><span id="__span-2-357"><a id="__codelineno-2-357" name="__codelineno-2-357" href="#__codelineno-2-357"></a>                <span class="s1">&#39;audit_trail_entries&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">audit_trail</span><span class="p">)</span>
</span><span id="__span-2-358"><a id="__codelineno-2-358" name="__codelineno-2-358" href="#__codelineno-2-358"></a>            <span class="p">},</span>
</span><span id="__span-2-359"><a id="__codelineno-2-359" name="__codelineno-2-359" href="#__codelineno-2-359"></a>            <span class="s1">&#39;compliance_checklist&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_compliance_checklist</span><span class="p">(),</span>
</span><span id="__span-2-360"><a id="__codelineno-2-360" name="__codelineno-2-360" href="#__codelineno-2-360"></a>            <span class="s1">&#39;recommendations&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_compliance_recommendations</span><span class="p">(),</span>
</span><span id="__span-2-361"><a id="__codelineno-2-361" name="__codelineno-2-361" href="#__codelineno-2-361"></a>            <span class="s1">&#39;next_review_date&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_next_review_date</span><span class="p">()</span>
</span><span id="__span-2-362"><a id="__codelineno-2-362" name="__codelineno-2-362" href="#__codelineno-2-362"></a>        <span class="p">}</span>
</span><span id="__span-2-363"><a id="__codelineno-2-363" name="__codelineno-2-363" href="#__codelineno-2-363"></a>
</span><span id="__span-2-364"><a id="__codelineno-2-364" name="__codelineno-2-364" href="#__codelineno-2-364"></a>        <span class="k">return</span> <span class="n">compliance_report</span>
</span><span id="__span-2-365"><a id="__codelineno-2-365" name="__codelineno-2-365" href="#__codelineno-2-365"></a>
</span><span id="__span-2-366"><a id="__codelineno-2-366" name="__codelineno-2-366" href="#__codelineno-2-366"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_assess_documentation_completeness</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="__span-2-367"><a id="__codelineno-2-367" name="__codelineno-2-367" href="#__codelineno-2-367"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Assess completeness of bias documentation&quot;&quot;&quot;</span>
</span><span id="__span-2-368"><a id="__codelineno-2-368" name="__codelineno-2-368" href="#__codelineno-2-368"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">documentation_log</span><span class="p">:</span>
</span><span id="__span-2-369"><a id="__codelineno-2-369" name="__codelineno-2-369" href="#__codelineno-2-369"></a>            <span class="k">return</span> <span class="mf">0.0</span>
</span><span id="__span-2-370"><a id="__codelineno-2-370" name="__codelineno-2-370" href="#__codelineno-2-370"></a>
</span><span id="__span-2-371"><a id="__codelineno-2-371" name="__codelineno-2-371" href="#__codelineno-2-371"></a>        <span class="n">required_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;methodology&#39;</span><span class="p">,</span> <span class="s1">&#39;results&#39;</span><span class="p">,</span> <span class="s1">&#39;decisions_and_actions&#39;</span><span class="p">]</span>
</span><span id="__span-2-372"><a id="__codelineno-2-372" name="__codelineno-2-372" href="#__codelineno-2-372"></a>        <span class="n">complete_docs</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-2-373"><a id="__codelineno-2-373" name="__codelineno-2-373" href="#__codelineno-2-373"></a>
</span><span id="__span-2-374"><a id="__codelineno-2-374" name="__codelineno-2-374" href="#__codelineno-2-374"></a>        <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">documentation_log</span><span class="p">:</span>
</span><span id="__span-2-375"><a id="__codelineno-2-375" name="__codelineno-2-375" href="#__codelineno-2-375"></a>            <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">field</span> <span class="ow">in</span> <span class="n">doc</span> <span class="ow">and</span> <span class="n">doc</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">required_fields</span><span class="p">):</span>
</span><span id="__span-2-376"><a id="__codelineno-2-376" name="__codelineno-2-376" href="#__codelineno-2-376"></a>                <span class="n">complete_docs</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-2-377"><a id="__codelineno-2-377" name="__codelineno-2-377" href="#__codelineno-2-377"></a>
</span><span id="__span-2-378"><a id="__codelineno-2-378" name="__codelineno-2-378" href="#__codelineno-2-378"></a>        <span class="k">return</span> <span class="n">complete_docs</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">documentation_log</span><span class="p">)</span>
</span><span id="__span-2-379"><a id="__codelineno-2-379" name="__codelineno-2-379" href="#__codelineno-2-379"></a>
</span><span id="__span-2-380"><a id="__codelineno-2-380" name="__codelineno-2-380" href="#__codelineno-2-380"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_compliance_checklist</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
</span><span id="__span-2-381"><a id="__codelineno-2-381" name="__codelineno-2-381" href="#__codelineno-2-381"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate compliance checklist&quot;&quot;&quot;</span>
</span><span id="__span-2-382"><a id="__codelineno-2-382" name="__codelineno-2-382" href="#__codelineno-2-382"></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-2-383"><a id="__codelineno-2-383" name="__codelineno-2-383" href="#__codelineno-2-383"></a>            <span class="s1">&#39;bias_assessment_conducted&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">([</span><span class="n">doc</span> <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">documentation_log</span> <span class="k">if</span> <span class="s1">&#39;assessment_type&#39;</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="__span-2-384"><a id="__codelineno-2-384" name="__codelineno-2-384" href="#__codelineno-2-384"></a>            <span class="s1">&#39;mitigation_strategies_documented&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">([</span><span class="n">doc</span> <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">documentation_log</span> <span class="k">if</span> <span class="s1">&#39;strategy&#39;</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="__span-2-385"><a id="__codelineno-2-385" name="__codelineno-2-385" href="#__codelineno-2-385"></a>            <span class="s1">&#39;effectiveness_measured&#39;</span><span class="p">:</span> <span class="nb">any</span><span class="p">(</span><span class="s1">&#39;effectiveness_evaluation&#39;</span> <span class="ow">in</span> <span class="n">doc</span> <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">documentation_log</span><span class="p">),</span>
</span><span id="__span-2-386"><a id="__codelineno-2-386" name="__codelineno-2-386" href="#__codelineno-2-386"></a>            <span class="s1">&#39;audit_trail_maintained&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">audit_trail</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="__span-2-387"><a id="__codelineno-2-387" name="__codelineno-2-387" href="#__codelineno-2-387"></a>            <span class="s1">&#39;regular_reviews_scheduled&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># Would check actual schedule</span>
</span><span id="__span-2-388"><a id="__codelineno-2-388" name="__codelineno-2-388" href="#__codelineno-2-388"></a>            <span class="s1">&#39;stakeholder_involvement_documented&#39;</span><span class="p">:</span> <span class="nb">any</span><span class="p">(</span>
</span><span id="__span-2-389"><a id="__codelineno-2-389" name="__codelineno-2-389" href="#__codelineno-2-389"></a>                <span class="n">doc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;review_and_validation&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;stakeholder_consulted&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="__span-2-390"><a id="__codelineno-2-390" name="__codelineno-2-390" href="#__codelineno-2-390"></a>                <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">documentation_log</span>
</span><span id="__span-2-391"><a id="__codelineno-2-391" name="__codelineno-2-391" href="#__codelineno-2-391"></a>            <span class="p">)</span>
</span><span id="__span-2-392"><a id="__codelineno-2-392" name="__codelineno-2-392" href="#__codelineno-2-392"></a>        <span class="p">}</span>
</span><span id="__span-2-393"><a id="__codelineno-2-393" name="__codelineno-2-393" href="#__codelineno-2-393"></a>
</span><span id="__span-2-394"><a id="__codelineno-2-394" name="__codelineno-2-394" href="#__codelineno-2-394"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_compliance_recommendations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="__span-2-395"><a id="__codelineno-2-395" name="__codelineno-2-395" href="#__codelineno-2-395"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate recommendations for compliance improvement&quot;&quot;&quot;</span>
</span><span id="__span-2-396"><a id="__codelineno-2-396" name="__codelineno-2-396" href="#__codelineno-2-396"></a>        <span class="n">recommendations</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-2-397"><a id="__codelineno-2-397" name="__codelineno-2-397" href="#__codelineno-2-397"></a>
</span><span id="__span-2-398"><a id="__codelineno-2-398" name="__codelineno-2-398" href="#__codelineno-2-398"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_assess_documentation_completeness</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.8</span><span class="p">:</span>
</span><span id="__span-2-399"><a id="__codelineno-2-399" name="__codelineno-2-399" href="#__codelineno-2-399"></a>            <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Improve documentation completeness&quot;</span><span class="p">)</span>
</span><span id="__span-2-400"><a id="__codelineno-2-400" name="__codelineno-2-400" href="#__codelineno-2-400"></a>
</span><span id="__span-2-401"><a id="__codelineno-2-401" name="__codelineno-2-401" href="#__codelineno-2-401"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="s1">&#39;external_audit&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span> <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">documentation_log</span><span class="p">):</span>
</span><span id="__span-2-402"><a id="__codelineno-2-402" name="__codelineno-2-402" href="#__codelineno-2-402"></a>            <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Consider external bias audit&quot;</span><span class="p">)</span>
</span><span id="__span-2-403"><a id="__codelineno-2-403" name="__codelineno-2-403" href="#__codelineno-2-403"></a>
</span><span id="__span-2-404"><a id="__codelineno-2-404" name="__codelineno-2-404" href="#__codelineno-2-404"></a>        <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Establish regular bias assessment schedule&quot;</span><span class="p">)</span>
</span><span id="__span-2-405"><a id="__codelineno-2-405" name="__codelineno-2-405" href="#__codelineno-2-405"></a>        <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Implement continuous monitoring system&quot;</span><span class="p">)</span>
</span><span id="__span-2-406"><a id="__codelineno-2-406" name="__codelineno-2-406" href="#__codelineno-2-406"></a>
</span><span id="__span-2-407"><a id="__codelineno-2-407" name="__codelineno-2-407" href="#__codelineno-2-407"></a>        <span class="k">return</span> <span class="n">recommendations</span>
</span><span id="__span-2-408"><a id="__codelineno-2-408" name="__codelineno-2-408" href="#__codelineno-2-408"></a>
</span><span id="__span-2-409"><a id="__codelineno-2-409" name="__codelineno-2-409" href="#__codelineno-2-409"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_next_review_date</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-2-410"><a id="__codelineno-2-410" name="__codelineno-2-410" href="#__codelineno-2-410"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate next recommended review date&quot;&quot;&quot;</span>
</span><span id="__span-2-411"><a id="__codelineno-2-411" name="__codelineno-2-411" href="#__codelineno-2-411"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">timedelta</span>
</span><span id="__span-2-412"><a id="__codelineno-2-412" name="__codelineno-2-412" href="#__codelineno-2-412"></a>        <span class="n">next_review</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>  <span class="c1"># Quarterly reviews</span>
</span><span id="__span-2-413"><a id="__codelineno-2-413" name="__codelineno-2-413" href="#__codelineno-2-413"></a>        <span class="k">return</span> <span class="n">next_review</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
</span><span id="__span-2-414"><a id="__codelineno-2-414" name="__codelineno-2-414" href="#__codelineno-2-414"></a>
</span><span id="__span-2-415"><a id="__codelineno-2-415" name="__codelineno-2-415" href="#__codelineno-2-415"></a><span class="k">class</span><span class="w"> </span><span class="nc">ReproducibilityChecker</span><span class="p">:</span>
</span><span id="__span-2-416"><a id="__codelineno-2-416" name="__codelineno-2-416" href="#__codelineno-2-416"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Framework for ensuring reproducibility of bias assessments and mitigations&quot;&quot;&quot;</span>
</span><span id="__span-2-417"><a id="__codelineno-2-417" name="__codelineno-2-417" href="#__codelineno-2-417"></a>
</span><span id="__span-2-418"><a id="__codelineno-2-418" name="__codelineno-2-418" href="#__codelineno-2-418"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-2-419"><a id="__codelineno-2-419" name="__codelineno-2-419" href="#__codelineno-2-419"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reproducibility_log</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-2-420"><a id="__codelineno-2-420" name="__codelineno-2-420" href="#__codelineno-2-420"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">version_registry</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-2-421"><a id="__codelineno-2-421" name="__codelineno-2-421" href="#__codelineno-2-421"></a>
</span><span id="__span-2-422"><a id="__codelineno-2-422" name="__codelineno-2-422" href="#__codelineno-2-422"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_reproducibility_package</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">experiment_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-2-423"><a id="__codelineno-2-423" name="__codelineno-2-423" href="#__codelineno-2-423"></a>                                     <span class="n">code_files</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="__span-2-424"><a id="__codelineno-2-424" name="__codelineno-2-424" href="#__codelineno-2-424"></a>                                     <span class="n">data_description</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
</span><span id="__span-2-425"><a id="__codelineno-2-425" name="__codelineno-2-425" href="#__codelineno-2-425"></a>                                     <span class="n">environment_info</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
</span><span id="__span-2-426"><a id="__codelineno-2-426" name="__codelineno-2-426" href="#__codelineno-2-426"></a>                                     <span class="n">results</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
</span><span id="__span-2-427"><a id="__codelineno-2-427" name="__codelineno-2-427" href="#__codelineno-2-427"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-2-428"><a id="__codelineno-2-428" name="__codelineno-2-428" href="#__codelineno-2-428"></a><span class="sd">        Create reproducibility package for bias assessment/mitigation</span>
</span><span id="__span-2-429"><a id="__codelineno-2-429" name="__codelineno-2-429" href="#__codelineno-2-429"></a>
</span><span id="__span-2-430"><a id="__codelineno-2-430" name="__codelineno-2-430" href="#__codelineno-2-430"></a><span class="sd">        Args:</span>
</span><span id="__span-2-431"><a id="__codelineno-2-431" name="__codelineno-2-431" href="#__codelineno-2-431"></a><span class="sd">            experiment_id: Unique identifier for the experiment</span>
</span><span id="__span-2-432"><a id="__codelineno-2-432" name="__codelineno-2-432" href="#__codelineno-2-432"></a><span class="sd">            code_files: List of code files used</span>
</span><span id="__span-2-433"><a id="__codelineno-2-433" name="__codelineno-2-433" href="#__codelineno-2-433"></a><span class="sd">            data_description: Description of data used</span>
</span><span id="__span-2-434"><a id="__codelineno-2-434" name="__codelineno-2-434" href="#__codelineno-2-434"></a><span class="sd">            environment_info: Environment and dependency information</span>
</span><span id="__span-2-435"><a id="__codelineno-2-435" name="__codelineno-2-435" href="#__codelineno-2-435"></a><span class="sd">            results: Results to be reproduced</span>
</span><span id="__span-2-436"><a id="__codelineno-2-436" name="__codelineno-2-436" href="#__codelineno-2-436"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-2-437"><a id="__codelineno-2-437" name="__codelineno-2-437" href="#__codelineno-2-437"></a>        <span class="n">package</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-2-438"><a id="__codelineno-2-438" name="__codelineno-2-438" href="#__codelineno-2-438"></a>            <span class="s1">&#39;experiment_id&#39;</span><span class="p">:</span> <span class="n">experiment_id</span><span class="p">,</span>
</span><span id="__span-2-439"><a id="__codelineno-2-439" name="__codelineno-2-439" href="#__codelineno-2-439"></a>            <span class="s1">&#39;creation_date&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
</span><span id="__span-2-440"><a id="__codelineno-2-440" name="__codelineno-2-440" href="#__codelineno-2-440"></a>            <span class="s1">&#39;code_artifacts&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-2-441"><a id="__codelineno-2-441" name="__codelineno-2-441" href="#__codelineno-2-441"></a>                <span class="s1">&#39;files&#39;</span><span class="p">:</span> <span class="n">code_files</span><span class="p">,</span>
</span><span id="__span-2-442"><a id="__codelineno-2-442" name="__codelineno-2-442" href="#__codelineno-2-442"></a>                <span class="s1">&#39;main_script&#39;</span><span class="p">:</span> <span class="n">code_files</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">code_files</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-2-443"><a id="__codelineno-2-443" name="__codelineno-2-443" href="#__codelineno-2-443"></a>                <span class="s1">&#39;code_hash&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_code_hash</span><span class="p">(</span><span class="n">code_files</span><span class="p">),</span>
</span><span id="__span-2-444"><a id="__codelineno-2-444" name="__codelineno-2-444" href="#__codelineno-2-444"></a>                <span class="s1">&#39;version_control_info&#39;</span><span class="p">:</span> <span class="n">environment_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;git_commit&#39;</span><span class="p">,</span> <span class="s1">&#39;Not tracked&#39;</span><span class="p">)</span>
</span><span id="__span-2-445"><a id="__codelineno-2-445" name="__codelineno-2-445" href="#__codelineno-2-445"></a>            <span class="p">},</span>
</span><span id="__span-2-446"><a id="__codelineno-2-446" name="__codelineno-2-446" href="#__codelineno-2-446"></a>            <span class="s1">&#39;data_artifacts&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-2-447"><a id="__codelineno-2-447" name="__codelineno-2-447" href="#__codelineno-2-447"></a>                <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="n">data_description</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;description&#39;</span><span class="p">,</span> <span class="s1">&#39;Not provided&#39;</span><span class="p">),</span>
</span><span id="__span-2-448"><a id="__codelineno-2-448" name="__codelineno-2-448" href="#__codelineno-2-448"></a>                <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="n">data_description</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;source&#39;</span><span class="p">,</span> <span class="s1">&#39;Not specified&#39;</span><span class="p">),</span>
</span><span id="__span-2-449"><a id="__codelineno-2-449" name="__codelineno-2-449" href="#__codelineno-2-449"></a>                <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="n">data_description</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;version&#39;</span><span class="p">,</span> <span class="s1">&#39;Not versioned&#39;</span><span class="p">),</span>
</span><span id="__span-2-450"><a id="__codelineno-2-450" name="__codelineno-2-450" href="#__codelineno-2-450"></a>                <span class="s1">&#39;preprocessing_steps&#39;</span><span class="p">:</span> <span class="n">data_description</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;preprocessing&#39;</span><span class="p">,</span> <span class="p">[]),</span>
</span><span id="__span-2-451"><a id="__codelineno-2-451" name="__codelineno-2-451" href="#__codelineno-2-451"></a>                <span class="s1">&#39;data_hash&#39;</span><span class="p">:</span> <span class="n">data_description</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;hash&#39;</span><span class="p">,</span> <span class="s1">&#39;Not calculated&#39;</span><span class="p">)</span>
</span><span id="__span-2-452"><a id="__codelineno-2-452" name="__codelineno-2-452" href="#__codelineno-2-452"></a>            <span class="p">},</span>
</span><span id="__span-2-453"><a id="__codelineno-2-453" name="__codelineno-2-453" href="#__codelineno-2-453"></a>            <span class="s1">&#39;environment&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-2-454"><a id="__codelineno-2-454" name="__codelineno-2-454" href="#__codelineno-2-454"></a>                <span class="s1">&#39;python_version&#39;</span><span class="p">:</span> <span class="n">environment_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;python_version&#39;</span><span class="p">,</span> <span class="s1">&#39;Not specified&#39;</span><span class="p">),</span>
</span><span id="__span-2-455"><a id="__codelineno-2-455" name="__codelineno-2-455" href="#__codelineno-2-455"></a>                <span class="s1">&#39;packages&#39;</span><span class="p">:</span> <span class="n">environment_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;packages&#39;</span><span class="p">,</span> <span class="p">{}),</span>
</span><span id="__span-2-456"><a id="__codelineno-2-456" name="__codelineno-2-456" href="#__codelineno-2-456"></a>                <span class="s1">&#39;hardware&#39;</span><span class="p">:</span> <span class="n">environment_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;hardware&#39;</span><span class="p">,</span> <span class="s1">&#39;Not specified&#39;</span><span class="p">),</span>
</span><span id="__span-2-457"><a id="__codelineno-2-457" name="__codelineno-2-457" href="#__codelineno-2-457"></a>                <span class="s1">&#39;random_seeds&#39;</span><span class="p">:</span> <span class="n">environment_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;random_seeds&#39;</span><span class="p">,</span> <span class="p">{})</span>
</span><span id="__span-2-458"><a id="__codelineno-2-458" name="__codelineno-2-458" href="#__codelineno-2-458"></a>            <span class="p">},</span>
</span><span id="__span-2-459"><a id="__codelineno-2-459" name="__codelineno-2-459" href="#__codelineno-2-459"></a>            <span class="s1">&#39;expected_results&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-2-460"><a id="__codelineno-2-460" name="__codelineno-2-460" href="#__codelineno-2-460"></a>                <span class="s1">&#39;primary_metrics&#39;</span><span class="p">:</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;primary_metrics&#39;</span><span class="p">,</span> <span class="p">{}),</span>
</span><span id="__span-2-461"><a id="__codelineno-2-461" name="__codelineno-2-461" href="#__codelineno-2-461"></a>                <span class="s1">&#39;secondary_metrics&#39;</span><span class="p">:</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;secondary_metrics&#39;</span><span class="p">,</span> <span class="p">{}),</span>
</span><span id="__span-2-462"><a id="__codelineno-2-462" name="__codelineno-2-462" href="#__codelineno-2-462"></a>                <span class="s1">&#39;result_format&#39;</span><span class="p">:</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;format&#39;</span><span class="p">,</span> <span class="s1">&#39;Not specified&#39;</span><span class="p">),</span>
</span><span id="__span-2-463"><a id="__codelineno-2-463" name="__codelineno-2-463" href="#__codelineno-2-463"></a>                <span class="s1">&#39;tolerance_levels&#39;</span><span class="p">:</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tolerance&#39;</span><span class="p">,</span> <span class="p">{})</span>
</span><span id="__span-2-464"><a id="__codelineno-2-464" name="__codelineno-2-464" href="#__codelineno-2-464"></a>            <span class="p">},</span>
</span><span id="__span-2-465"><a id="__codelineno-2-465" name="__codelineno-2-465" href="#__codelineno-2-465"></a>            <span class="s1">&#39;reproduction_instructions&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_reproduction_instructions</span><span class="p">(</span>
</span><span id="__span-2-466"><a id="__codelineno-2-466" name="__codelineno-2-466" href="#__codelineno-2-466"></a>                <span class="n">code_files</span><span class="p">,</span> <span class="n">data_description</span><span class="p">,</span> <span class="n">environment_info</span>
</span><span id="__span-2-467"><a id="__codelineno-2-467" name="__codelineno-2-467" href="#__codelineno-2-467"></a>            <span class="p">)</span>
</span><span id="__span-2-468"><a id="__codelineno-2-468" name="__codelineno-2-468" href="#__codelineno-2-468"></a>        <span class="p">}</span>
</span><span id="__span-2-469"><a id="__codelineno-2-469" name="__codelineno-2-469" href="#__codelineno-2-469"></a>
</span><span id="__span-2-470"><a id="__codelineno-2-470" name="__codelineno-2-470" href="#__codelineno-2-470"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reproducibility_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">package</span><span class="p">)</span>
</span><span id="__span-2-471"><a id="__codelineno-2-471" name="__codelineno-2-471" href="#__codelineno-2-471"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_register_version</span><span class="p">(</span><span class="n">experiment_id</span><span class="p">,</span> <span class="n">package</span><span class="p">)</span>
</span><span id="__span-2-472"><a id="__codelineno-2-472" name="__codelineno-2-472" href="#__codelineno-2-472"></a>
</span><span id="__span-2-473"><a id="__codelineno-2-473" name="__codelineno-2-473" href="#__codelineno-2-473"></a>        <span class="k">return</span> <span class="n">package</span>
</span><span id="__span-2-474"><a id="__codelineno-2-474" name="__codelineno-2-474" href="#__codelineno-2-474"></a>
</span><span id="__span-2-475"><a id="__codelineno-2-475" name="__codelineno-2-475" href="#__codelineno-2-475"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">verify_reproducibility</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">experiment_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
</span><span id="__span-2-476"><a id="__codelineno-2-476" name="__codelineno-2-476" href="#__codelineno-2-476"></a>                             <span class="n">reproduction_results</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
</span><span id="__span-2-477"><a id="__codelineno-2-477" name="__codelineno-2-477" href="#__codelineno-2-477"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-2-478"><a id="__codelineno-2-478" name="__codelineno-2-478" href="#__codelineno-2-478"></a><span class="sd">        Verify reproducibility by comparing reproduction results with original</span>
</span><span id="__span-2-479"><a id="__codelineno-2-479" name="__codelineno-2-479" href="#__codelineno-2-479"></a>
</span><span id="__span-2-480"><a id="__codelineno-2-480" name="__codelineno-2-480" href="#__codelineno-2-480"></a><span class="sd">        Args:</span>
</span><span id="__span-2-481"><a id="__codelineno-2-481" name="__codelineno-2-481" href="#__codelineno-2-481"></a><span class="sd">            experiment_id: ID of experiment to verify</span>
</span><span id="__span-2-482"><a id="__codelineno-2-482" name="__codelineno-2-482" href="#__codelineno-2-482"></a><span class="sd">            reproduction_results: Results from reproduction attempt</span>
</span><span id="__span-2-483"><a id="__codelineno-2-483" name="__codelineno-2-483" href="#__codelineno-2-483"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-2-484"><a id="__codelineno-2-484" name="__codelineno-2-484" href="#__codelineno-2-484"></a>        <span class="n">original_package</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-2-485"><a id="__codelineno-2-485" name="__codelineno-2-485" href="#__codelineno-2-485"></a>        <span class="k">for</span> <span class="n">package</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reproducibility_log</span><span class="p">:</span>
</span><span id="__span-2-486"><a id="__codelineno-2-486" name="__codelineno-2-486" href="#__codelineno-2-486"></a>            <span class="k">if</span> <span class="n">package</span><span class="p">[</span><span class="s1">&#39;experiment_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">experiment_id</span><span class="p">:</span>
</span><span id="__span-2-487"><a id="__codelineno-2-487" name="__codelineno-2-487" href="#__codelineno-2-487"></a>                <span class="n">original_package</span> <span class="o">=</span> <span class="n">package</span>
</span><span id="__span-2-488"><a id="__codelineno-2-488" name="__codelineno-2-488" href="#__codelineno-2-488"></a>                <span class="k">break</span>
</span><span id="__span-2-489"><a id="__codelineno-2-489" name="__codelineno-2-489" href="#__codelineno-2-489"></a>
</span><span id="__span-2-490"><a id="__codelineno-2-490" name="__codelineno-2-490" href="#__codelineno-2-490"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">original_package</span><span class="p">:</span>
</span><span id="__span-2-491"><a id="__codelineno-2-491" name="__codelineno-2-491" href="#__codelineno-2-491"></a>            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;Original experiment not found&#39;</span><span class="p">}</span>
</span><span id="__span-2-492"><a id="__codelineno-2-492" name="__codelineno-2-492" href="#__codelineno-2-492"></a>
</span><span id="__span-2-493"><a id="__codelineno-2-493" name="__codelineno-2-493" href="#__codelineno-2-493"></a>        <span class="n">verification_result</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-2-494"><a id="__codelineno-2-494" name="__codelineno-2-494" href="#__codelineno-2-494"></a>            <span class="s1">&#39;experiment_id&#39;</span><span class="p">:</span> <span class="n">experiment_id</span><span class="p">,</span>
</span><span id="__span-2-495"><a id="__codelineno-2-495" name="__codelineno-2-495" href="#__codelineno-2-495"></a>            <span class="s1">&#39;verification_date&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
</span><span id="__span-2-496"><a id="__codelineno-2-496" name="__codelineno-2-496" href="#__codelineno-2-496"></a>            <span class="s1">&#39;original_results&#39;</span><span class="p">:</span> <span class="n">original_package</span><span class="p">[</span><span class="s1">&#39;expected_results&#39;</span><span class="p">],</span>
</span><span id="__span-2-497"><a id="__codelineno-2-497" name="__codelineno-2-497" href="#__codelineno-2-497"></a>            <span class="s1">&#39;reproduction_results&#39;</span><span class="p">:</span> <span class="n">reproduction_results</span><span class="p">,</span>
</span><span id="__span-2-498"><a id="__codelineno-2-498" name="__codelineno-2-498" href="#__codelineno-2-498"></a>            <span class="s1">&#39;comparison&#39;</span><span class="p">:</span> <span class="p">{},</span>
</span><span id="__span-2-499"><a id="__codelineno-2-499" name="__codelineno-2-499" href="#__codelineno-2-499"></a>            <span class="s1">&#39;overall_status&#39;</span><span class="p">:</span> <span class="s1">&#39;unknown&#39;</span>
</span><span id="__span-2-500"><a id="__codelineno-2-500" name="__codelineno-2-500" href="#__codelineno-2-500"></a>        <span class="p">}</span>
</span><span id="__span-2-501"><a id="__codelineno-2-501" name="__codelineno-2-501" href="#__codelineno-2-501"></a>
</span><span id="__span-2-502"><a id="__codelineno-2-502" name="__codelineno-2-502" href="#__codelineno-2-502"></a>        <span class="c1"># Compare primary metrics</span>
</span><span id="__span-2-503"><a id="__codelineno-2-503" name="__codelineno-2-503" href="#__codelineno-2-503"></a>        <span class="n">primary_comparison</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compare_metrics</span><span class="p">(</span>
</span><span id="__span-2-504"><a id="__codelineno-2-504" name="__codelineno-2-504" href="#__codelineno-2-504"></a>            <span class="n">original_package</span><span class="p">[</span><span class="s1">&#39;expected_results&#39;</span><span class="p">][</span><span class="s1">&#39;primary_metrics&#39;</span><span class="p">],</span>
</span><span id="__span-2-505"><a id="__codelineno-2-505" name="__codelineno-2-505" href="#__codelineno-2-505"></a>            <span class="n">reproduction_results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;primary_metrics&#39;</span><span class="p">,</span> <span class="p">{}),</span>
</span><span id="__span-2-506"><a id="__codelineno-2-506" name="__codelineno-2-506" href="#__codelineno-2-506"></a>            <span class="n">original_package</span><span class="p">[</span><span class="s1">&#39;expected_results&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tolerance_levels&#39;</span><span class="p">,</span> <span class="p">{})</span>
</span><span id="__span-2-507"><a id="__codelineno-2-507" name="__codelineno-2-507" href="#__codelineno-2-507"></a>        <span class="p">)</span>
</span><span id="__span-2-508"><a id="__codelineno-2-508" name="__codelineno-2-508" href="#__codelineno-2-508"></a>
</span><span id="__span-2-509"><a id="__codelineno-2-509" name="__codelineno-2-509" href="#__codelineno-2-509"></a>        <span class="n">verification_result</span><span class="p">[</span><span class="s1">&#39;comparison&#39;</span><span class="p">][</span><span class="s1">&#39;primary_metrics&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">primary_comparison</span>
</span><span id="__span-2-510"><a id="__codelineno-2-510" name="__codelineno-2-510" href="#__codelineno-2-510"></a>
</span><span id="__span-2-511"><a id="__codelineno-2-511" name="__codelineno-2-511" href="#__codelineno-2-511"></a>        <span class="c1"># Determine overall status</span>
</span><span id="__span-2-512"><a id="__codelineno-2-512" name="__codelineno-2-512" href="#__codelineno-2-512"></a>        <span class="k">if</span> <span class="n">primary_comparison</span><span class="p">[</span><span class="s1">&#39;all_within_tolerance&#39;</span><span class="p">]:</span>
</span><span id="__span-2-513"><a id="__codelineno-2-513" name="__codelineno-2-513" href="#__codelineno-2-513"></a>            <span class="n">verification_result</span><span class="p">[</span><span class="s1">&#39;overall_status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;reproducible&#39;</span>
</span><span id="__span-2-514"><a id="__codelineno-2-514" name="__codelineno-2-514" href="#__codelineno-2-514"></a>        <span class="k">elif</span> <span class="n">primary_comparison</span><span class="p">[</span><span class="s1">&#39;some_within_tolerance&#39;</span><span class="p">]:</span>
</span><span id="__span-2-515"><a id="__codelineno-2-515" name="__codelineno-2-515" href="#__codelineno-2-515"></a>            <span class="n">verification_result</span><span class="p">[</span><span class="s1">&#39;overall_status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;partially_reproducible&#39;</span>
</span><span id="__span-2-516"><a id="__codelineno-2-516" name="__codelineno-2-516" href="#__codelineno-2-516"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-2-517"><a id="__codelineno-2-517" name="__codelineno-2-517" href="#__codelineno-2-517"></a>            <span class="n">verification_result</span><span class="p">[</span><span class="s1">&#39;overall_status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;not_reproducible&#39;</span>
</span><span id="__span-2-518"><a id="__codelineno-2-518" name="__codelineno-2-518" href="#__codelineno-2-518"></a>
</span><span id="__span-2-519"><a id="__codelineno-2-519" name="__codelineno-2-519" href="#__codelineno-2-519"></a>        <span class="c1"># Add recommendations</span>
</span><span id="__span-2-520"><a id="__codelineno-2-520" name="__codelineno-2-520" href="#__codelineno-2-520"></a>        <span class="n">verification_result</span><span class="p">[</span><span class="s1">&#39;recommendations&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_reproducibility_recommendations</span><span class="p">(</span>
</span><span id="__span-2-521"><a id="__codelineno-2-521" name="__codelineno-2-521" href="#__codelineno-2-521"></a>            <span class="n">verification_result</span>
</span><span id="__span-2-522"><a id="__codelineno-2-522" name="__codelineno-2-522" href="#__codelineno-2-522"></a>        <span class="p">)</span>
</span><span id="__span-2-523"><a id="__codelineno-2-523" name="__codelineno-2-523" href="#__codelineno-2-523"></a>
</span><span id="__span-2-524"><a id="__codelineno-2-524" name="__codelineno-2-524" href="#__codelineno-2-524"></a>        <span class="k">return</span> <span class="n">verification_result</span>
</span><span id="__span-2-525"><a id="__codelineno-2-525" name="__codelineno-2-525" href="#__codelineno-2-525"></a>
</span><span id="__span-2-526"><a id="__codelineno-2-526" name="__codelineno-2-526" href="#__codelineno-2-526"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_code_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code_files</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-2-527"><a id="__codelineno-2-527" name="__codelineno-2-527" href="#__codelineno-2-527"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate hash of code files for version tracking&quot;&quot;&quot;</span>
</span><span id="__span-2-528"><a id="__codelineno-2-528" name="__codelineno-2-528" href="#__codelineno-2-528"></a>        <span class="n">combined_content</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="__span-2-529"><a id="__codelineno-2-529" name="__codelineno-2-529" href="#__codelineno-2-529"></a>
</span><span id="__span-2-530"><a id="__codelineno-2-530" name="__codelineno-2-530" href="#__codelineno-2-530"></a>        <span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="n">code_files</span><span class="p">:</span>
</span><span id="__span-2-531"><a id="__codelineno-2-531" name="__codelineno-2-531" href="#__codelineno-2-531"></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="__span-2-532"><a id="__codelineno-2-532" name="__codelineno-2-532" href="#__codelineno-2-532"></a>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-2-533"><a id="__codelineno-2-533" name="__codelineno-2-533" href="#__codelineno-2-533"></a>                    <span class="n">combined_content</span> <span class="o">+=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="__span-2-534"><a id="__codelineno-2-534" name="__codelineno-2-534" href="#__codelineno-2-534"></a>            <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span><span id="__span-2-535"><a id="__codelineno-2-535" name="__codelineno-2-535" href="#__codelineno-2-535"></a>                <span class="n">combined_content</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;FILE_NOT_FOUND: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-2-536"><a id="__codelineno-2-536" name="__codelineno-2-536" href="#__codelineno-2-536"></a>
</span><span id="__span-2-537"><a id="__codelineno-2-537" name="__codelineno-2-537" href="#__codelineno-2-537"></a>        <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">combined_content</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</span><span id="__span-2-538"><a id="__codelineno-2-538" name="__codelineno-2-538" href="#__codelineno-2-538"></a>
</span><span id="__span-2-539"><a id="__codelineno-2-539" name="__codelineno-2-539" href="#__codelineno-2-539"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_reproduction_instructions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code_files</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="__span-2-540"><a id="__codelineno-2-540" name="__codelineno-2-540" href="#__codelineno-2-540"></a>                                          <span class="n">data_description</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
</span><span id="__span-2-541"><a id="__codelineno-2-541" name="__codelineno-2-541" href="#__codelineno-2-541"></a>                                          <span class="n">environment_info</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="__span-2-542"><a id="__codelineno-2-542" name="__codelineno-2-542" href="#__codelineno-2-542"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate step-by-step reproduction instructions&quot;&quot;&quot;</span>
</span><span id="__span-2-543"><a id="__codelineno-2-543" name="__codelineno-2-543" href="#__codelineno-2-543"></a>        <span class="n">instructions</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-2-544"><a id="__codelineno-2-544" name="__codelineno-2-544" href="#__codelineno-2-544"></a>            <span class="s2">&quot;# Reproduction Instructions&quot;</span><span class="p">,</span>
</span><span id="__span-2-545"><a id="__codelineno-2-545" name="__codelineno-2-545" href="#__codelineno-2-545"></a>            <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-2-546"><a id="__codelineno-2-546" name="__codelineno-2-546" href="#__codelineno-2-546"></a>            <span class="s2">&quot;## Environment Setup&quot;</span><span class="p">,</span>
</span><span id="__span-2-547"><a id="__codelineno-2-547" name="__codelineno-2-547" href="#__codelineno-2-547"></a>            <span class="sa">f</span><span class="s2">&quot;1. Install Python version: </span><span class="si">{</span><span class="n">environment_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;python_version&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;See requirements&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-2-548"><a id="__codelineno-2-548" name="__codelineno-2-548" href="#__codelineno-2-548"></a>            <span class="s2">&quot;2. Install required packages:&quot;</span>
</span><span id="__span-2-549"><a id="__codelineno-2-549" name="__codelineno-2-549" href="#__codelineno-2-549"></a>        <span class="p">]</span>
</span><span id="__span-2-550"><a id="__codelineno-2-550" name="__codelineno-2-550" href="#__codelineno-2-550"></a>
</span><span id="__span-2-551"><a id="__codelineno-2-551" name="__codelineno-2-551" href="#__codelineno-2-551"></a>        <span class="n">packages</span> <span class="o">=</span> <span class="n">environment_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;packages&#39;</span><span class="p">,</span> <span class="p">{})</span>
</span><span id="__span-2-552"><a id="__codelineno-2-552" name="__codelineno-2-552" href="#__codelineno-2-552"></a>        <span class="k">for</span> <span class="n">package</span><span class="p">,</span> <span class="n">version</span> <span class="ow">in</span> <span class="n">packages</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-2-553"><a id="__codelineno-2-553" name="__codelineno-2-553" href="#__codelineno-2-553"></a>            <span class="n">instructions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   - </span><span class="si">{</span><span class="n">package</span><span class="si">}</span><span class="s2">==</span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-2-554"><a id="__codelineno-2-554" name="__codelineno-2-554" href="#__codelineno-2-554"></a>
</span><span id="__span-2-555"><a id="__codelineno-2-555" name="__codelineno-2-555" href="#__codelineno-2-555"></a>        <span class="n">instructions</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
</span><span id="__span-2-556"><a id="__codelineno-2-556" name="__codelineno-2-556" href="#__codelineno-2-556"></a>            <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-2-557"><a id="__codelineno-2-557" name="__codelineno-2-557" href="#__codelineno-2-557"></a>            <span class="s2">&quot;## Data Preparation&quot;</span><span class="p">,</span>
</span><span id="__span-2-558"><a id="__codelineno-2-558" name="__codelineno-2-558" href="#__codelineno-2-558"></a>            <span class="sa">f</span><span class="s2">&quot;1. Obtain data from: </span><span class="si">{</span><span class="n">data_description</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;source&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;See documentation&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-2-559"><a id="__codelineno-2-559" name="__codelineno-2-559" href="#__codelineno-2-559"></a>            <span class="sa">f</span><span class="s2">&quot;2. Data version: </span><span class="si">{</span><span class="n">data_description</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;version&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Latest&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-2-560"><a id="__codelineno-2-560" name="__codelineno-2-560" href="#__codelineno-2-560"></a>            <span class="s2">&quot;3. Apply preprocessing steps:&quot;</span>
</span><span id="__span-2-561"><a id="__codelineno-2-561" name="__codelineno-2-561" href="#__codelineno-2-561"></a>        <span class="p">])</span>
</span><span id="__span-2-562"><a id="__codelineno-2-562" name="__codelineno-2-562" href="#__codelineno-2-562"></a>
</span><span id="__span-2-563"><a id="__codelineno-2-563" name="__codelineno-2-563" href="#__codelineno-2-563"></a>        <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">data_description</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;preprocessing&#39;</span><span class="p">,</span> <span class="p">[]):</span>
</span><span id="__span-2-564"><a id="__codelineno-2-564" name="__codelineno-2-564" href="#__codelineno-2-564"></a>            <span class="n">instructions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   - </span><span class="si">{</span><span class="n">step</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-2-565"><a id="__codelineno-2-565" name="__codelineno-2-565" href="#__codelineno-2-565"></a>
</span><span id="__span-2-566"><a id="__codelineno-2-566" name="__codelineno-2-566" href="#__codelineno-2-566"></a>        <span class="n">instructions</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
</span><span id="__span-2-567"><a id="__codelineno-2-567" name="__codelineno-2-567" href="#__codelineno-2-567"></a>            <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-2-568"><a id="__codelineno-2-568" name="__codelineno-2-568" href="#__codelineno-2-568"></a>            <span class="s2">&quot;## Code Execution&quot;</span><span class="p">,</span>
</span><span id="__span-2-569"><a id="__codelineno-2-569" name="__codelineno-2-569" href="#__codelineno-2-569"></a>            <span class="s2">&quot;1. Download code files:&quot;</span>
</span><span id="__span-2-570"><a id="__codelineno-2-570" name="__codelineno-2-570" href="#__codelineno-2-570"></a>        <span class="p">])</span>
</span><span id="__span-2-571"><a id="__codelineno-2-571" name="__codelineno-2-571" href="#__codelineno-2-571"></a>
</span><span id="__span-2-572"><a id="__codelineno-2-572" name="__codelineno-2-572" href="#__codelineno-2-572"></a>        <span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="n">code_files</span><span class="p">:</span>
</span><span id="__span-2-573"><a id="__codelineno-2-573" name="__codelineno-2-573" href="#__codelineno-2-573"></a>            <span class="n">instructions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   - </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-2-574"><a id="__codelineno-2-574" name="__codelineno-2-574" href="#__codelineno-2-574"></a>
</span><span id="__span-2-575"><a id="__codelineno-2-575" name="__codelineno-2-575" href="#__codelineno-2-575"></a>        <span class="n">instructions</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
</span><span id="__span-2-576"><a id="__codelineno-2-576" name="__codelineno-2-576" href="#__codelineno-2-576"></a>            <span class="sa">f</span><span class="s2">&quot;2. Run main script: </span><span class="si">{</span><span class="n">code_files</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">code_files</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;main.py&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-2-577"><a id="__codelineno-2-577" name="__codelineno-2-577" href="#__codelineno-2-577"></a>            <span class="s2">&quot;3. Set random seeds as specified in environment_info&quot;</span><span class="p">,</span>
</span><span id="__span-2-578"><a id="__codelineno-2-578" name="__codelineno-2-578" href="#__codelineno-2-578"></a>            <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-2-579"><a id="__codelineno-2-579" name="__codelineno-2-579" href="#__codelineno-2-579"></a>            <span class="s2">&quot;## Expected Results&quot;</span><span class="p">,</span>
</span><span id="__span-2-580"><a id="__codelineno-2-580" name="__codelineno-2-580" href="#__codelineno-2-580"></a>            <span class="s2">&quot;Compare your results with the expected_results section in this package.&quot;</span>
</span><span id="__span-2-581"><a id="__codelineno-2-581" name="__codelineno-2-581" href="#__codelineno-2-581"></a>        <span class="p">])</span>
</span><span id="__span-2-582"><a id="__codelineno-2-582" name="__codelineno-2-582" href="#__codelineno-2-582"></a>
</span><span id="__span-2-583"><a id="__codelineno-2-583" name="__codelineno-2-583" href="#__codelineno-2-583"></a>        <span class="k">return</span> <span class="n">instructions</span>
</span><span id="__span-2-584"><a id="__codelineno-2-584" name="__codelineno-2-584" href="#__codelineno-2-584"></a>
</span><span id="__span-2-585"><a id="__codelineno-2-585" name="__codelineno-2-585" href="#__codelineno-2-585"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_compare_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">original</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">reproduction</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> 
</span><span id="__span-2-586"><a id="__codelineno-2-586" name="__codelineno-2-586" href="#__codelineno-2-586"></a>                        <span class="n">tolerances</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
</span><span id="__span-2-587"><a id="__codelineno-2-587" name="__codelineno-2-587" href="#__codelineno-2-587"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Compare original and reproduction metrics&quot;&quot;&quot;</span>
</span><span id="__span-2-588"><a id="__codelineno-2-588" name="__codelineno-2-588" href="#__codelineno-2-588"></a>        <span class="n">comparison</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-2-589"><a id="__codelineno-2-589" name="__codelineno-2-589" href="#__codelineno-2-589"></a>            <span class="s1">&#39;metric_comparisons&#39;</span><span class="p">:</span> <span class="p">{},</span>
</span><span id="__span-2-590"><a id="__codelineno-2-590" name="__codelineno-2-590" href="#__codelineno-2-590"></a>            <span class="s1">&#39;all_within_tolerance&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-2-591"><a id="__codelineno-2-591" name="__codelineno-2-591" href="#__codelineno-2-591"></a>            <span class="s1">&#39;some_within_tolerance&#39;</span><span class="p">:</span> <span class="kc">False</span>
</span><span id="__span-2-592"><a id="__codelineno-2-592" name="__codelineno-2-592" href="#__codelineno-2-592"></a>        <span class="p">}</span>
</span><span id="__span-2-593"><a id="__codelineno-2-593" name="__codelineno-2-593" href="#__codelineno-2-593"></a>
</span><span id="__span-2-594"><a id="__codelineno-2-594" name="__codelineno-2-594" href="#__codelineno-2-594"></a>        <span class="k">for</span> <span class="n">metric_name</span><span class="p">,</span> <span class="n">original_value</span> <span class="ow">in</span> <span class="n">original</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-2-595"><a id="__codelineno-2-595" name="__codelineno-2-595" href="#__codelineno-2-595"></a>            <span class="k">if</span> <span class="n">metric_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">reproduction</span><span class="p">:</span>
</span><span id="__span-2-596"><a id="__codelineno-2-596" name="__codelineno-2-596" href="#__codelineno-2-596"></a>                <span class="n">comparison</span><span class="p">[</span><span class="s1">&#39;metric_comparisons&#39;</span><span class="p">][</span><span class="n">metric_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-2-597"><a id="__codelineno-2-597" name="__codelineno-2-597" href="#__codelineno-2-597"></a>                    <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;missing_in_reproduction&#39;</span><span class="p">,</span>
</span><span id="__span-2-598"><a id="__codelineno-2-598" name="__codelineno-2-598" href="#__codelineno-2-598"></a>                    <span class="s1">&#39;within_tolerance&#39;</span><span class="p">:</span> <span class="kc">False</span>
</span><span id="__span-2-599"><a id="__codelineno-2-599" name="__codelineno-2-599" href="#__codelineno-2-599"></a>                <span class="p">}</span>
</span><span id="__span-2-600"><a id="__codelineno-2-600" name="__codelineno-2-600" href="#__codelineno-2-600"></a>                <span class="n">comparison</span><span class="p">[</span><span class="s1">&#39;all_within_tolerance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-2-601"><a id="__codelineno-2-601" name="__codelineno-2-601" href="#__codelineno-2-601"></a>                <span class="k">continue</span>
</span><span id="__span-2-602"><a id="__codelineno-2-602" name="__codelineno-2-602" href="#__codelineno-2-602"></a>
</span><span id="__span-2-603"><a id="__codelineno-2-603" name="__codelineno-2-603" href="#__codelineno-2-603"></a>            <span class="n">reproduction_value</span> <span class="o">=</span> <span class="n">reproduction</span><span class="p">[</span><span class="n">metric_name</span><span class="p">]</span>
</span><span id="__span-2-604"><a id="__codelineno-2-604" name="__codelineno-2-604" href="#__codelineno-2-604"></a>            <span class="n">tolerance</span> <span class="o">=</span> <span class="n">tolerances</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">metric_name</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>  <span class="c1"># Default 1% tolerance</span>
</span><span id="__span-2-605"><a id="__codelineno-2-605" name="__codelineno-2-605" href="#__codelineno-2-605"></a>
</span><span id="__span-2-606"><a id="__codelineno-2-606" name="__codelineno-2-606" href="#__codelineno-2-606"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">original_value</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reproduction_value</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
</span><span id="__span-2-607"><a id="__codelineno-2-607" name="__codelineno-2-607" href="#__codelineno-2-607"></a>                <span class="n">relative_diff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">original_value</span> <span class="o">-</span> <span class="n">reproduction_value</span><span class="p">)</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">original_value</span><span class="p">)</span> <span class="k">if</span> <span class="n">original_value</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="nb">abs</span><span class="p">(</span><span class="n">reproduction_value</span><span class="p">)</span>
</span><span id="__span-2-608"><a id="__codelineno-2-608" name="__codelineno-2-608" href="#__codelineno-2-608"></a>                <span class="n">within_tolerance</span> <span class="o">=</span> <span class="n">relative_diff</span> <span class="o">&lt;=</span> <span class="n">tolerance</span>
</span><span id="__span-2-609"><a id="__codelineno-2-609" name="__codelineno-2-609" href="#__codelineno-2-609"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-2-610"><a id="__codelineno-2-610" name="__codelineno-2-610" href="#__codelineno-2-610"></a>                <span class="n">within_tolerance</span> <span class="o">=</span> <span class="n">original_value</span> <span class="o">==</span> <span class="n">reproduction_value</span>
</span><span id="__span-2-611"><a id="__codelineno-2-611" name="__codelineno-2-611" href="#__codelineno-2-611"></a>
</span><span id="__span-2-612"><a id="__codelineno-2-612" name="__codelineno-2-612" href="#__codelineno-2-612"></a>            <span class="n">comparison</span><span class="p">[</span><span class="s1">&#39;metric_comparisons&#39;</span><span class="p">][</span><span class="n">metric_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-2-613"><a id="__codelineno-2-613" name="__codelineno-2-613" href="#__codelineno-2-613"></a>                <span class="s1">&#39;original_value&#39;</span><span class="p">:</span> <span class="n">original_value</span><span class="p">,</span>
</span><span id="__span-2-614"><a id="__codelineno-2-614" name="__codelineno-2-614" href="#__codelineno-2-614"></a>                <span class="s1">&#39;reproduction_value&#39;</span><span class="p">:</span> <span class="n">reproduction_value</span><span class="p">,</span>
</span><span id="__span-2-615"><a id="__codelineno-2-615" name="__codelineno-2-615" href="#__codelineno-2-615"></a>                <span class="s1">&#39;within_tolerance&#39;</span><span class="p">:</span> <span class="n">within_tolerance</span><span class="p">,</span>
</span><span id="__span-2-616"><a id="__codelineno-2-616" name="__codelineno-2-616" href="#__codelineno-2-616"></a>                <span class="s1">&#39;tolerance_used&#39;</span><span class="p">:</span> <span class="n">tolerance</span>
</span><span id="__span-2-617"><a id="__codelineno-2-617" name="__codelineno-2-617" href="#__codelineno-2-617"></a>            <span class="p">}</span>
</span><span id="__span-2-618"><a id="__codelineno-2-618" name="__codelineno-2-618" href="#__codelineno-2-618"></a>
</span><span id="__span-2-619"><a id="__codelineno-2-619" name="__codelineno-2-619" href="#__codelineno-2-619"></a>            <span class="k">if</span> <span class="n">within_tolerance</span><span class="p">:</span>
</span><span id="__span-2-620"><a id="__codelineno-2-620" name="__codelineno-2-620" href="#__codelineno-2-620"></a>                <span class="n">comparison</span><span class="p">[</span><span class="s1">&#39;some_within_tolerance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-2-621"><a id="__codelineno-2-621" name="__codelineno-2-621" href="#__codelineno-2-621"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-2-622"><a id="__codelineno-2-622" name="__codelineno-2-622" href="#__codelineno-2-622"></a>                <span class="n">comparison</span><span class="p">[</span><span class="s1">&#39;all_within_tolerance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-2-623"><a id="__codelineno-2-623" name="__codelineno-2-623" href="#__codelineno-2-623"></a>
</span><span id="__span-2-624"><a id="__codelineno-2-624" name="__codelineno-2-624" href="#__codelineno-2-624"></a>        <span class="k">return</span> <span class="n">comparison</span>
</span><span id="__span-2-625"><a id="__codelineno-2-625" name="__codelineno-2-625" href="#__codelineno-2-625"></a>
</span><span id="__span-2-626"><a id="__codelineno-2-626" name="__codelineno-2-626" href="#__codelineno-2-626"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_reproducibility_recommendations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verification_result</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="__span-2-627"><a id="__codelineno-2-627" name="__codelineno-2-627" href="#__codelineno-2-627"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate recommendations based on reproducibility verification&quot;&quot;&quot;</span>
</span><span id="__span-2-628"><a id="__codelineno-2-628" name="__codelineno-2-628" href="#__codelineno-2-628"></a>        <span class="n">recommendations</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-2-629"><a id="__codelineno-2-629" name="__codelineno-2-629" href="#__codelineno-2-629"></a>
</span><span id="__span-2-630"><a id="__codelineno-2-630" name="__codelineno-2-630" href="#__codelineno-2-630"></a>        <span class="n">status</span> <span class="o">=</span> <span class="n">verification_result</span><span class="p">[</span><span class="s1">&#39;overall_status&#39;</span><span class="p">]</span>
</span><span id="__span-2-631"><a id="__codelineno-2-631" name="__codelineno-2-631" href="#__codelineno-2-631"></a>
</span><span id="__span-2-632"><a id="__codelineno-2-632" name="__codelineno-2-632" href="#__codelineno-2-632"></a>        <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;not_reproducible&#39;</span><span class="p">:</span>
</span><span id="__span-2-633"><a id="__codelineno-2-633" name="__codelineno-2-633" href="#__codelineno-2-633"></a>            <span class="n">recommendations</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
</span><span id="__span-2-634"><a id="__codelineno-2-634" name="__codelineno-2-634" href="#__codelineno-2-634"></a>                <span class="s2">&quot;Critical: Results not reproducible - investigate methodology&quot;</span><span class="p">,</span>
</span><span id="__span-2-635"><a id="__codelineno-2-635" name="__codelineno-2-635" href="#__codelineno-2-635"></a>                <span class="s2">&quot;Check environment setup and dependencies&quot;</span><span class="p">,</span>
</span><span id="__span-2-636"><a id="__codelineno-2-636" name="__codelineno-2-636" href="#__codelineno-2-636"></a>                <span class="s2">&quot;Verify data preprocessing steps&quot;</span><span class="p">,</span>
</span><span id="__span-2-637"><a id="__codelineno-2-637" name="__codelineno-2-637" href="#__codelineno-2-637"></a>                <span class="s2">&quot;Review random seed settings&quot;</span>
</span><span id="__span-2-638"><a id="__codelineno-2-638" name="__codelineno-2-638" href="#__codelineno-2-638"></a>            <span class="p">])</span>
</span><span id="__span-2-639"><a id="__codelineno-2-639" name="__codelineno-2-639" href="#__codelineno-2-639"></a>        <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;partially_reproducible&#39;</span><span class="p">:</span>
</span><span id="__span-2-640"><a id="__codelineno-2-640" name="__codelineno-2-640" href="#__codelineno-2-640"></a>            <span class="n">recommendations</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
</span><span id="__span-2-641"><a id="__codelineno-2-641" name="__codelineno-2-641" href="#__codelineno-2-641"></a>                <span class="s2">&quot;Some metrics not reproducible - investigate specific differences&quot;</span><span class="p">,</span>
</span><span id="__span-2-642"><a id="__codelineno-2-642" name="__codelineno-2-642" href="#__codelineno-2-642"></a>                <span class="s2">&quot;Consider adjusting tolerance levels if differences are minor&quot;</span><span class="p">,</span>
</span><span id="__span-2-643"><a id="__codelineno-2-643" name="__codelineno-2-643" href="#__codelineno-2-643"></a>                <span class="s2">&quot;Document known sources of variation&quot;</span>
</span><span id="__span-2-644"><a id="__codelineno-2-644" name="__codelineno-2-644" href="#__codelineno-2-644"></a>            <span class="p">])</span>
</span><span id="__span-2-645"><a id="__codelineno-2-645" name="__codelineno-2-645" href="#__codelineno-2-645"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-2-646"><a id="__codelineno-2-646" name="__codelineno-2-646" href="#__codelineno-2-646"></a>            <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Results successfully reproduced&quot;</span><span class="p">)</span>
</span><span id="__span-2-647"><a id="__codelineno-2-647" name="__codelineno-2-647" href="#__codelineno-2-647"></a>
</span><span id="__span-2-648"><a id="__codelineno-2-648" name="__codelineno-2-648" href="#__codelineno-2-648"></a>        <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Archive this reproduction package for future reference&quot;</span><span class="p">)</span>
</span><span id="__span-2-649"><a id="__codelineno-2-649" name="__codelineno-2-649" href="#__codelineno-2-649"></a>
</span><span id="__span-2-650"><a id="__codelineno-2-650" name="__codelineno-2-650" href="#__codelineno-2-650"></a>        <span class="k">return</span> <span class="n">recommendations</span>
</span><span id="__span-2-651"><a id="__codelineno-2-651" name="__codelineno-2-651" href="#__codelineno-2-651"></a>
</span><span id="__span-2-652"><a id="__codelineno-2-652" name="__codelineno-2-652" href="#__codelineno-2-652"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_register_version</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">experiment_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">package</span><span class="p">:</span> <span class="n">Dict</span><span class="p">):</span>
</span><span id="__span-2-653"><a id="__codelineno-2-653" name="__codelineno-2-653" href="#__codelineno-2-653"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Register experiment version in registry&quot;&quot;&quot;</span>
</span><span id="__span-2-654"><a id="__codelineno-2-654" name="__codelineno-2-654" href="#__codelineno-2-654"></a>        <span class="k">if</span> <span class="n">experiment_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">version_registry</span><span class="p">:</span>
</span><span id="__span-2-655"><a id="__codelineno-2-655" name="__codelineno-2-655" href="#__codelineno-2-655"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">version_registry</span><span class="p">[</span><span class="n">experiment_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-2-656"><a id="__codelineno-2-656" name="__codelineno-2-656" href="#__codelineno-2-656"></a>
</span><span id="__span-2-657"><a id="__codelineno-2-657" name="__codelineno-2-657" href="#__codelineno-2-657"></a>        <span class="n">version_info</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-2-658"><a id="__codelineno-2-658" name="__codelineno-2-658" href="#__codelineno-2-658"></a>            <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">version_registry</span><span class="p">[</span><span class="n">experiment_id</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-2-659"><a id="__codelineno-2-659" name="__codelineno-2-659" href="#__codelineno-2-659"></a>            <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="n">package</span><span class="p">[</span><span class="s1">&#39;creation_date&#39;</span><span class="p">],</span>
</span><span id="__span-2-660"><a id="__codelineno-2-660" name="__codelineno-2-660" href="#__codelineno-2-660"></a>            <span class="s1">&#39;code_hash&#39;</span><span class="p">:</span> <span class="n">package</span><span class="p">[</span><span class="s1">&#39;code_artifacts&#39;</span><span class="p">][</span><span class="s1">&#39;code_hash&#39;</span><span class="p">],</span>
</span><span id="__span-2-661"><a id="__codelineno-2-661" name="__codelineno-2-661" href="#__codelineno-2-661"></a>            <span class="s1">&#39;data_hash&#39;</span><span class="p">:</span> <span class="n">package</span><span class="p">[</span><span class="s1">&#39;data_artifacts&#39;</span><span class="p">][</span><span class="s1">&#39;data_hash&#39;</span><span class="p">]</span>
</span><span id="__span-2-662"><a id="__codelineno-2-662" name="__codelineno-2-662" href="#__codelineno-2-662"></a>        <span class="p">}</span>
</span><span id="__span-2-663"><a id="__codelineno-2-663" name="__codelineno-2-663" href="#__codelineno-2-663"></a>
</span><span id="__span-2-664"><a id="__codelineno-2-664" name="__codelineno-2-664" href="#__codelineno-2-664"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">version_registry</span><span class="p">[</span><span class="n">experiment_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">version_info</span><span class="p">)</span>
</span><span id="__span-2-665"><a id="__codelineno-2-665" name="__codelineno-2-665" href="#__codelineno-2-665"></a>
</span><span id="__span-2-666"><a id="__codelineno-2-666" name="__codelineno-2-666" href="#__codelineno-2-666"></a><span class="c1"># Comprehensive demonstration function</span>
</span><span id="__span-2-667"><a id="__codelineno-2-667" name="__codelineno-2-667" href="#__codelineno-2-667"></a><span class="k">def</span><span class="w"> </span><span class="nf">demonstrate_transparency_accountability_tools</span><span class="p">():</span>
</span><span id="__span-2-668"><a id="__codelineno-2-668" name="__codelineno-2-668" href="#__codelineno-2-668"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrate transparency and accountability tools&quot;&quot;&quot;</span>
</span><span id="__span-2-669"><a id="__codelineno-2-669" name="__codelineno-2-669" href="#__codelineno-2-669"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Transparency and Accountability Tools Demonstration ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-2-670"><a id="__codelineno-2-670" name="__codelineno-2-670" href="#__codelineno-2-670"></a>
</span><span id="__span-2-671"><a id="__codelineno-2-671" name="__codelineno-2-671" href="#__codelineno-2-671"></a>    <span class="c1"># 1. Model Card Generation</span>
</span><span id="__span-2-672"><a id="__codelineno-2-672" name="__codelineno-2-672" href="#__codelineno-2-672"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1. Model Card Generation:&quot;</span><span class="p">)</span>
</span><span id="__span-2-673"><a id="__codelineno-2-673" name="__codelineno-2-673" href="#__codelineno-2-673"></a>    <span class="n">model_card_gen</span> <span class="o">=</span> <span class="n">ModelCardGenerator</span><span class="p">()</span>
</span><span id="__span-2-674"><a id="__codelineno-2-674" name="__codelineno-2-674" href="#__codelineno-2-674"></a>
</span><span id="__span-2-675"><a id="__codelineno-2-675" name="__codelineno-2-675" href="#__codelineno-2-675"></a>    <span class="c1"># Sample model information</span>
</span><span id="__span-2-676"><a id="__codelineno-2-676" name="__codelineno-2-676" href="#__codelineno-2-676"></a>    <span class="n">model_info</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-2-677"><a id="__codelineno-2-677" name="__codelineno-2-677" href="#__codelineno-2-677"></a>        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Hiring Decision Classifier&#39;</span><span class="p">,</span>
</span><span id="__span-2-678"><a id="__codelineno-2-678" name="__codelineno-2-678" href="#__codelineno-2-678"></a>        <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;2.1&#39;</span><span class="p">,</span>
</span><span id="__span-2-679"><a id="__codelineno-2-679" name="__codelineno-2-679" href="#__codelineno-2-679"></a>        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;Binary Classification&#39;</span><span class="p">,</span>
</span><span id="__span-2-680"><a id="__codelineno-2-680" name="__codelineno-2-680" href="#__codelineno-2-680"></a>        <span class="s1">&#39;architecture&#39;</span><span class="p">:</span> <span class="s1">&#39;Logistic Regression&#39;</span><span class="p">,</span>
</span><span id="__span-2-681"><a id="__codelineno-2-681" name="__codelineno-2-681" href="#__codelineno-2-681"></a>        <span class="s1">&#39;intended_uses&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Resume screening&#39;</span><span class="p">,</span> <span class="s1">&#39;Initial candidate assessment&#39;</span><span class="p">],</span>
</span><span id="__span-2-682"><a id="__codelineno-2-682" name="__codelineno-2-682" href="#__codelineno-2-682"></a>        <span class="s1">&#39;intended_users&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;HR departments&#39;</span><span class="p">,</span> <span class="s1">&#39;Recruitment agencies&#39;</span><span class="p">],</span>
</span><span id="__span-2-683"><a id="__codelineno-2-683" name="__codelineno-2-683" href="#__codelineno-2-683"></a>        <span class="s1">&#39;out_of_scope&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Final hiring decisions&#39;</span><span class="p">,</span> <span class="s1">&#39;Salary determination&#39;</span><span class="p">]</span>
</span><span id="__span-2-684"><a id="__codelineno-2-684" name="__codelineno-2-684" href="#__codelineno-2-684"></a>    <span class="p">}</span>
</span><span id="__span-2-685"><a id="__codelineno-2-685" name="__codelineno-2-685" href="#__codelineno-2-685"></a>
</span><span id="__span-2-686"><a id="__codelineno-2-686" name="__codelineno-2-686" href="#__codelineno-2-686"></a>    <span class="n">training_data_info</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-2-687"><a id="__codelineno-2-687" name="__codelineno-2-687" href="#__codelineno-2-687"></a>        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Historical Hiring Data 2020-2023&#39;</span><span class="p">,</span>
</span><span id="__span-2-688"><a id="__codelineno-2-688" name="__codelineno-2-688" href="#__codelineno-2-688"></a>        <span class="s1">&#39;collection_method&#39;</span><span class="p">:</span> <span class="s1">&#39;Administrative records&#39;</span><span class="p">,</span>
</span><span id="__span-2-689"><a id="__codelineno-2-689" name="__codelineno-2-689" href="#__codelineno-2-689"></a>        <span class="s1">&#39;demographic_factors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">,</span> <span class="s1">&#39;age_group&#39;</span><span class="p">,</span> <span class="s1">&#39;education_level&#39;</span><span class="p">],</span>
</span><span id="__span-2-690"><a id="__codelineno-2-690" name="__codelineno-2-690" href="#__codelineno-2-690"></a>        <span class="s1">&#39;demographic_distribution&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;gender&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">}},</span>
</span><span id="__span-2-691"><a id="__codelineno-2-691" name="__codelineno-2-691" href="#__codelineno-2-691"></a>        <span class="s1">&#39;bias_mitigation&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Reweighting&#39;</span><span class="p">,</span> <span class="s1">&#39;Fairness constraints&#39;</span><span class="p">]</span>
</span><span id="__span-2-692"><a id="__codelineno-2-692" name="__codelineno-2-692" href="#__codelineno-2-692"></a>    <span class="p">}</span>
</span><span id="__span-2-693"><a id="__codelineno-2-693" name="__codelineno-2-693" href="#__codelineno-2-693"></a>
</span><span id="__span-2-694"><a id="__codelineno-2-694" name="__codelineno-2-694" href="#__codelineno-2-694"></a>    <span class="n">evaluation_results</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-2-695"><a id="__codelineno-2-695" name="__codelineno-2-695" href="#__codelineno-2-695"></a>        <span class="s1">&#39;performance_metrics&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="mf">0.85</span><span class="p">,</span> <span class="s1">&#39;precision&#39;</span><span class="p">:</span> <span class="mf">0.82</span><span class="p">,</span> <span class="s1">&#39;recall&#39;</span><span class="p">:</span> <span class="mf">0.78</span><span class="p">}</span>
</span><span id="__span-2-696"><a id="__codelineno-2-696" name="__codelineno-2-696" href="#__codelineno-2-696"></a>    <span class="p">}</span>
</span><span id="__span-2-697"><a id="__codelineno-2-697" name="__codelineno-2-697" href="#__codelineno-2-697"></a>
</span><span id="__span-2-698"><a id="__codelineno-2-698" name="__codelineno-2-698" href="#__codelineno-2-698"></a>    <span class="n">bias_analysis</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-2-699"><a id="__codelineno-2-699" name="__codelineno-2-699" href="#__codelineno-2-699"></a>        <span class="s1">&#39;overall_severity&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
</span><span id="__span-2-700"><a id="__codelineno-2-700" name="__codelineno-2-700" href="#__codelineno-2-700"></a>        <span class="s1">&#39;affected_groups&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;female_candidates&#39;</span><span class="p">],</span>
</span><span id="__span-2-701"><a id="__codelineno-2-701" name="__codelineno-2-701" href="#__codelineno-2-701"></a>        <span class="s1">&#39;mitigation_strategies&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Applied demographic parity constraints&#39;</span><span class="p">],</span>
</span><span id="__span-2-702"><a id="__codelineno-2-702" name="__codelineno-2-702" href="#__codelineno-2-702"></a>        <span class="s1">&#39;analyzed_factors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">,</span> <span class="s1">&#39;age_group&#39;</span><span class="p">]</span>
</span><span id="__span-2-703"><a id="__codelineno-2-703" name="__codelineno-2-703" href="#__codelineno-2-703"></a>    <span class="p">}</span>
</span><span id="__span-2-704"><a id="__codelineno-2-704" name="__codelineno-2-704" href="#__codelineno-2-704"></a>
</span><span id="__span-2-705"><a id="__codelineno-2-705" name="__codelineno-2-705" href="#__codelineno-2-705"></a>    <span class="n">model_card</span> <span class="o">=</span> <span class="n">model_card_gen</span><span class="o">.</span><span class="n">create_model_card</span><span class="p">(</span>
</span><span id="__span-2-706"><a id="__codelineno-2-706" name="__codelineno-2-706" href="#__codelineno-2-706"></a>        <span class="n">model_info</span><span class="p">,</span> <span class="n">training_data_info</span><span class="p">,</span> <span class="n">evaluation_results</span><span class="p">,</span> <span class="n">bias_analysis</span>
</span><span id="__span-2-707"><a id="__codelineno-2-707" name="__codelineno-2-707" href="#__codelineno-2-707"></a>    <span class="p">)</span>
</span><span id="__span-2-708"><a id="__codelineno-2-708" name="__codelineno-2-708" href="#__codelineno-2-708"></a>
</span><span id="__span-2-709"><a id="__codelineno-2-709" name="__codelineno-2-709" href="#__codelineno-2-709"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Model card created for: </span><span class="si">{</span><span class="n">model_card</span><span class="p">[</span><span class="s1">&#39;model_details&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-2-710"><a id="__codelineno-2-710" name="__codelineno-2-710" href="#__codelineno-2-710"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Ethical considerations: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">model_card</span><span class="p">[</span><span class="s1">&#39;ethical_considerations&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2"> items&quot;</span><span class="p">)</span>
</span><span id="__span-2-711"><a id="__codelineno-2-711" name="__codelineno-2-711" href="#__codelineno-2-711"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Bias mitigation documented: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">training_data_info</span><span class="p">[</span><span class="s1">&#39;bias_mitigation&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2"> strategies&quot;</span><span class="p">)</span>
</span><span id="__span-2-712"><a id="__codelineno-2-712" name="__codelineno-2-712" href="#__codelineno-2-712"></a>    <span class="nb">print</span><span class="p">()</span>
</span><span id="__span-2-713"><a id="__codelineno-2-713" name="__codelineno-2-713" href="#__codelineno-2-713"></a>
</span><span id="__span-2-714"><a id="__codelineno-2-714" name="__codelineno-2-714" href="#__codelineno-2-714"></a>    <span class="c1"># 2. Bias Documentation Framework</span>
</span><span id="__span-2-715"><a id="__codelineno-2-715" name="__codelineno-2-715" href="#__codelineno-2-715"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2. Bias Documentation Framework:&quot;</span><span class="p">)</span>
</span><span id="__span-2-716"><a id="__codelineno-2-716" name="__codelineno-2-716" href="#__codelineno-2-716"></a>    <span class="n">doc_framework</span> <span class="o">=</span> <span class="n">BiasDocumentationFramework</span><span class="p">()</span>
</span><span id="__span-2-717"><a id="__codelineno-2-717" name="__codelineno-2-717" href="#__codelineno-2-717"></a>
</span><span id="__span-2-718"><a id="__codelineno-2-718" name="__codelineno-2-718" href="#__codelineno-2-718"></a>    <span class="c1"># Document bias assessment</span>
</span><span id="__span-2-719"><a id="__codelineno-2-719" name="__codelineno-2-719" href="#__codelineno-2-719"></a>    <span class="n">assessment_doc</span> <span class="o">=</span> <span class="n">doc_framework</span><span class="o">.</span><span class="n">document_bias_assessment</span><span class="p">(</span>
</span><span id="__span-2-720"><a id="__codelineno-2-720" name="__codelineno-2-720" href="#__codelineno-2-720"></a>        <span class="s1">&#39;BIAS_ASSESS_001&#39;</span><span class="p">,</span>
</span><span id="__span-2-721"><a id="__codelineno-2-721" name="__codelineno-2-721" href="#__codelineno-2-721"></a>        <span class="s1">&#39;demographic_parity_analysis&#39;</span><span class="p">,</span>
</span><span id="__span-2-722"><a id="__codelineno-2-722" name="__codelineno-2-722" href="#__codelineno-2-722"></a>        <span class="p">{</span>
</span><span id="__span-2-723"><a id="__codelineno-2-723" name="__codelineno-2-723" href="#__codelineno-2-723"></a>            <span class="s1">&#39;approach&#39;</span><span class="p">:</span> <span class="s1">&#39;Statistical parity testing&#39;</span><span class="p">,</span>
</span><span id="__span-2-724"><a id="__codelineno-2-724" name="__codelineno-2-724" href="#__codelineno-2-724"></a>            <span class="s1">&#39;tools&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;fairness_metrics_library&#39;</span><span class="p">],</span>
</span><span id="__span-2-725"><a id="__codelineno-2-725" name="__codelineno-2-725" href="#__codelineno-2-725"></a>            <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;demographic_parity&#39;</span><span class="p">,</span> <span class="s1">&#39;equalized_odds&#39;</span><span class="p">]</span>
</span><span id="__span-2-726"><a id="__codelineno-2-726" name="__codelineno-2-726" href="#__codelineno-2-726"></a>        <span class="p">},</span>
</span><span id="__span-2-727"><a id="__codelineno-2-727" name="__codelineno-2-727" href="#__codelineno-2-727"></a>        <span class="p">{</span>
</span><span id="__span-2-728"><a id="__codelineno-2-728" name="__codelineno-2-728" href="#__codelineno-2-728"></a>            <span class="s1">&#39;summary&#39;</span><span class="p">:</span> <span class="s1">&#39;Moderate bias detected in gender predictions&#39;</span><span class="p">,</span>
</span><span id="__span-2-729"><a id="__codelineno-2-729" name="__codelineno-2-729" href="#__codelineno-2-729"></a>            <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;moderate&#39;</span><span class="p">,</span>
</span><span id="__span-2-730"><a id="__codelineno-2-730" name="__codelineno-2-730" href="#__codelineno-2-730"></a>            <span class="s1">&#39;affected_groups&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;female_candidates&#39;</span><span class="p">]</span>
</span><span id="__span-2-731"><a id="__codelineno-2-731" name="__codelineno-2-731" href="#__codelineno-2-731"></a>        <span class="p">},</span>
</span><span id="__span-2-732"><a id="__codelineno-2-732" name="__codelineno-2-732" href="#__codelineno-2-732"></a>        <span class="p">[</span><span class="s1">&#39;Apply reweighting&#39;</span><span class="p">,</span> <span class="s1">&#39;Implement fairness constraints&#39;</span><span class="p">]</span>
</span><span id="__span-2-733"><a id="__codelineno-2-733" name="__codelineno-2-733" href="#__codelineno-2-733"></a>    <span class="p">)</span>
</span><span id="__span-2-734"><a id="__codelineno-2-734" name="__codelineno-2-734" href="#__codelineno-2-734"></a>
</span><span id="__span-2-735"><a id="__codelineno-2-735" name="__codelineno-2-735" href="#__codelineno-2-735"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Assessment documented: </span><span class="si">{</span><span class="n">assessment_doc</span><span class="p">[</span><span class="s1">&#39;assessment_id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-2-736"><a id="__codelineno-2-736" name="__codelineno-2-736" href="#__codelineno-2-736"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Severity: </span><span class="si">{</span><span class="n">assessment_doc</span><span class="p">[</span><span class="s1">&#39;results&#39;</span><span class="p">][</span><span class="s1">&#39;severity_assessment&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-2-737"><a id="__codelineno-2-737" name="__codelineno-2-737" href="#__codelineno-2-737"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Actions planned: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">assessment_doc</span><span class="p">[</span><span class="s1">&#39;decisions_and_actions&#39;</span><span class="p">][</span><span class="s1">&#39;immediate_decisions&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-2-738"><a id="__codelineno-2-738" name="__codelineno-2-738" href="#__codelineno-2-738"></a>
</span><span id="__span-2-739"><a id="__codelineno-2-739" name="__codelineno-2-739" href="#__codelineno-2-739"></a>    <span class="c1"># Generate compliance report</span>
</span><span id="__span-2-740"><a id="__codelineno-2-740" name="__codelineno-2-740" href="#__codelineno-2-740"></a>    <span class="n">compliance_report</span> <span class="o">=</span> <span class="n">doc_framework</span><span class="o">.</span><span class="n">generate_compliance_report</span><span class="p">()</span>
</span><span id="__span-2-741"><a id="__codelineno-2-741" name="__codelineno-2-741" href="#__codelineno-2-741"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Compliance report generated - </span><span class="si">{</span><span class="n">compliance_report</span><span class="p">[</span><span class="s1">&#39;summary_statistics&#39;</span><span class="p">][</span><span class="s1">&#39;total_bias_assessments&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> assessments documented&quot;</span><span class="p">)</span>
</span><span id="__span-2-742"><a id="__codelineno-2-742" name="__codelineno-2-742" href="#__codelineno-2-742"></a>    <span class="nb">print</span><span class="p">()</span>
</span><span id="__span-2-743"><a id="__codelineno-2-743" name="__codelineno-2-743" href="#__codelineno-2-743"></a>
</span><span id="__span-2-744"><a id="__codelineno-2-744" name="__codelineno-2-744" href="#__codelineno-2-744"></a>    <span class="c1"># 3. Reproducibility Checker</span>
</span><span id="__span-2-745"><a id="__codelineno-2-745" name="__codelineno-2-745" href="#__codelineno-2-745"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;3. Reproducibility Checker:&quot;</span><span class="p">)</span>
</span><span id="__span-2-746"><a id="__codelineno-2-746" name="__codelineno-2-746" href="#__codelineno-2-746"></a>    <span class="n">repro_checker</span> <span class="o">=</span> <span class="n">ReproducibilityChecker</span><span class="p">()</span>
</span><span id="__span-2-747"><a id="__codelineno-2-747" name="__codelineno-2-747" href="#__codelineno-2-747"></a>
</span><span id="__span-2-748"><a id="__codelineno-2-748" name="__codelineno-2-748" href="#__codelineno-2-748"></a>    <span class="c1"># Create reproducibility package</span>
</span><span id="__span-2-749"><a id="__codelineno-2-749" name="__codelineno-2-749" href="#__codelineno-2-749"></a>    <span class="n">repro_package</span> <span class="o">=</span> <span class="n">repro_checker</span><span class="o">.</span><span class="n">create_reproducibility_package</span><span class="p">(</span>
</span><span id="__span-2-750"><a id="__codelineno-2-750" name="__codelineno-2-750" href="#__codelineno-2-750"></a>        <span class="s1">&#39;BIAS_EXPERIMENT_001&#39;</span><span class="p">,</span>
</span><span id="__span-2-751"><a id="__codelineno-2-751" name="__codelineno-2-751" href="#__codelineno-2-751"></a>        <span class="p">[</span><span class="s1">&#39;bias_analysis.py&#39;</span><span class="p">,</span> <span class="s1">&#39;fairness_metrics.py&#39;</span><span class="p">],</span>
</span><span id="__span-2-752"><a id="__codelineno-2-752" name="__codelineno-2-752" href="#__codelineno-2-752"></a>        <span class="p">{</span>
</span><span id="__span-2-753"><a id="__codelineno-2-753" name="__codelineno-2-753" href="#__codelineno-2-753"></a>            <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Hiring dataset with demographic information&#39;</span><span class="p">,</span>
</span><span id="__span-2-754"><a id="__codelineno-2-754" name="__codelineno-2-754" href="#__codelineno-2-754"></a>            <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="s1">&#39;company_hr_database&#39;</span><span class="p">,</span>
</span><span id="__span-2-755"><a id="__codelineno-2-755" name="__codelineno-2-755" href="#__codelineno-2-755"></a>            <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;2023_Q4&#39;</span><span class="p">,</span>
</span><span id="__span-2-756"><a id="__codelineno-2-756" name="__codelineno-2-756" href="#__codelineno-2-756"></a>            <span class="s1">&#39;preprocessing&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Remove PII&#39;</span><span class="p">,</span> <span class="s1">&#39;Normalize scores&#39;</span><span class="p">,</span> <span class="s1">&#39;Handle missing values&#39;</span><span class="p">]</span>
</span><span id="__span-2-757"><a id="__codelineno-2-757" name="__codelineno-2-757" href="#__codelineno-2-757"></a>        <span class="p">},</span>
</span><span id="__span-2-758"><a id="__codelineno-2-758" name="__codelineno-2-758" href="#__codelineno-2-758"></a>        <span class="p">{</span>
</span><span id="__span-2-759"><a id="__codelineno-2-759" name="__codelineno-2-759" href="#__codelineno-2-759"></a>            <span class="s1">&#39;python_version&#39;</span><span class="p">:</span> <span class="s1">&#39;3.9.7&#39;</span><span class="p">,</span>
</span><span id="__span-2-760"><a id="__codelineno-2-760" name="__codelineno-2-760" href="#__codelineno-2-760"></a>            <span class="s1">&#39;packages&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;scikit-learn&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.2&#39;</span><span class="p">,</span> <span class="s1">&#39;pandas&#39;</span><span class="p">:</span> <span class="s1">&#39;1.3.3&#39;</span><span class="p">,</span> <span class="s1">&#39;numpy&#39;</span><span class="p">:</span> <span class="s1">&#39;1.21.2&#39;</span><span class="p">},</span>
</span><span id="__span-2-761"><a id="__codelineno-2-761" name="__codelineno-2-761" href="#__codelineno-2-761"></a>            <span class="s1">&#39;random_seeds&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;numpy&#39;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="s1">&#39;sklearn&#39;</span><span class="p">:</span> <span class="mi">123</span><span class="p">}</span>
</span><span id="__span-2-762"><a id="__codelineno-2-762" name="__codelineno-2-762" href="#__codelineno-2-762"></a>        <span class="p">},</span>
</span><span id="__span-2-763"><a id="__codelineno-2-763" name="__codelineno-2-763" href="#__codelineno-2-763"></a>        <span class="p">{</span>
</span><span id="__span-2-764"><a id="__codelineno-2-764" name="__codelineno-2-764" href="#__codelineno-2-764"></a>            <span class="s1">&#39;primary_metrics&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;demographic_parity_difference&#39;</span><span class="p">:</span> <span class="mf">0.12</span><span class="p">,</span> <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="mf">0.85</span><span class="p">},</span>
</span><span id="__span-2-765"><a id="__codelineno-2-765" name="__codelineno-2-765" href="#__codelineno-2-765"></a>            <span class="s1">&#39;tolerance&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;demographic_parity_difference&#39;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">}</span>
</span><span id="__span-2-766"><a id="__codelineno-2-766" name="__codelineno-2-766" href="#__codelineno-2-766"></a>        <span class="p">}</span>
</span><span id="__span-2-767"><a id="__codelineno-2-767" name="__codelineno-2-767" href="#__codelineno-2-767"></a>    <span class="p">)</span>
</span><span id="__span-2-768"><a id="__codelineno-2-768" name="__codelineno-2-768" href="#__codelineno-2-768"></a>
</span><span id="__span-2-769"><a id="__codelineno-2-769" name="__codelineno-2-769" href="#__codelineno-2-769"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Reproducibility package created: </span><span class="si">{</span><span class="n">repro_package</span><span class="p">[</span><span class="s1">&#39;experiment_id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-2-770"><a id="__codelineno-2-770" name="__codelineno-2-770" href="#__codelineno-2-770"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Code hash: </span><span class="si">{</span><span class="n">repro_package</span><span class="p">[</span><span class="s1">&#39;code_artifacts&#39;</span><span class="p">][</span><span class="s1">&#39;code_hash&#39;</span><span class="p">][:</span><span class="mi">8</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
</span><span id="__span-2-771"><a id="__codelineno-2-771" name="__codelineno-2-771" href="#__codelineno-2-771"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Instructions generated: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">repro_package</span><span class="p">[</span><span class="s1">&#39;reproduction_instructions&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2"> steps&quot;</span><span class="p">)</span>
</span><span id="__span-2-772"><a id="__codelineno-2-772" name="__codelineno-2-772" href="#__codelineno-2-772"></a>
</span><span id="__span-2-773"><a id="__codelineno-2-773" name="__codelineno-2-773" href="#__codelineno-2-773"></a>    <span class="c1"># Simulate verification</span>
</span><span id="__span-2-774"><a id="__codelineno-2-774" name="__codelineno-2-774" href="#__codelineno-2-774"></a>    <span class="n">reproduction_results</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-2-775"><a id="__codelineno-2-775" name="__codelineno-2-775" href="#__codelineno-2-775"></a>        <span class="s1">&#39;primary_metrics&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;demographic_parity_difference&#39;</span><span class="p">:</span> <span class="mf">0.11</span><span class="p">,</span> <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="mf">0.84</span><span class="p">}</span>
</span><span id="__span-2-776"><a id="__codelineno-2-776" name="__codelineno-2-776" href="#__codelineno-2-776"></a>    <span class="p">}</span>
</span><span id="__span-2-777"><a id="__codelineno-2-777" name="__codelineno-2-777" href="#__codelineno-2-777"></a>
</span><span id="__span-2-778"><a id="__codelineno-2-778" name="__codelineno-2-778" href="#__codelineno-2-778"></a>    <span class="n">verification</span> <span class="o">=</span> <span class="n">repro_checker</span><span class="o">.</span><span class="n">verify_reproducibility</span><span class="p">(</span><span class="s1">&#39;BIAS_EXPERIMENT_001&#39;</span><span class="p">,</span> <span class="n">reproduction_results</span><span class="p">)</span>
</span><span id="__span-2-779"><a id="__codelineno-2-779" name="__codelineno-2-779" href="#__codelineno-2-779"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Verification status: </span><span class="si">{</span><span class="n">verification</span><span class="p">[</span><span class="s1">&#39;overall_status&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-2-780"><a id="__codelineno-2-780" name="__codelineno-2-780" href="#__codelineno-2-780"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Recommendations: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">verification</span><span class="p">[</span><span class="s1">&#39;recommendations&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2"> items&quot;</span><span class="p">)</span>
</span><span id="__span-2-781"><a id="__codelineno-2-781" name="__codelineno-2-781" href="#__codelineno-2-781"></a>
</span><span id="__span-2-782"><a id="__codelineno-2-782" name="__codelineno-2-782" href="#__codelineno-2-782"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-2-783"><a id="__codelineno-2-783" name="__codelineno-2-783" href="#__codelineno-2-783"></a>    <span class="n">demonstrate_transparency_accountability_tools</span><span class="p">()</span>
</span></code></pre></div>
<h2 id="practice-tasks">Practice Tasks<a class="headerlink" href="#practice-tasks" title="Permanent link">&para;</a></h2>
<h3 id="task-1-bias-source-analysis">Task 1: Bias Source Analysis<a class="headerlink" href="#task-1-bias-source-analysis" title="Permanent link">&para;</a></h3>
<p>Using the <code>BiasSourceAnalyzer</code> <span class="glossary-term" data-glossary-category="OOP" data-glossary-definition="A blueprint or template for creating objects that defines attributes and methods common to all objects of that type." data-glossary-term="Class">class</span>, analyze a dataset of your choice for potential sampling, historical, labeler, and population drift biases. Create a comprehensive bias assessment report.</p>
<h3 id="task-2-missing-groups-investigation">Task 2: Missing Groups Investigation<a class="headerlink" href="#task-2-missing-groups-investigation" title="Permanent link">&para;</a></h3>
<p>Implement the missing groups detection <span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A pre-built structure providing a foundation and tools for developing software applications more efficiently." data-glossary-term="Framework">framework</span> on a real-world dataset. Set appropriate population benchmarks and develop a targeted sampling strategy to address identified gaps.</p>
<h3 id="task-3-fairness-aware-model-development">Task 3: Fairness-Aware Model Development<a class="headerlink" href="#task-3-fairness-aware-model-development" title="Permanent link">&para;</a></h3>
<p>Train two versions of a classification model: one standard version and one using bias mitigation techniques from the <span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A pre-built structure providing a foundation and tools for developing software applications more efficiently." data-glossary-term="Framework">framework</span>. Compare their fairness metrics and overall performance.</p>
<h3 id="task-4-model-card-creation">Task 4: Model Card Creation<a class="headerlink" href="#task-4-model-card-creation" title="Permanent link">&para;</a></h3>
<p>Create a comprehensive model card for an ML system you&rsquo;ve developed, including all bias analysis results, mitigation strategies, and ethical considerations.</p>
<h3 id="task-5-reproducibility-package">Task 5: Reproducibility Package<a class="headerlink" href="#task-5-reproducibility-package" title="Permanent link">&para;</a></h3>
<p>Develop a complete reproducibility package for a bias assessment experiment, including all code, data descriptions, environment specifications, and verification <span class="glossary-term" data-glossary-category="Programming Fundamentals" data-glossary-definition="A reusable block of code that performs a specific task but does not return a value, similar to a void function." data-glossary-term="Procedure">procedures</span>.</p>
<h2 id="key-takeaways">Key Takeaways<a class="headerlink" href="#key-takeaways" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>Systematic Bias Detection</strong>: Bias in ML systems requires systematic detection across multiple dimensions including sampling, historical patterns, labeling processes, and population changes.</p>
</li>
<li>
<p><strong>Multi-faceted Mitigation</strong>: Effective bias mitigation requires combining diverse data collection, reweighting techniques, fairness-aware metrics, and continuous monitoring.</p>
</li>
<li>
<p><strong>Transparency is Essential</strong>: Model cards, comprehensive <span class="glossary-term" data-glossary-category="Programming Fundamentals" data-glossary-definition="Written text or illustrations that accompany software, explaining how it works and how to use it, including comments, docstrings, and user guides." data-glossary-term="Documentation">documentation</span>, and reproducibility packages are crucial for accountability and trust in ML systems.</p>
</li>
<li>
<p><strong>Continuous Monitoring</strong>: Bias assessment is not a one-time activity but requires ongoing monitoring and adjustment as data and populations evolve.</p>
</li>
<li>
<p><strong>Stakeholder Involvement</strong>: Effective bias mitigation requires involvement from diverse stakeholders including affected communities, domain experts, and ethicists.</p>
</li>
</ol>
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h2>
<p>This section provided comprehensive <span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A pre-built structure providing a foundation and tools for developing software applications more efficiently." data-glossary-term="Framework">frameworks</span> for investigating and mitigating bias in ML and <span class="glossary-term" data-glossary-category="Automation" data-glossary-definition="The simulation of human intelligence processes by computer systems, including learning, reasoning, and self-correction." data-glossary-full-form="Artificial Intelligence" data-glossary-term="AI">AI</span> systems. We covered:</p>
<ul>
<li>
<p><strong>Sources of Bias Analysis</strong>: Systematic detection of sampling bias, historical bias, labeler bias, and population drift</p>
</li>
<li>
<p><strong>Practical Investigation Tools</strong>: Dataset provenance analysis, missing groups detection, and measurement bias assessment  </p>
</li>
<li>
<p><strong>Mitigation Strategies</strong>: Diverse data collection, reweighting techniques, and fairness-aware metrics</p>
</li>
<li>
<p><strong>Transparency and Accountability</strong>: Model cards, <span class="glossary-term" data-glossary-category="Programming Fundamentals" data-glossary-definition="Written text or illustrations that accompany software, explaining how it works and how to use it, including comments, docstrings, and user guides." data-glossary-term="Documentation">documentation</span> <span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A pre-built structure providing a foundation and tools for developing software applications more efficiently." data-glossary-term="Framework">frameworks</span>, and reproducibility checks</p>
</li>
</ul>
<p>The <span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A pre-built structure providing a foundation and tools for developing software applications more efficiently." data-glossary-term="Framework">frameworks</span> and tools presented enable practitioners to systematically identify, analyze, and address bias throughout the ML development lifecycle, ensuring more fair and reliable <span class="glossary-term" data-glossary-category="Automation" data-glossary-definition="The simulation of human intelligence processes by computer systems, including learning, reasoning, and self-correction." data-glossary-full-form="Artificial Intelligence" data-glossary-term="AI">AI</span> systems.</p>
<hr />
<p><em>Next: Continue to quiz assessment for comprehensive evaluation of bias investigation concepts.</em></p>
<p>Now let me complete the section with mitigation strategies and transparency tools.</p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="October 18, 2025 02:48:38 UTC">October 18, 2025</span>
  </span>

    
    
    
    
  </aside>


  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback! Help us improve this page by creating an <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/issues/new/choose" target="_blank" rel="noopener">issue</a> on github.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        

<!-- Footer -->
<footer class="md-footer">
  
    <!-- Custom footer with left/right layout -->
    <div class="md-footer__inner md-grid">
      <!-- Left side: Copyright and cookie settings -->
      <div class="md-footer__left">
        <div class="md-footer__copyright">
          
            Copyright &copy; 2025 Eatham532 â€“ <a href="#__consent">Change cookie settings</a>

          
        </div>
      </div>

      <!-- Right side: Page name and BETA -->
      <div class="md-footer__right">
        <div class="md-footer__page-info">
          <span class="md-footer__page-title">Content</span>
          
            <span class="md-footer__beta-badge">BETA</span>
          
        </div>
      </div>
    </div>
  
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            



<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of the textbook. With your consent, you're helping us to make software engineering education better for everyone.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="analytics" checked>
      <span class="task-list-indicator"></span>
      Google Analytics
    </label>
  </li>

      
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tabs", "navigation.top", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.prune", "search.highlight", "search.suggest", "content.code.annotate", "content.code.copy", "content.code.select", "content.tabs.link", "content.action.edit", "content.action.view", "toc.follow"], "search": "../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../../assets/diagram-modal.js"></script>
      
        <script src="../../../../assets/quiz.js"></script>
      
        <script src="../../../../assets/ide-utils.js"></script>
      
        <script src="../../../../assets/code-blocks.js"></script>
      
        <script src="../../../../assets/glossary.js"></script>
      
    
  </body>
</html>