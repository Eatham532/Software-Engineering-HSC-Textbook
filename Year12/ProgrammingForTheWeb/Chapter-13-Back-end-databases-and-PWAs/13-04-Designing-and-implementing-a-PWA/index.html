
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Comprehensive educational resource for NSW HSC Software Engineering syllabus">
      
      
      
        <link rel="canonical" href="https://eatham532.github.io/Software-Engineering-HSC-Textbook/Year12/ProgrammingForTheWeb/Chapter-13-Back-end-databases-and-PWAs/13-04-Designing-and-implementing-a-PWA/">
      
      
        <link rel="prev" href="../13-03-Performance-and-page-load-management/quiz/">
      
      
        <link rel="next" href="quiz/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>13.4 Designing and implementing a PWA - Software Engineering Textbook HSC</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/diagram-modal.css">
    
      <link rel="stylesheet" href="../../../../assets/quiz.css">
    
      <link rel="stylesheet" href="../../../../assets/common.css">
    
      <link rel="stylesheet" href="../../../../assets/diagram-fix.css">
    
      <link rel="stylesheet" href="../../../../assets/cross-reference.css">
    
      <link rel="stylesheet" href="../../../../assets/site-banner.css">
    
      <link rel="stylesheet" href="../../../../assets/code-runner.css">
    
      <link rel="stylesheet" href="../../../../assets/code-editor.css">
    
      <link rel="stylesheet" href="../../../../assets/glossary.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-58275RL1P9"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-58275RL1P9",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-58275RL1P9",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#134-designing-and-implementing-a-pwa" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
  
  
    
    
    
    <div class="site-banner site-banner--warning" data-banner data-banner-version="1" role="status" aria-live="polite">
      <div class="site-banner__inner">
        <span class="site-banner__icon" aria-hidden="true">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            
              <path d="M12 9v4"/><path d="M12 17h.01"/><path d="M10.29 3.86 1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0Z"/>
            
          </svg>
        </span>
        <p class="site-banner__text">
          This textbook is in <strong>beta</strong> – content is actively being refined.
          
            <a class="site-banner__link" href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/issues/new/choose" target="_blank" rel="noopener">Report issues or suggestions</a>
          
        </p>
        <button type="button" class="site-banner__close" aria-label="Dismiss banner" title="Dismiss" data-banner-dismiss>&times;</button>
      </div>
    </div>
    <script>
      (function(){
        var banner=document.querySelector('[data-banner]');
        if(!banner) return;
        var version=banner.getAttribute('data-banner-version')||'1';
        var KEY='site_banner_dismissed_v'+version;
        try{ if(localStorage.getItem(KEY)){ banner.remove(); return;} }catch(e){}
        var btn=banner.querySelector('[data-banner-dismiss]');
        if(btn){ btn.addEventListener('click',function(){
          banner.classList.add('is-hiding');
          setTimeout(function(){ banner && banner.remove(); },200);
          try{ localStorage.setItem(KEY,'1'); }catch(e){}
        }); }
      })();
    </script>
  
  
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Software Engineering Textbook HSC" class="md-header__button md-logo" aria-label="Software Engineering Textbook HSC" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Software Engineering Textbook HSC
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              13.4 Designing and implementing a PWA
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Eatham532/Software-Engineering-HSC-Textbook
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    

    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../Year11/ProgrammingFundamentals/" class="md-tabs__link">
          
  
  
  Year 11

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
  Year 12

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../code-editor/" class="md-tabs__link">
        
  
  
    
  
  Code Editor

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../glossary/" class="md-tabs__link">
        
  
  
    
  
  Glossary

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Software Engineering Textbook HSC" class="md-nav__button md-logo" aria-label="Software Engineering Textbook HSC" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Software Engineering Textbook HSC
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Eatham532/Software-Engineering-HSC-Textbook
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../../../Year11/ProgrammingFundamentals/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Year 11
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Year 12
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Year 12
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Programming For The Web
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Programming For The Web
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../Chapter-11-Web-foundations-and-data-transmission/11-01-Explore-the-applications-of-web-programming/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 11 — Web foundations and data transmission
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../Chapter-12-Designing-web-applications/12-01-The-role-of-the-W3C-and-web-standards/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 12 — Designing web applications
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_4" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1_4" id="__nav_3_1_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Chapter 13 — Back-end, databases, and PWAs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1_4">
            <span class="md-nav__icon md-icon"></span>
            Chapter 13 — Back-end, databases, and PWAs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../13-01-Server-side-Python-with-a-microframework-and-the-back-end-request-flow/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    13.1 Server-side Python with a microframework and the back-end request flow
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../13-02-Databases-SQL-common-queries-and-ORM-comparison/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    13.2 Databases: SQL, common queries and ORM comparison
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../13-03-Performance-and-page-load-management/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    13.3 Performance and page-load management
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_4_4" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1_4_4" id="__nav_3_1_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    13.4 Designing and implementing a PWA
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_4_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1_4_4">
            <span class="md-nav__icon md-icon"></span>
            13.4 Designing and implementing a PWA
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Content
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Content
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-it-matters" class="md-nav__link">
    <span class="md-ellipsis">
      Why it matters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Concepts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#service-workers-and-offline-functionality" class="md-nav__link">
    <span class="md-ellipsis">
      Service Workers and offline functionality
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installable-app-characteristics" class="md-nav__link">
    <span class="md-ellipsis">
      Installable app characteristics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#syncing-strategies-and-background-sync" class="md-nav__link">
    <span class="md-ellipsis">
      Syncing strategies and background sync
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#try-it" class="md-nav__link">
    <span class="md-ellipsis">
      Try it
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="quiz/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quiz
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../SecureSoftwareArchitecture/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Secure Software Architecture
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../SoftwareAutomation/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Software Automation
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../SoftwareEngineeringProject/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Software Engineering Project
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../code-editor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code Editor
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-it-matters" class="md-nav__link">
    <span class="md-ellipsis">
      Why it matters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Concepts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#service-workers-and-offline-functionality" class="md-nav__link">
    <span class="md-ellipsis">
      Service Workers and offline functionality
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installable-app-characteristics" class="md-nav__link">
    <span class="md-ellipsis">
      Installable app characteristics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#syncing-strategies-and-background-sync" class="md-nav__link">
    <span class="md-ellipsis">
      Syncing strategies and background sync
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#try-it" class="md-nav__link">
    <span class="md-ellipsis">
      Try it
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/edit/main/docs/Year12/ProgrammingForTheWeb/Chapter-13-Back-end-databases-and-PWAs/13-04-Designing-and-implementing-a-PWA/index.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/raw/main/docs/Year12/ProgrammingForTheWeb/Chapter-13-Back-end-databases-and-PWAs/13-04-Designing-and-implementing-a-PWA/index.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="134-designing-and-implementing-a-pwa">13.4 Designing and implementing a <span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A type of web application that uses modern web capabilities to deliver an app-like experience, working offline and installable on devices." data-glossary-full-form="Progressive Web Application" data-glossary-term="PWA">PWA</span><a class="headerlink" href="#134-designing-and-implementing-a-pwa" title="Permanent link">&para;</a></h1>
<h2 id="why-it-matters">Why it matters<a class="headerlink" href="#why-it-matters" title="Permanent link">&para;</a></h2>
<p>Progressive Web Apps (<span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A type of web application that uses modern web capabilities to deliver an app-like experience, working offline and installable on devices." data-glossary-full-form="Progressive Web Application" data-glossary-term="PWA">PWAs</span>) bridge the gap between web and native mobile applications, providing users with app-like experiences through web browsers. <span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A type of web application that uses modern web capabilities to deliver an app-like experience, working offline and installable on devices." data-glossary-full-form="Progressive Web Application" data-glossary-term="PWA">PWAs</span> offer offline functionality, push notifications, and installation capabilities while maintaining the reach and accessibility of web applications. Understanding <span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A type of web application that uses modern web capabilities to deliver an app-like experience, working offline and installable on devices." data-glossary-full-form="Progressive Web Application" data-glossary-term="PWA">PWA</span> development enables developers to create engaging, performant applications that work across all devices and network conditions, making them essential for modern web development.</p>
<h2 id="concepts">Concepts<a class="headerlink" href="#concepts" title="Permanent link">&para;</a></h2>
<h3 id="service-workers-and-offline-functionality"><span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A script that runs in the background of a web browser, enabling features like offline functionality and push notifications." data-glossary-term="Service Worker">Service Workers</span> and offline functionality<a class="headerlink" href="#service-workers-and-offline-functionality" title="Permanent link">&para;</a></h3>
<p><span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A script that runs in the background of a web browser, enabling features like offline functionality and push notifications." data-glossary-term="Service Worker">Service Workers</span> act as a proxy between web applications and the network, enabling offline functionality and background processing:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># Flask backend for PWA with service worker registration</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">jsonify</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">make_response</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sqlite3</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="c1"># Database setup for offline sync</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="k">def</span><span class="w"> </span><span class="nf">init_database</span><span class="p">():</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize SQLite database for PWA data&quot;&quot;&quot;</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;pwa_data.db&#39;</span><span class="p">)</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    <span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    <span class="c1"># Create tables for offline sync</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="s1">        CREATE TABLE IF NOT EXISTS sync_queue (</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="s1">            id INTEGER PRIMARY KEY AUTOINCREMENT,</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="s1">            action TEXT NOT NULL,</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="s1">            resource TEXT NOT NULL,</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="s1">            data TEXT,</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="s1">            timestamp DATETIME DEFAULT CURRENT_TIMESTAMP,</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="s1">            synced BOOLEAN DEFAULT FALSE</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="s1">        )</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="s1">    &#39;&#39;&#39;</span><span class="p">)</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="s1">        CREATE TABLE IF NOT EXISTS app_data (</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="s1">            id INTEGER PRIMARY KEY AUTOINCREMENT,</span>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="s1">            key TEXT UNIQUE NOT NULL,</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="s1">            value TEXT,</span>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="s1">            last_modified DATETIME DEFAULT CURRENT_TIMESTAMP</span>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="s1">        )</span>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="s1">    &#39;&#39;&#39;</span><span class="p">)</span>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>    <span class="c1"># Insert sample data</span>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="s1">        INSERT OR REPLACE INTO app_data (key, value) VALUES </span>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a><span class="s1">        (&#39;app_version&#39;, &#39;1.0.0&#39;),</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a><span class="s1">        (&#39;last_sync&#39;, ?),</span>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a><span class="s1">        (&#39;user_preferences&#39;, &#39;{&quot;theme&quot;: &quot;light&quot;, &quot;notifications&quot;: true}&#39;)</span>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a><span class="s1">    &#39;&#39;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),))</span>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a>    <span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a>    <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a><span class="n">init_database</span><span class="p">()</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a><span class="k">class</span><span class="w"> </span><span class="nc">PWAManager</span><span class="p">:</span>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Manage PWA functionality and offline capabilities&quot;&quot;&quot;</span>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">manifest_data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a>            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Python Web App&quot;</span><span class="p">,</span>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a>            <span class="s2">&quot;short_name&quot;</span><span class="p">:</span> <span class="s2">&quot;PyWebApp&quot;</span><span class="p">,</span>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a>            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;A Progressive Web App built with Python&quot;</span><span class="p">,</span>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a>            <span class="s2">&quot;start_url&quot;</span><span class="p">:</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a>            <span class="s2">&quot;display&quot;</span><span class="p">:</span> <span class="s2">&quot;standalone&quot;</span><span class="p">,</span>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62" href="#__codelineno-0-62"></a>            <span class="s2">&quot;theme_color&quot;</span><span class="p">:</span> <span class="s2">&quot;#000000&quot;</span><span class="p">,</span>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63" href="#__codelineno-0-63"></a>            <span class="s2">&quot;background_color&quot;</span><span class="p">:</span> <span class="s2">&quot;#ffffff&quot;</span><span class="p">,</span>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64" href="#__codelineno-0-64"></a>            <span class="s2">&quot;orientation&quot;</span><span class="p">:</span> <span class="s2">&quot;portrait-primary&quot;</span><span class="p">,</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65" href="#__codelineno-0-65"></a>            <span class="s2">&quot;icons&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66" href="#__codelineno-0-66"></a>                <span class="p">{</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67" href="#__codelineno-0-67"></a>                    <span class="s2">&quot;src&quot;</span><span class="p">:</span> <span class="s2">&quot;/static/icons/icon-72x72.png&quot;</span><span class="p">,</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68" href="#__codelineno-0-68"></a>                    <span class="s2">&quot;sizes&quot;</span><span class="p">:</span> <span class="s2">&quot;72x72&quot;</span><span class="p">,</span>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69" href="#__codelineno-0-69"></a>                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;image/png&quot;</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70" href="#__codelineno-0-70"></a>                <span class="p">},</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71" href="#__codelineno-0-71"></a>                <span class="p">{</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72" href="#__codelineno-0-72"></a>                    <span class="s2">&quot;src&quot;</span><span class="p">:</span> <span class="s2">&quot;/static/icons/icon-96x96.png&quot;</span><span class="p">,</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73" href="#__codelineno-0-73"></a>                    <span class="s2">&quot;sizes&quot;</span><span class="p">:</span> <span class="s2">&quot;96x96&quot;</span><span class="p">,</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74" href="#__codelineno-0-74"></a>                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;image/png&quot;</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75" href="#__codelineno-0-75"></a>                <span class="p">},</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76" href="#__codelineno-0-76"></a>                <span class="p">{</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77" href="#__codelineno-0-77"></a>                    <span class="s2">&quot;src&quot;</span><span class="p">:</span> <span class="s2">&quot;/static/icons/icon-128x128.png&quot;</span><span class="p">,</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78" href="#__codelineno-0-78"></a>                    <span class="s2">&quot;sizes&quot;</span><span class="p">:</span> <span class="s2">&quot;128x128&quot;</span><span class="p">,</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79" href="#__codelineno-0-79"></a>                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;image/png&quot;</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80" href="#__codelineno-0-80"></a>                <span class="p">},</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81" href="#__codelineno-0-81"></a>                <span class="p">{</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82" href="#__codelineno-0-82"></a>                    <span class="s2">&quot;src&quot;</span><span class="p">:</span> <span class="s2">&quot;/static/icons/icon-144x144.png&quot;</span><span class="p">,</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83" href="#__codelineno-0-83"></a>                    <span class="s2">&quot;sizes&quot;</span><span class="p">:</span> <span class="s2">&quot;144x144&quot;</span><span class="p">,</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84" href="#__codelineno-0-84"></a>                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;image/png&quot;</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85" href="#__codelineno-0-85"></a>                <span class="p">},</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86" href="#__codelineno-0-86"></a>                <span class="p">{</span>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87" href="#__codelineno-0-87"></a>                    <span class="s2">&quot;src&quot;</span><span class="p">:</span> <span class="s2">&quot;/static/icons/icon-152x152.png&quot;</span><span class="p">,</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88" href="#__codelineno-0-88"></a>                    <span class="s2">&quot;sizes&quot;</span><span class="p">:</span> <span class="s2">&quot;152x152&quot;</span><span class="p">,</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89" href="#__codelineno-0-89"></a>                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;image/png&quot;</span>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90" href="#__codelineno-0-90"></a>                <span class="p">},</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91" href="#__codelineno-0-91"></a>                <span class="p">{</span>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92" href="#__codelineno-0-92"></a>                    <span class="s2">&quot;src&quot;</span><span class="p">:</span> <span class="s2">&quot;/static/icons/icon-192x192.png&quot;</span><span class="p">,</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93" href="#__codelineno-0-93"></a>                    <span class="s2">&quot;sizes&quot;</span><span class="p">:</span> <span class="s2">&quot;192x192&quot;</span><span class="p">,</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94" href="#__codelineno-0-94"></a>                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;image/png&quot;</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95" href="#__codelineno-0-95"></a>                <span class="p">},</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96" href="#__codelineno-0-96"></a>                <span class="p">{</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97" href="#__codelineno-0-97"></a>                    <span class="s2">&quot;src&quot;</span><span class="p">:</span> <span class="s2">&quot;/static/icons/icon-384x384.png&quot;</span><span class="p">,</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98" href="#__codelineno-0-98"></a>                    <span class="s2">&quot;sizes&quot;</span><span class="p">:</span> <span class="s2">&quot;384x384&quot;</span><span class="p">,</span>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99" href="#__codelineno-0-99"></a>                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;image/png&quot;</span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100" href="#__codelineno-0-100"></a>                <span class="p">},</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101" href="#__codelineno-0-101"></a>                <span class="p">{</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102" href="#__codelineno-0-102"></a>                    <span class="s2">&quot;src&quot;</span><span class="p">:</span> <span class="s2">&quot;/static/icons/icon-512x512.png&quot;</span><span class="p">,</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103" href="#__codelineno-0-103"></a>                    <span class="s2">&quot;sizes&quot;</span><span class="p">:</span> <span class="s2">&quot;512x512&quot;</span><span class="p">,</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104" href="#__codelineno-0-104"></a>                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;image/png&quot;</span>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105" href="#__codelineno-0-105"></a>                <span class="p">}</span>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106" href="#__codelineno-0-106"></a>            <span class="p">]</span>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107" href="#__codelineno-0-107"></a>        <span class="p">}</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108" href="#__codelineno-0-108"></a>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109" href="#__codelineno-0-109"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate_service_worker</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110" href="#__codelineno-0-110"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate service worker JavaScript code&quot;&quot;&quot;</span>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111" href="#__codelineno-0-111"></a>        <span class="n">service_worker_code</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112" href="#__codelineno-0-112"></a><span class="s1">// Service Worker for PWA functionality</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113" href="#__codelineno-0-113"></a><span class="s1">const CACHE_NAME = &#39;pwa-cache-v1&#39;;</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114" href="#__codelineno-0-114"></a><span class="s1">const API_CACHE_NAME = &#39;pwa-api-cache-v1&#39;;</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115" href="#__codelineno-0-115"></a>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116" href="#__codelineno-0-116"></a><span class="s1">// Resources to cache for offline use</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117" href="#__codelineno-0-117"></a><span class="s1">const STATIC_CACHE_URLS = [</span>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118" href="#__codelineno-0-118"></a><span class="s1">    &#39;/&#39;,</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119" href="#__codelineno-0-119"></a><span class="s1">    &#39;/static/css/app.css&#39;,</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120" href="#__codelineno-0-120"></a><span class="s1">    &#39;/static/js/app.js&#39;,</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121" href="#__codelineno-0-121"></a><span class="s1">    &#39;/static/icons/icon-192x192.png&#39;,</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122" href="#__codelineno-0-122"></a><span class="s1">    &#39;/offline.html&#39;</span>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123" href="#__codelineno-0-123"></a><span class="s1">];</span>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124" href="#__codelineno-0-124"></a>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125" href="#__codelineno-0-125"></a><span class="s1">// API endpoints to cache</span>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126" href="#__codelineno-0-126"></a><span class="s1">const API_CACHE_URLS = [</span>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127" href="#__codelineno-0-127"></a><span class="s1">    &#39;/api/data&#39;,</span>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128" href="#__codelineno-0-128"></a><span class="s1">    &#39;/api/sync&#39;</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129" href="#__codelineno-0-129"></a><span class="s1">];</span>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130" href="#__codelineno-0-130"></a>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131" href="#__codelineno-0-131"></a><span class="s1">// Install event - cache essential resources</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132" href="#__codelineno-0-132"></a><span class="s1">self.addEventListener(&#39;install&#39;, event =&gt; {</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133" href="#__codelineno-0-133"></a><span class="s1">    console.log(&#39;Service Worker installing...&#39;);</span>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134" href="#__codelineno-0-134"></a><span class="s1">    event.waitUntil(</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135" href="#__codelineno-0-135"></a><span class="s1">        Promise.all([</span>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136" href="#__codelineno-0-136"></a><span class="s1">            caches.open(CACHE_NAME).then(cache =&gt; {</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137" href="#__codelineno-0-137"></a><span class="s1">                console.log(&#39;Caching static resources&#39;);</span>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138" href="#__codelineno-0-138"></a><span class="s1">                return cache.addAll(STATIC_CACHE_URLS);</span>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139" href="#__codelineno-0-139"></a><span class="s1">            }),</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140" href="#__codelineno-0-140"></a><span class="s1">            caches.open(API_CACHE_NAME).then(cache =&gt; {</span>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141" href="#__codelineno-0-141"></a><span class="s1">                console.log(&#39;Pre-caching API endpoints&#39;);</span>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142" href="#__codelineno-0-142"></a><span class="s1">                return Promise.all(</span>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143" href="#__codelineno-0-143"></a><span class="s1">                    API_CACHE_URLS.map(url =&gt; </span>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144" href="#__codelineno-0-144"></a><span class="s1">                        fetch(url).then(response =&gt; {</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145" href="#__codelineno-0-145"></a><span class="s1">                            if (response.ok) {</span>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146" href="#__codelineno-0-146"></a><span class="s1">                                return cache.put(url, response);</span>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147" href="#__codelineno-0-147"></a><span class="s1">                            }</span>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148" href="#__codelineno-0-148"></a><span class="s1">                        }).catch(err =&gt; console.log(&#39;Pre-cache failed for&#39;, url))</span>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149" href="#__codelineno-0-149"></a><span class="s1">                    )</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150" href="#__codelineno-0-150"></a><span class="s1">                );</span>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151" href="#__codelineno-0-151"></a><span class="s1">            })</span>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152" href="#__codelineno-0-152"></a><span class="s1">        ])</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153" href="#__codelineno-0-153"></a><span class="s1">    );</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154" href="#__codelineno-0-154"></a><span class="s1">    self.skipWaiting();</span>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155" href="#__codelineno-0-155"></a><span class="s1">});</span>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156" href="#__codelineno-0-156"></a>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157" href="#__codelineno-0-157"></a><span class="s1">// Activate event - clean up old caches</span>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158" href="#__codelineno-0-158"></a><span class="s1">self.addEventListener(&#39;activate&#39;, event =&gt; {</span>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159" href="#__codelineno-0-159"></a><span class="s1">    console.log(&#39;Service Worker activating...&#39;);</span>
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160" href="#__codelineno-0-160"></a><span class="s1">    event.waitUntil(</span>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161" href="#__codelineno-0-161"></a><span class="s1">        caches.keys().then(cacheNames =&gt; {</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162" href="#__codelineno-0-162"></a><span class="s1">            return Promise.all(</span>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163" href="#__codelineno-0-163"></a><span class="s1">                cacheNames.map(cacheName =&gt; {</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164" href="#__codelineno-0-164"></a><span class="s1">                    if (cacheName !== CACHE_NAME &amp;&amp; cacheName !== API_CACHE_NAME) {</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165" href="#__codelineno-0-165"></a><span class="s1">                        console.log(&#39;Deleting old cache:&#39;, cacheName);</span>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166" href="#__codelineno-0-166"></a><span class="s1">                        return caches.delete(cacheName);</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167" href="#__codelineno-0-167"></a><span class="s1">                    }</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168" href="#__codelineno-0-168"></a><span class="s1">                })</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169" href="#__codelineno-0-169"></a><span class="s1">            );</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170" href="#__codelineno-0-170"></a><span class="s1">        })</span>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171" href="#__codelineno-0-171"></a><span class="s1">    );</span>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172" href="#__codelineno-0-172"></a><span class="s1">    self.clients.claim();</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173" href="#__codelineno-0-173"></a><span class="s1">});</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174" href="#__codelineno-0-174"></a>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175" href="#__codelineno-0-175"></a><span class="s1">// Fetch event - implement caching strategies</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176" href="#__codelineno-0-176"></a><span class="s1">self.addEventListener(&#39;fetch&#39;, event =&gt; {</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177" href="#__codelineno-0-177"></a><span class="s1">    const { request } = event;</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178" href="#__codelineno-0-178"></a><span class="s1">    const url = new URL(request.url);</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179" href="#__codelineno-0-179"></a>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180" href="#__codelineno-0-180"></a><span class="s1">    // Handle API requests with network-first strategy</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181" href="#__codelineno-0-181"></a><span class="s1">    if (url.pathname.startsWith(&#39;/api/&#39;)) {</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182" href="#__codelineno-0-182"></a><span class="s1">        event.respondWith(</span>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183" href="#__codelineno-0-183"></a><span class="s1">            fetch(request)</span>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184" href="#__codelineno-0-184"></a><span class="s1">                .then(response =&gt; {</span>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185" href="#__codelineno-0-185"></a><span class="s1">                    // Clone response for caching</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186" href="#__codelineno-0-186"></a><span class="s1">                    const responseClone = response.clone();</span>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187" href="#__codelineno-0-187"></a>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188" href="#__codelineno-0-188"></a><span class="s1">                    // Cache successful responses</span>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189" href="#__codelineno-0-189"></a><span class="s1">                    if (response.ok) {</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190" href="#__codelineno-0-190"></a><span class="s1">                        caches.open(API_CACHE_NAME).then(cache =&gt; {</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191" href="#__codelineno-0-191"></a><span class="s1">                            cache.put(request, responseClone);</span>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192" href="#__codelineno-0-192"></a><span class="s1">                        });</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193" href="#__codelineno-0-193"></a><span class="s1">                    }</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194" href="#__codelineno-0-194"></a>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195" href="#__codelineno-0-195"></a><span class="s1">                    return response;</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196" href="#__codelineno-0-196"></a><span class="s1">                })</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197" href="#__codelineno-0-197"></a><span class="s1">                .catch(() =&gt; {</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198" href="#__codelineno-0-198"></a><span class="s1">                    // Fallback to cache when network fails</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199" href="#__codelineno-0-199"></a><span class="s1">                    return caches.match(request).then(cachedResponse =&gt; {</span>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200" href="#__codelineno-0-200"></a><span class="s1">                        if (cachedResponse) {</span>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201" href="#__codelineno-0-201"></a><span class="s1">                            return cachedResponse;</span>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202" href="#__codelineno-0-202"></a><span class="s1">                        }</span>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203" href="#__codelineno-0-203"></a>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204" href="#__codelineno-0-204"></a><span class="s1">                        // Return offline message for API calls</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205" href="#__codelineno-0-205"></a><span class="s1">                        return new Response(</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206" href="#__codelineno-0-206"></a><span class="s1">                            JSON.stringify({ </span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207" href="#__codelineno-0-207"></a><span class="s1">                                error: &#39;Offline&#39;, </span>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208" href="#__codelineno-0-208"></a><span class="s1">                                message: &#39;Data not available offline&#39; </span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209" href="#__codelineno-0-209"></a><span class="s1">                            }),</span>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210" href="#__codelineno-0-210"></a><span class="s1">                            { </span>
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211" href="#__codelineno-0-211"></a><span class="s1">                                status: 503,</span>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212" href="#__codelineno-0-212"></a><span class="s1">                                headers: { &#39;Content-Type&#39;: &#39;application/json&#39; }</span>
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213" href="#__codelineno-0-213"></a><span class="s1">                            }</span>
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214" href="#__codelineno-0-214"></a><span class="s1">                        );</span>
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215" href="#__codelineno-0-215"></a><span class="s1">                    });</span>
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216" href="#__codelineno-0-216"></a><span class="s1">                })</span>
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217" href="#__codelineno-0-217"></a><span class="s1">        );</span>
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218" href="#__codelineno-0-218"></a><span class="s1">    }</span>
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219" href="#__codelineno-0-219"></a><span class="s1">    // Handle static resources with cache-first strategy</span>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220" href="#__codelineno-0-220"></a><span class="s1">    else {</span>
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221" href="#__codelineno-0-221"></a><span class="s1">        event.respondWith(</span>
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222" href="#__codelineno-0-222"></a><span class="s1">            caches.match(request).then(cachedResponse =&gt; {</span>
</span><span id="__span-0-223"><a id="__codelineno-0-223" name="__codelineno-0-223" href="#__codelineno-0-223"></a><span class="s1">                if (cachedResponse) {</span>
</span><span id="__span-0-224"><a id="__codelineno-0-224" name="__codelineno-0-224" href="#__codelineno-0-224"></a><span class="s1">                    return cachedResponse;</span>
</span><span id="__span-0-225"><a id="__codelineno-0-225" name="__codelineno-0-225" href="#__codelineno-0-225"></a><span class="s1">                }</span>
</span><span id="__span-0-226"><a id="__codelineno-0-226" name="__codelineno-0-226" href="#__codelineno-0-226"></a>
</span><span id="__span-0-227"><a id="__codelineno-0-227" name="__codelineno-0-227" href="#__codelineno-0-227"></a><span class="s1">                return fetch(request).then(response =&gt; {</span>
</span><span id="__span-0-228"><a id="__codelineno-0-228" name="__codelineno-0-228" href="#__codelineno-0-228"></a><span class="s1">                    // Cache successful responses</span>
</span><span id="__span-0-229"><a id="__codelineno-0-229" name="__codelineno-0-229" href="#__codelineno-0-229"></a><span class="s1">                    if (response.ok &amp;&amp; request.method === &#39;GET&#39;) {</span>
</span><span id="__span-0-230"><a id="__codelineno-0-230" name="__codelineno-0-230" href="#__codelineno-0-230"></a><span class="s1">                        const responseClone = response.clone();</span>
</span><span id="__span-0-231"><a id="__codelineno-0-231" name="__codelineno-0-231" href="#__codelineno-0-231"></a><span class="s1">                        caches.open(CACHE_NAME).then(cache =&gt; {</span>
</span><span id="__span-0-232"><a id="__codelineno-0-232" name="__codelineno-0-232" href="#__codelineno-0-232"></a><span class="s1">                            cache.put(request, responseClone);</span>
</span><span id="__span-0-233"><a id="__codelineno-0-233" name="__codelineno-0-233" href="#__codelineno-0-233"></a><span class="s1">                        });</span>
</span><span id="__span-0-234"><a id="__codelineno-0-234" name="__codelineno-0-234" href="#__codelineno-0-234"></a><span class="s1">                    }</span>
</span><span id="__span-0-235"><a id="__codelineno-0-235" name="__codelineno-0-235" href="#__codelineno-0-235"></a>
</span><span id="__span-0-236"><a id="__codelineno-0-236" name="__codelineno-0-236" href="#__codelineno-0-236"></a><span class="s1">                    return response;</span>
</span><span id="__span-0-237"><a id="__codelineno-0-237" name="__codelineno-0-237" href="#__codelineno-0-237"></a><span class="s1">                }).catch(() =&gt; {</span>
</span><span id="__span-0-238"><a id="__codelineno-0-238" name="__codelineno-0-238" href="#__codelineno-0-238"></a><span class="s1">                    // Fallback to offline page for navigation requests</span>
</span><span id="__span-0-239"><a id="__codelineno-0-239" name="__codelineno-0-239" href="#__codelineno-0-239"></a><span class="s1">                    if (request.mode === &#39;navigate&#39;) {</span>
</span><span id="__span-0-240"><a id="__codelineno-0-240" name="__codelineno-0-240" href="#__codelineno-0-240"></a><span class="s1">                        return caches.match(&#39;/offline.html&#39;);</span>
</span><span id="__span-0-241"><a id="__codelineno-0-241" name="__codelineno-0-241" href="#__codelineno-0-241"></a><span class="s1">                    }</span>
</span><span id="__span-0-242"><a id="__codelineno-0-242" name="__codelineno-0-242" href="#__codelineno-0-242"></a>
</span><span id="__span-0-243"><a id="__codelineno-0-243" name="__codelineno-0-243" href="#__codelineno-0-243"></a><span class="s1">                    return new Response(&#39;Offline&#39;, { status: 503 });</span>
</span><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244" href="#__codelineno-0-244"></a><span class="s1">                });</span>
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245" href="#__codelineno-0-245"></a><span class="s1">            })</span>
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246" href="#__codelineno-0-246"></a><span class="s1">        );</span>
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247" href="#__codelineno-0-247"></a><span class="s1">    }</span>
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248" href="#__codelineno-0-248"></a><span class="s1">});</span>
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249" href="#__codelineno-0-249"></a>
</span><span id="__span-0-250"><a id="__codelineno-0-250" name="__codelineno-0-250" href="#__codelineno-0-250"></a><span class="s1">// Background sync for offline actions</span>
</span><span id="__span-0-251"><a id="__codelineno-0-251" name="__codelineno-0-251" href="#__codelineno-0-251"></a><span class="s1">self.addEventListener(&#39;sync&#39;, event =&gt; {</span>
</span><span id="__span-0-252"><a id="__codelineno-0-252" name="__codelineno-0-252" href="#__codelineno-0-252"></a><span class="s1">    console.log(&#39;Background sync triggered:&#39;, event.tag);</span>
</span><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253" href="#__codelineno-0-253"></a>
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254" href="#__codelineno-0-254"></a><span class="s1">    if (event.tag === &#39;background-sync&#39;) {</span>
</span><span id="__span-0-255"><a id="__codelineno-0-255" name="__codelineno-0-255" href="#__codelineno-0-255"></a><span class="s1">        event.waitUntil(syncOfflineActions());</span>
</span><span id="__span-0-256"><a id="__codelineno-0-256" name="__codelineno-0-256" href="#__codelineno-0-256"></a><span class="s1">    }</span>
</span><span id="__span-0-257"><a id="__codelineno-0-257" name="__codelineno-0-257" href="#__codelineno-0-257"></a><span class="s1">});</span>
</span><span id="__span-0-258"><a id="__codelineno-0-258" name="__codelineno-0-258" href="#__codelineno-0-258"></a>
</span><span id="__span-0-259"><a id="__codelineno-0-259" name="__codelineno-0-259" href="#__codelineno-0-259"></a><span class="s1">// Sync offline actions when back online</span>
</span><span id="__span-0-260"><a id="__codelineno-0-260" name="__codelineno-0-260" href="#__codelineno-0-260"></a><span class="s1">async function syncOfflineActions() {</span>
</span><span id="__span-0-261"><a id="__codelineno-0-261" name="__codelineno-0-261" href="#__codelineno-0-261"></a><span class="s1">    try {</span>
</span><span id="__span-0-262"><a id="__codelineno-0-262" name="__codelineno-0-262" href="#__codelineno-0-262"></a><span class="s1">        const response = await fetch(&#39;/api/sync/process&#39;);</span>
</span><span id="__span-0-263"><a id="__codelineno-0-263" name="__codelineno-0-263" href="#__codelineno-0-263"></a><span class="s1">        if (response.ok) {</span>
</span><span id="__span-0-264"><a id="__codelineno-0-264" name="__codelineno-0-264" href="#__codelineno-0-264"></a><span class="s1">            console.log(&#39;Offline actions synced successfully&#39;);</span>
</span><span id="__span-0-265"><a id="__codelineno-0-265" name="__codelineno-0-265" href="#__codelineno-0-265"></a><span class="s1">        }</span>
</span><span id="__span-0-266"><a id="__codelineno-0-266" name="__codelineno-0-266" href="#__codelineno-0-266"></a><span class="s1">    } catch (error) {</span>
</span><span id="__span-0-267"><a id="__codelineno-0-267" name="__codelineno-0-267" href="#__codelineno-0-267"></a><span class="s1">        console.error(&#39;Sync failed:&#39;, error);</span>
</span><span id="__span-0-268"><a id="__codelineno-0-268" name="__codelineno-0-268" href="#__codelineno-0-268"></a><span class="s1">        throw error; // Retry sync later</span>
</span><span id="__span-0-269"><a id="__codelineno-0-269" name="__codelineno-0-269" href="#__codelineno-0-269"></a><span class="s1">    }</span>
</span><span id="__span-0-270"><a id="__codelineno-0-270" name="__codelineno-0-270" href="#__codelineno-0-270"></a><span class="s1">}</span>
</span><span id="__span-0-271"><a id="__codelineno-0-271" name="__codelineno-0-271" href="#__codelineno-0-271"></a>
</span><span id="__span-0-272"><a id="__codelineno-0-272" name="__codelineno-0-272" href="#__codelineno-0-272"></a><span class="s1">// Push notification handling</span>
</span><span id="__span-0-273"><a id="__codelineno-0-273" name="__codelineno-0-273" href="#__codelineno-0-273"></a><span class="s1">self.addEventListener(&#39;push&#39;, event =&gt; {</span>
</span><span id="__span-0-274"><a id="__codelineno-0-274" name="__codelineno-0-274" href="#__codelineno-0-274"></a><span class="s1">    console.log(&#39;Push notification received&#39;);</span>
</span><span id="__span-0-275"><a id="__codelineno-0-275" name="__codelineno-0-275" href="#__codelineno-0-275"></a>
</span><span id="__span-0-276"><a id="__codelineno-0-276" name="__codelineno-0-276" href="#__codelineno-0-276"></a><span class="s1">    const options = {</span>
</span><span id="__span-0-277"><a id="__codelineno-0-277" name="__codelineno-0-277" href="#__codelineno-0-277"></a><span class="s1">        body: event.data ? event.data.text() : &#39;New update available&#39;,</span>
</span><span id="__span-0-278"><a id="__codelineno-0-278" name="__codelineno-0-278" href="#__codelineno-0-278"></a><span class="s1">        icon: &#39;/static/icons/icon-192x192.png&#39;,</span>
</span><span id="__span-0-279"><a id="__codelineno-0-279" name="__codelineno-0-279" href="#__codelineno-0-279"></a><span class="s1">        badge: &#39;/static/icons/badge-72x72.png&#39;,</span>
</span><span id="__span-0-280"><a id="__codelineno-0-280" name="__codelineno-0-280" href="#__codelineno-0-280"></a><span class="s1">        vibrate: [100, 50, 100],</span>
</span><span id="__span-0-281"><a id="__codelineno-0-281" name="__codelineno-0-281" href="#__codelineno-0-281"></a><span class="s1">        data: {</span>
</span><span id="__span-0-282"><a id="__codelineno-0-282" name="__codelineno-0-282" href="#__codelineno-0-282"></a><span class="s1">            dateOfArrival: Date.now(),</span>
</span><span id="__span-0-283"><a id="__codelineno-0-283" name="__codelineno-0-283" href="#__codelineno-0-283"></a><span class="s1">            primaryKey: 1</span>
</span><span id="__span-0-284"><a id="__codelineno-0-284" name="__codelineno-0-284" href="#__codelineno-0-284"></a><span class="s1">        },</span>
</span><span id="__span-0-285"><a id="__codelineno-0-285" name="__codelineno-0-285" href="#__codelineno-0-285"></a><span class="s1">        actions: [</span>
</span><span id="__span-0-286"><a id="__codelineno-0-286" name="__codelineno-0-286" href="#__codelineno-0-286"></a><span class="s1">            {</span>
</span><span id="__span-0-287"><a id="__codelineno-0-287" name="__codelineno-0-287" href="#__codelineno-0-287"></a><span class="s1">                action: &#39;explore&#39;,</span>
</span><span id="__span-0-288"><a id="__codelineno-0-288" name="__codelineno-0-288" href="#__codelineno-0-288"></a><span class="s1">                title: &#39;View Details&#39;,</span>
</span><span id="__span-0-289"><a id="__codelineno-0-289" name="__codelineno-0-289" href="#__codelineno-0-289"></a><span class="s1">                icon: &#39;/static/icons/checkmark.png&#39;</span>
</span><span id="__span-0-290"><a id="__codelineno-0-290" name="__codelineno-0-290" href="#__codelineno-0-290"></a><span class="s1">            },</span>
</span><span id="__span-0-291"><a id="__codelineno-0-291" name="__codelineno-0-291" href="#__codelineno-0-291"></a><span class="s1">            {</span>
</span><span id="__span-0-292"><a id="__codelineno-0-292" name="__codelineno-0-292" href="#__codelineno-0-292"></a><span class="s1">                action: &#39;close&#39;,</span>
</span><span id="__span-0-293"><a id="__codelineno-0-293" name="__codelineno-0-293" href="#__codelineno-0-293"></a><span class="s1">                title: &#39;Close&#39;,</span>
</span><span id="__span-0-294"><a id="__codelineno-0-294" name="__codelineno-0-294" href="#__codelineno-0-294"></a><span class="s1">                icon: &#39;/static/icons/xmark.png&#39;</span>
</span><span id="__span-0-295"><a id="__codelineno-0-295" name="__codelineno-0-295" href="#__codelineno-0-295"></a><span class="s1">            }</span>
</span><span id="__span-0-296"><a id="__codelineno-0-296" name="__codelineno-0-296" href="#__codelineno-0-296"></a><span class="s1">        ]</span>
</span><span id="__span-0-297"><a id="__codelineno-0-297" name="__codelineno-0-297" href="#__codelineno-0-297"></a><span class="s1">    };</span>
</span><span id="__span-0-298"><a id="__codelineno-0-298" name="__codelineno-0-298" href="#__codelineno-0-298"></a>
</span><span id="__span-0-299"><a id="__codelineno-0-299" name="__codelineno-0-299" href="#__codelineno-0-299"></a><span class="s1">    event.waitUntil(</span>
</span><span id="__span-0-300"><a id="__codelineno-0-300" name="__codelineno-0-300" href="#__codelineno-0-300"></a><span class="s1">        self.registration.showNotification(&#39;PWA Update&#39;, options)</span>
</span><span id="__span-0-301"><a id="__codelineno-0-301" name="__codelineno-0-301" href="#__codelineno-0-301"></a><span class="s1">    );</span>
</span><span id="__span-0-302"><a id="__codelineno-0-302" name="__codelineno-0-302" href="#__codelineno-0-302"></a><span class="s1">});</span>
</span><span id="__span-0-303"><a id="__codelineno-0-303" name="__codelineno-0-303" href="#__codelineno-0-303"></a>
</span><span id="__span-0-304"><a id="__codelineno-0-304" name="__codelineno-0-304" href="#__codelineno-0-304"></a><span class="s1">// Notification click handling</span>
</span><span id="__span-0-305"><a id="__codelineno-0-305" name="__codelineno-0-305" href="#__codelineno-0-305"></a><span class="s1">self.addEventListener(&#39;notificationclick&#39;, event =&gt; {</span>
</span><span id="__span-0-306"><a id="__codelineno-0-306" name="__codelineno-0-306" href="#__codelineno-0-306"></a><span class="s1">    console.log(&#39;Notification clicked:&#39;, event.action);</span>
</span><span id="__span-0-307"><a id="__codelineno-0-307" name="__codelineno-0-307" href="#__codelineno-0-307"></a>
</span><span id="__span-0-308"><a id="__codelineno-0-308" name="__codelineno-0-308" href="#__codelineno-0-308"></a><span class="s1">    event.notification.close();</span>
</span><span id="__span-0-309"><a id="__codelineno-0-309" name="__codelineno-0-309" href="#__codelineno-0-309"></a>
</span><span id="__span-0-310"><a id="__codelineno-0-310" name="__codelineno-0-310" href="#__codelineno-0-310"></a><span class="s1">    if (event.action === &#39;explore&#39;) {</span>
</span><span id="__span-0-311"><a id="__codelineno-0-311" name="__codelineno-0-311" href="#__codelineno-0-311"></a><span class="s1">        event.waitUntil(</span>
</span><span id="__span-0-312"><a id="__codelineno-0-312" name="__codelineno-0-312" href="#__codelineno-0-312"></a><span class="s1">            clients.openWindow(&#39;/&#39;)</span>
</span><span id="__span-0-313"><a id="__codelineno-0-313" name="__codelineno-0-313" href="#__codelineno-0-313"></a><span class="s1">        );</span>
</span><span id="__span-0-314"><a id="__codelineno-0-314" name="__codelineno-0-314" href="#__codelineno-0-314"></a><span class="s1">    }</span>
</span><span id="__span-0-315"><a id="__codelineno-0-315" name="__codelineno-0-315" href="#__codelineno-0-315"></a><span class="s1">});</span>
</span><span id="__span-0-316"><a id="__codelineno-0-316" name="__codelineno-0-316" href="#__codelineno-0-316"></a><span class="s1">&#39;&#39;&#39;</span>
</span><span id="__span-0-317"><a id="__codelineno-0-317" name="__codelineno-0-317" href="#__codelineno-0-317"></a>        <span class="k">return</span> <span class="n">service_worker_code</span>
</span><span id="__span-0-318"><a id="__codelineno-0-318" name="__codelineno-0-318" href="#__codelineno-0-318"></a>
</span><span id="__span-0-319"><a id="__codelineno-0-319" name="__codelineno-0-319" href="#__codelineno-0-319"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_manifest</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-320"><a id="__codelineno-0-320" name="__codelineno-0-320" href="#__codelineno-0-320"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get PWA manifest data&quot;&quot;&quot;</span>
</span><span id="__span-0-321"><a id="__codelineno-0-321" name="__codelineno-0-321" href="#__codelineno-0-321"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">manifest_data</span>
</span><span id="__span-0-322"><a id="__codelineno-0-322" name="__codelineno-0-322" href="#__codelineno-0-322"></a>
</span><span id="__span-0-323"><a id="__codelineno-0-323" name="__codelineno-0-323" href="#__codelineno-0-323"></a><span class="n">pwa_manager</span> <span class="o">=</span> <span class="n">PWAManager</span><span class="p">()</span>
</span><span id="__span-0-324"><a id="__codelineno-0-324" name="__codelineno-0-324" href="#__codelineno-0-324"></a>
</span><span id="__span-0-325"><a id="__codelineno-0-325" name="__codelineno-0-325" href="#__codelineno-0-325"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
</span><span id="__span-0-326"><a id="__codelineno-0-326" name="__codelineno-0-326" href="#__codelineno-0-326"></a><span class="k">def</span><span class="w"> </span><span class="nf">index</span><span class="p">():</span>
</span><span id="__span-0-327"><a id="__codelineno-0-327" name="__codelineno-0-327" href="#__codelineno-0-327"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Main PWA application page&quot;&quot;&quot;</span>
</span><span id="__span-0-328"><a id="__codelineno-0-328" name="__codelineno-0-328" href="#__codelineno-0-328"></a>    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;pwa_index.html&#39;</span><span class="p">)</span>
</span><span id="__span-0-329"><a id="__codelineno-0-329" name="__codelineno-0-329" href="#__codelineno-0-329"></a>
</span><span id="__span-0-330"><a id="__codelineno-0-330" name="__codelineno-0-330" href="#__codelineno-0-330"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/manifest.json&#39;</span><span class="p">)</span>
</span><span id="__span-0-331"><a id="__codelineno-0-331" name="__codelineno-0-331" href="#__codelineno-0-331"></a><span class="k">def</span><span class="w"> </span><span class="nf">manifest</span><span class="p">():</span>
</span><span id="__span-0-332"><a id="__codelineno-0-332" name="__codelineno-0-332" href="#__codelineno-0-332"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Serve PWA manifest&quot;&quot;&quot;</span>
</span><span id="__span-0-333"><a id="__codelineno-0-333" name="__codelineno-0-333" href="#__codelineno-0-333"></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">make_response</span><span class="p">(</span><span class="n">jsonify</span><span class="p">(</span><span class="n">pwa_manager</span><span class="o">.</span><span class="n">get_manifest</span><span class="p">()))</span>
</span><span id="__span-0-334"><a id="__codelineno-0-334" name="__codelineno-0-334" href="#__codelineno-0-334"></a>    <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;application/manifest+json&#39;</span>
</span><span id="__span-0-335"><a id="__codelineno-0-335" name="__codelineno-0-335" href="#__codelineno-0-335"></a>    <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-0-336"><a id="__codelineno-0-336" name="__codelineno-0-336" href="#__codelineno-0-336"></a>
</span><span id="__span-0-337"><a id="__codelineno-0-337" name="__codelineno-0-337" href="#__codelineno-0-337"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/sw.js&#39;</span><span class="p">)</span>
</span><span id="__span-0-338"><a id="__codelineno-0-338" name="__codelineno-0-338" href="#__codelineno-0-338"></a><span class="k">def</span><span class="w"> </span><span class="nf">service_worker</span><span class="p">():</span>
</span><span id="__span-0-339"><a id="__codelineno-0-339" name="__codelineno-0-339" href="#__codelineno-0-339"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Serve service worker&quot;&quot;&quot;</span>
</span><span id="__span-0-340"><a id="__codelineno-0-340" name="__codelineno-0-340" href="#__codelineno-0-340"></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">make_response</span><span class="p">(</span><span class="n">pwa_manager</span><span class="o">.</span><span class="n">generate_service_worker</span><span class="p">())</span>
</span><span id="__span-0-341"><a id="__codelineno-0-341" name="__codelineno-0-341" href="#__codelineno-0-341"></a>    <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;application/javascript&#39;</span>
</span><span id="__span-0-342"><a id="__codelineno-0-342" name="__codelineno-0-342" href="#__codelineno-0-342"></a>    <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Service-Worker-Allowed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;/&#39;</span>
</span><span id="__span-0-343"><a id="__codelineno-0-343" name="__codelineno-0-343" href="#__codelineno-0-343"></a>    <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-0-344"><a id="__codelineno-0-344" name="__codelineno-0-344" href="#__codelineno-0-344"></a>
</span><span id="__span-0-345"><a id="__codelineno-0-345" name="__codelineno-0-345" href="#__codelineno-0-345"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/offline.html&#39;</span><span class="p">)</span>
</span><span id="__span-0-346"><a id="__codelineno-0-346" name="__codelineno-0-346" href="#__codelineno-0-346"></a><span class="k">def</span><span class="w"> </span><span class="nf">offline_page</span><span class="p">():</span>
</span><span id="__span-0-347"><a id="__codelineno-0-347" name="__codelineno-0-347" href="#__codelineno-0-347"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Offline fallback page&quot;&quot;&quot;</span>
</span><span id="__span-0-348"><a id="__codelineno-0-348" name="__codelineno-0-348" href="#__codelineno-0-348"></a>    <span class="k">return</span> <span class="s1">&#39;&#39;&#39;</span>
</span><span id="__span-0-349"><a id="__codelineno-0-349" name="__codelineno-0-349" href="#__codelineno-0-349"></a><span class="s1">    &lt;!DOCTYPE html&gt;</span>
</span><span id="__span-0-350"><a id="__codelineno-0-350" name="__codelineno-0-350" href="#__codelineno-0-350"></a><span class="s1">    &lt;html&gt;</span>
</span><span id="__span-0-351"><a id="__codelineno-0-351" name="__codelineno-0-351" href="#__codelineno-0-351"></a><span class="s1">    &lt;head&gt;</span>
</span><span id="__span-0-352"><a id="__codelineno-0-352" name="__codelineno-0-352" href="#__codelineno-0-352"></a><span class="s1">        &lt;title&gt;Offline - PWA&lt;/title&gt;</span>
</span><span id="__span-0-353"><a id="__codelineno-0-353" name="__codelineno-0-353" href="#__codelineno-0-353"></a><span class="s1">        &lt;meta charset=&quot;utf-8&quot;&gt;</span>
</span><span id="__span-0-354"><a id="__codelineno-0-354" name="__codelineno-0-354" href="#__codelineno-0-354"></a><span class="s1">        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;</span>
</span><span id="__span-0-355"><a id="__codelineno-0-355" name="__codelineno-0-355" href="#__codelineno-0-355"></a><span class="s1">        &lt;style&gt;</span>
</span><span id="__span-0-356"><a id="__codelineno-0-356" name="__codelineno-0-356" href="#__codelineno-0-356"></a><span class="s1">            body { </span>
</span><span id="__span-0-357"><a id="__codelineno-0-357" name="__codelineno-0-357" href="#__codelineno-0-357"></a><span class="s1">                font-family: Arial, sans-serif; </span>
</span><span id="__span-0-358"><a id="__codelineno-0-358" name="__codelineno-0-358" href="#__codelineno-0-358"></a><span class="s1">                text-align: center; </span>
</span><span id="__span-0-359"><a id="__codelineno-0-359" name="__codelineno-0-359" href="#__codelineno-0-359"></a><span class="s1">                padding: 50px; </span>
</span><span id="__span-0-360"><a id="__codelineno-0-360" name="__codelineno-0-360" href="#__codelineno-0-360"></a><span class="s1">                background: #f5f5f5;</span>
</span><span id="__span-0-361"><a id="__codelineno-0-361" name="__codelineno-0-361" href="#__codelineno-0-361"></a><span class="s1">            }</span>
</span><span id="__span-0-362"><a id="__codelineno-0-362" name="__codelineno-0-362" href="#__codelineno-0-362"></a><span class="s1">            .offline-message {</span>
</span><span id="__span-0-363"><a id="__codelineno-0-363" name="__codelineno-0-363" href="#__codelineno-0-363"></a><span class="s1">                background: white;</span>
</span><span id="__span-0-364"><a id="__codelineno-0-364" name="__codelineno-0-364" href="#__codelineno-0-364"></a><span class="s1">                padding: 30px;</span>
</span><span id="__span-0-365"><a id="__codelineno-0-365" name="__codelineno-0-365" href="#__codelineno-0-365"></a><span class="s1">                border-radius: 10px;</span>
</span><span id="__span-0-366"><a id="__codelineno-0-366" name="__codelineno-0-366" href="#__codelineno-0-366"></a><span class="s1">                box-shadow: 0 2px 10px rgba(0,0,0,0.1);</span>
</span><span id="__span-0-367"><a id="__codelineno-0-367" name="__codelineno-0-367" href="#__codelineno-0-367"></a><span class="s1">                max-width: 400px;</span>
</span><span id="__span-0-368"><a id="__codelineno-0-368" name="__codelineno-0-368" href="#__codelineno-0-368"></a><span class="s1">                margin: 0 auto;</span>
</span><span id="__span-0-369"><a id="__codelineno-0-369" name="__codelineno-0-369" href="#__codelineno-0-369"></a><span class="s1">            }</span>
</span><span id="__span-0-370"><a id="__codelineno-0-370" name="__codelineno-0-370" href="#__codelineno-0-370"></a><span class="s1">            .icon { font-size: 48px; margin-bottom: 20px; }</span>
</span><span id="__span-0-371"><a id="__codelineno-0-371" name="__codelineno-0-371" href="#__codelineno-0-371"></a><span class="s1">            h1 { color: #333; margin-bottom: 10px; }</span>
</span><span id="__span-0-372"><a id="__codelineno-0-372" name="__codelineno-0-372" href="#__codelineno-0-372"></a><span class="s1">            p { color: #666; line-height: 1.5; }</span>
</span><span id="__span-0-373"><a id="__codelineno-0-373" name="__codelineno-0-373" href="#__codelineno-0-373"></a><span class="s1">            .retry-btn {</span>
</span><span id="__span-0-374"><a id="__codelineno-0-374" name="__codelineno-0-374" href="#__codelineno-0-374"></a><span class="s1">                background: #007bff;</span>
</span><span id="__span-0-375"><a id="__codelineno-0-375" name="__codelineno-0-375" href="#__codelineno-0-375"></a><span class="s1">                color: white;</span>
</span><span id="__span-0-376"><a id="__codelineno-0-376" name="__codelineno-0-376" href="#__codelineno-0-376"></a><span class="s1">                border: none;</span>
</span><span id="__span-0-377"><a id="__codelineno-0-377" name="__codelineno-0-377" href="#__codelineno-0-377"></a><span class="s1">                padding: 10px 20px;</span>
</span><span id="__span-0-378"><a id="__codelineno-0-378" name="__codelineno-0-378" href="#__codelineno-0-378"></a><span class="s1">                border-radius: 5px;</span>
</span><span id="__span-0-379"><a id="__codelineno-0-379" name="__codelineno-0-379" href="#__codelineno-0-379"></a><span class="s1">                cursor: pointer;</span>
</span><span id="__span-0-380"><a id="__codelineno-0-380" name="__codelineno-0-380" href="#__codelineno-0-380"></a><span class="s1">                margin-top: 20px;</span>
</span><span id="__span-0-381"><a id="__codelineno-0-381" name="__codelineno-0-381" href="#__codelineno-0-381"></a><span class="s1">            }</span>
</span><span id="__span-0-382"><a id="__codelineno-0-382" name="__codelineno-0-382" href="#__codelineno-0-382"></a><span class="s1">            .retry-btn:hover { background: #0056b3; }</span>
</span><span id="__span-0-383"><a id="__codelineno-0-383" name="__codelineno-0-383" href="#__codelineno-0-383"></a><span class="s1">        &lt;/style&gt;</span>
</span><span id="__span-0-384"><a id="__codelineno-0-384" name="__codelineno-0-384" href="#__codelineno-0-384"></a><span class="s1">    &lt;/head&gt;</span>
</span><span id="__span-0-385"><a id="__codelineno-0-385" name="__codelineno-0-385" href="#__codelineno-0-385"></a><span class="s1">    &lt;body&gt;</span>
</span><span id="__span-0-386"><a id="__codelineno-0-386" name="__codelineno-0-386" href="#__codelineno-0-386"></a><span class="s1">        &lt;div class=&quot;offline-message&quot;&gt;</span>
</span><span id="__span-0-387"><a id="__codelineno-0-387" name="__codelineno-0-387" href="#__codelineno-0-387"></a><span class="s1">            &lt;div class=&quot;icon&quot;&gt;📱&lt;/div&gt;</span>
</span><span id="__span-0-388"><a id="__codelineno-0-388" name="__codelineno-0-388" href="#__codelineno-0-388"></a><span class="s1">            &lt;h1&gt;You&#39;re Offline&lt;/h1&gt;</span>
</span><span id="__span-0-389"><a id="__codelineno-0-389" name="__codelineno-0-389" href="#__codelineno-0-389"></a><span class="s1">            &lt;p&gt;It looks like you&#39;re not connected to the internet. Some features may be limited, but you can still access cached content.&lt;/p&gt;</span>
</span><span id="__span-0-390"><a id="__codelineno-0-390" name="__codelineno-0-390" href="#__codelineno-0-390"></a><span class="s1">            &lt;button class=&quot;retry-btn&quot; onclick=&quot;window.location.reload()&quot;&gt;</span>
</span><span id="__span-0-391"><a id="__codelineno-0-391" name="__codelineno-0-391" href="#__codelineno-0-391"></a><span class="s1">                Try Again</span>
</span><span id="__span-0-392"><a id="__codelineno-0-392" name="__codelineno-0-392" href="#__codelineno-0-392"></a><span class="s1">            &lt;/button&gt;</span>
</span><span id="__span-0-393"><a id="__codelineno-0-393" name="__codelineno-0-393" href="#__codelineno-0-393"></a><span class="s1">        &lt;/div&gt;</span>
</span><span id="__span-0-394"><a id="__codelineno-0-394" name="__codelineno-0-394" href="#__codelineno-0-394"></a>
</span><span id="__span-0-395"><a id="__codelineno-0-395" name="__codelineno-0-395" href="#__codelineno-0-395"></a><span class="s1">        &lt;script&gt;</span>
</span><span id="__span-0-396"><a id="__codelineno-0-396" name="__codelineno-0-396" href="#__codelineno-0-396"></a><span class="s1">            // Check for connectivity and reload when back online</span>
</span><span id="__span-0-397"><a id="__codelineno-0-397" name="__codelineno-0-397" href="#__codelineno-0-397"></a><span class="s1">            window.addEventListener(&#39;online&#39;, () =&gt; {</span>
</span><span id="__span-0-398"><a id="__codelineno-0-398" name="__codelineno-0-398" href="#__codelineno-0-398"></a><span class="s1">                window.location.reload();</span>
</span><span id="__span-0-399"><a id="__codelineno-0-399" name="__codelineno-0-399" href="#__codelineno-0-399"></a><span class="s1">            });</span>
</span><span id="__span-0-400"><a id="__codelineno-0-400" name="__codelineno-0-400" href="#__codelineno-0-400"></a><span class="s1">        &lt;/script&gt;</span>
</span><span id="__span-0-401"><a id="__codelineno-0-401" name="__codelineno-0-401" href="#__codelineno-0-401"></a><span class="s1">    &lt;/body&gt;</span>
</span><span id="__span-0-402"><a id="__codelineno-0-402" name="__codelineno-0-402" href="#__codelineno-0-402"></a><span class="s1">    &lt;/html&gt;</span>
</span><span id="__span-0-403"><a id="__codelineno-0-403" name="__codelineno-0-403" href="#__codelineno-0-403"></a><span class="s1">    &#39;&#39;&#39;</span>
</span></code></pre></div>
<h3 id="installable-app-characteristics">Installable app characteristics<a class="headerlink" href="#installable-app-characteristics" title="Permanent link">&para;</a></h3>
<p>Implementing <span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A type of web application that uses modern web capabilities to deliver an app-like experience, working offline and installable on devices." data-glossary-full-form="Progressive Web Application" data-glossary-term="PWA">PWA</span> installation prompts and app-like behavior:</p>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python"><span class="c1"># PWA installation and app characteristics</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PWAInstallManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Manage PWA installation and app-like features&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">install_criteria</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;manifest&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s1">&#39;service_worker&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s1">&#39;https&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s1">&#39;user_engagement&#39;</span><span class="p">:</span> <span class="kc">False</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_install_prompt_js</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate JavaScript for install prompt handling&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">// PWA Installation Management</span>
<span class="s1">class PWAInstaller {</span>
<span class="s1">    constructor() {</span>
<span class="s1">        this.deferredPrompt = null;</span>
<span class="s1">        this.installButton = document.getElementById(&#39;install-btn&#39;);</span>
<span class="s1">        this.setupEventListeners();</span>
<span class="s1">        this.checkInstallability();</span>
<span class="s1">    }</span>

<span class="s1">    setupEventListeners() {</span>
<span class="s1">        // Listen for beforeinstallprompt event</span>
<span class="s1">        window.addEventListener(&#39;beforeinstallprompt&#39;, (e) =&gt; {</span>
<span class="s1">            console.log(&#39;PWA install prompt available&#39;);</span>

<span class="s1">            // Prevent default mini-infobar from appearing</span>
<span class="s1">            e.preventDefault();</span>

<span class="s1">            // Store event for later use</span>
<span class="s1">            this.deferredPrompt = e;</span>

<span class="s1">            // Show custom install button</span>
<span class="s1">            this.showInstallButton();</span>
<span class="s1">        });</span>

<span class="s1">        // Handle install button click</span>
<span class="s1">        if (this.installButton) {</span>
<span class="s1">            this.installButton.addEventListener(&#39;click&#39;, () =&gt; {</span>
<span class="s1">                this.promptInstall();</span>
<span class="s1">            });</span>
<span class="s1">        }</span>

<span class="s1">        // Listen for app installation</span>
<span class="s1">        window.addEventListener(&#39;appinstalled&#39;, (e) =&gt; {</span>
<span class="s1">            console.log(&#39;PWA was installed successfully&#39;);</span>
<span class="s1">            this.hideInstallButton();</span>
<span class="s1">            this.trackInstallation();</span>
<span class="s1">        });</span>

<span class="s1">        // Check if already installed</span>
<span class="s1">        if (window.matchMedia(&#39;(display-mode: standalone)&#39;).matches ||</span>
<span class="s1">            window.navigator.standalone) {</span>
<span class="s1">            console.log(&#39;PWA is running in standalone mode&#39;);</span>
<span class="s1">            this.hideInstallButton();</span>
<span class="s1">        }</span>
<span class="s1">    }</span>

<span class="s1">    showInstallButton() {</span>
<span class="s1">        if (this.installButton) {</span>
<span class="s1">            this.installButton.style.display = &#39;block&#39;;</span>
<span class="s1">            this.installButton.innerHTML = `</span>
<span class="s1">                &lt;span class=&quot;icon&quot;&gt;📱&lt;/span&gt;</span>
<span class="s1">                Install App</span>
<span class="s1">            `;</span>
<span class="s1">        }</span>
<span class="s1">    }</span>

<span class="s1">    hideInstallButton() {</span>
<span class="s1">        if (this.installButton) {</span>
<span class="s1">            this.installButton.style.display = &#39;none&#39;;</span>
<span class="s1">        }</span>
<span class="s1">    }</span>

<span class="s1">    async promptInstall() {</span>
<span class="s1">        if (!this.deferredPrompt) {</span>
<span class="s1">            console.log(&#39;No install prompt available&#39;);</span>
<span class="s1">            return;</span>
<span class="s1">        }</span>

<span class="s1">        // Show install prompt</span>
<span class="s1">        this.deferredPrompt.prompt();</span>

<span class="s1">        // Wait for user response</span>
<span class="s1">        const { outcome } = await this.deferredPrompt.userChoice;</span>
<span class="s1">        console.log(&#39;Install prompt outcome:&#39;, outcome);</span>

<span class="s1">        if (outcome === &#39;accepted&#39;) {</span>
<span class="s1">            console.log(&#39;User accepted install prompt&#39;);</span>
<span class="s1">        } else {</span>
<span class="s1">            console.log(&#39;User dismissed install prompt&#39;);</span>
<span class="s1">        }</span>

<span class="s1">        // Clear the deferred prompt</span>
<span class="s1">        this.deferredPrompt = null;</span>
<span class="s1">        this.hideInstallButton();</span>
<span class="s1">    }</span>

<span class="s1">    checkInstallability() {</span>
<span class="s1">        // Check PWA install criteria</span>
<span class="s1">        const criteria = {</span>
<span class="s1">            manifest: this.hasManifest(),</span>
<span class="s1">            serviceWorker: this.hasServiceWorker(),</span>
<span class="s1">            https: this.isHTTPS(),</span>
<span class="s1">            engagement: this.hasUserEngagement()</span>
<span class="s1">        };</span>

<span class="s1">        console.log(&#39;PWA install criteria:&#39;, criteria);</span>

<span class="s1">        const installable = Object.values(criteria).every(Boolean);</span>
<span class="s1">        if (installable) {</span>
<span class="s1">            console.log(&#39;PWA meets installation criteria&#39;);</span>
<span class="s1">        } else {</span>
<span class="s1">            console.log(&#39;PWA does not meet all installation criteria&#39;);</span>
<span class="s1">        }</span>

<span class="s1">        return installable;</span>
<span class="s1">    }</span>

<span class="s1">    hasManifest() {</span>
<span class="s1">        return document.querySelector(&#39;link[rel=&quot;manifest&quot;]&#39;) !== null;</span>
<span class="s1">    }</span>

<span class="s1">    hasServiceWorker() {</span>
<span class="s1">        return &#39;serviceWorker&#39; in navigator;</span>
<span class="s1">    }</span>

<span class="s1">    isHTTPS() {</span>
<span class="s1">        return location.protocol === &#39;https:&#39; || location.hostname === &#39;localhost&#39;;</span>
<span class="s1">    }</span>

<span class="s1">    hasUserEngagement() {</span>
<span class="s1">        // Check if user has interacted with the app</span>
<span class="s1">        // This could be tracked via user actions, time spent, etc.</span>
<span class="s1">        return localStorage.getItem(&#39;user_engaged&#39;) === &#39;true&#39;;</span>
<span class="s1">    }</span>

<span class="s1">    trackInstallation() {</span>
<span class="s1">        // Track installation for analytics</span>
<span class="s1">        fetch(&#39;/api/analytics/install&#39;, {</span>
<span class="s1">            method: &#39;POST&#39;,</span>
<span class="s1">            headers: {</span>
<span class="s1">                &#39;Content-Type&#39;: &#39;application/json&#39;</span>
<span class="s1">            },</span>
<span class="s1">            body: JSON.stringify({</span>
<span class="s1">                timestamp: new Date().toISOString(),</span>
<span class="s1">                userAgent: navigator.userAgent,</span>
<span class="s1">                referrer: document.referrer</span>
<span class="s1">            })</span>
<span class="s1">        }).catch(err =&gt; console.log(&#39;Install tracking failed:&#39;, err));</span>
<span class="s1">    }</span>
<span class="s1">}</span>

<span class="s1">// App-like behavior enhancements</span>
<span class="s1">class PWABehavior {</span>
<span class="s1">    constructor() {</span>
<span class="s1">        this.setupAppLikeBehavior();</span>
<span class="s1">        this.setupStatusBar();</span>
<span class="s1">        this.setupNavigationHandling();</span>
<span class="s1">    }</span>

<span class="s1">    setupAppLikeBehavior() {</span>
<span class="s1">        // Prevent context menu on long press (mobile)</span>
<span class="s1">        document.addEventListener(&#39;contextmenu&#39;, (e) =&gt; {</span>
<span class="s1">            if (window.matchMedia(&#39;(display-mode: standalone)&#39;).matches) {</span>
<span class="s1">                e.preventDefault();</span>
<span class="s1">            }</span>
<span class="s1">        });</span>

<span class="s1">        // Prevent text selection in app mode</span>
<span class="s1">        if (window.matchMedia(&#39;(display-mode: standalone)&#39;).matches) {</span>
<span class="s1">            document.body.style.webkitUserSelect = &#39;none&#39;;</span>
<span class="s1">            document.body.style.webkitTouchCallout = &#39;none&#39;;</span>
<span class="s1">        }</span>

<span class="s1">        // Handle pull-to-refresh</span>
<span class="s1">        this.setupPullToRefresh();</span>
<span class="s1">    }</span>

<span class="s1">    setupStatusBar() {</span>
<span class="s1">        // Set status bar style for iOS</span>
<span class="s1">        const statusBarMeta = document.createElement(&#39;meta&#39;);</span>
<span class="s1">        statusBarMeta.name = &#39;apple-mobile-web-app-status-bar-style&#39;;</span>
<span class="s1">        statusBarMeta.content = &#39;black-translucent&#39;;</span>
<span class="s1">        document.head.appendChild(statusBarMeta);</span>

<span class="s1">        // Adjust content for notch/safe areas</span>
<span class="s1">        if (CSS.supports(&#39;padding&#39;, &#39;env(safe-area-inset-top)&#39;)) {</span>
<span class="s1">            document.documentElement.style.setProperty(</span>
<span class="s1">                &#39;--safe-area-top&#39;, </span>
<span class="s1">                &#39;env(safe-area-inset-top)&#39;</span>
<span class="s1">            );</span>
<span class="s1">            document.documentElement.style.setProperty(</span>
<span class="s1">                &#39;--safe-area-bottom&#39;, </span>
<span class="s1">                &#39;env(safe-area-inset-bottom)&#39;</span>
<span class="s1">            );</span>
<span class="s1">        }</span>
<span class="s1">    }</span>

<span class="s1">    setupNavigationHandling() {</span>
<span class="s1">        // Handle back button in standalone mode</span>
<span class="s1">        window.addEventListener(&#39;popstate&#39;, (e) =&gt; {</span>
<span class="s1">            if (window.matchMedia(&#39;(display-mode: standalone)&#39;).matches) {</span>
<span class="s1">                // Custom back button handling</span>
<span class="s1">                console.log(&#39;Back navigation in standalone mode&#39;);</span>
<span class="s1">            }</span>
<span class="s1">        });</span>
<span class="s1">    }</span>

<span class="s1">    setupPullToRefresh() {</span>
<span class="s1">        let startY = 0;</span>
<span class="s1">        let currentY = 0;</span>
<span class="s1">        let pulling = false;</span>

<span class="s1">        document.addEventListener(&#39;touchstart&#39;, (e) =&gt; {</span>
<span class="s1">            if (window.scrollY === 0) {</span>
<span class="s1">                startY = e.touches[0].clientY;</span>
<span class="s1">                pulling = true;</span>
<span class="s1">            }</span>
<span class="s1">        });</span>

<span class="s1">        document.addEventListener(&#39;touchmove&#39;, (e) =&gt; {</span>
<span class="s1">            if (pulling &amp;&amp; window.scrollY === 0) {</span>
<span class="s1">                currentY = e.touches[0].clientY;</span>
<span class="s1">                const pullDistance = currentY - startY;</span>

<span class="s1">                if (pullDistance &gt; 100) {</span>
<span class="s1">                    // Show refresh indicator</span>
<span class="s1">                    this.showRefreshIndicator();</span>
<span class="s1">                }</span>
<span class="s1">            }</span>
<span class="s1">        });</span>

<span class="s1">        document.addEventListener(&#39;touchend&#39;, (e) =&gt; {</span>
<span class="s1">            if (pulling &amp;&amp; currentY - startY &gt; 100) {</span>
<span class="s1">                this.refreshApp();</span>
<span class="s1">            }</span>
<span class="s1">            pulling = false;</span>
<span class="s1">            this.hideRefreshIndicator();</span>
<span class="s1">        });</span>
<span class="s1">    }</span>

<span class="s1">    showRefreshIndicator() {</span>
<span class="s1">        // Show visual refresh indicator</span>
<span class="s1">        console.log(&#39;Showing refresh indicator&#39;);</span>
<span class="s1">    }</span>

<span class="s1">    hideRefreshIndicator() {</span>
<span class="s1">        // Hide visual refresh indicator</span>
<span class="s1">        console.log(&#39;Hiding refresh indicator&#39;);</span>
<span class="s1">    }</span>

<span class="s1">    refreshApp() {</span>
<span class="s1">        // Refresh app content</span>
<span class="s1">        window.location.reload();</span>
<span class="s1">    }</span>
<span class="s1">}</span>

<span class="s1">// Initialize PWA features</span>
<span class="s1">document.addEventListener(&#39;DOMContentLoaded&#39;, () =&gt; {</span>
<span class="s1">    const installer = new PWAInstaller();</span>
<span class="s1">    const behavior = new PWABehavior();</span>

<span class="s1">    // Track user engagement</span>
<span class="s1">    let engagementTimeout = setTimeout(() =&gt; {</span>
<span class="s1">        localStorage.setItem(&#39;user_engaged&#39;, &#39;true&#39;);</span>
<span class="s1">        console.log(&#39;User engagement recorded&#39;);</span>
<span class="s1">    }, 30000); // 30 seconds</span>

<span class="s1">    // Cancel engagement tracking if user leaves quickly</span>
<span class="s1">    window.addEventListener(&#39;beforeunload&#39;, () =&gt; {</span>
<span class="s1">        clearTimeout(engagementTimeout);</span>
<span class="s1">    });</span>
<span class="s1">});</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">install_manager</span> <span class="o">=</span> <span class="n">PWAInstallManager</span><span class="p">()</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/api/pwa/install-status&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">install_status</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check PWA installation status and criteria&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span>
        <span class="s1">&#39;installable&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="n">install_manager</span><span class="o">.</span><span class="n">install_criteria</span><span class="p">,</span>
        <span class="s1">&#39;recommendations&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;Ensure HTTPS is enabled&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Add user engagement tracking&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Implement background sync&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Test on multiple devices&#39;</span>
        <span class="p">]</span>
    <span class="p">})</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/api/analytics/install&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">track_installation</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Track PWA installation analytics&quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">get_json</span><span class="p">()</span>

    <span class="c1"># Store installation data</span>
    <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;pwa_data.db&#39;</span><span class="p">)</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">        INSERT INTO sync_queue (action, resource, data) </span>
<span class="s1">        VALUES (?, ?, ?)</span>
<span class="s1">    &#39;&#39;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;install_tracked&#39;</span><span class="p">,</span> <span class="s1">&#39;analytics&#39;</span><span class="p">,</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)))</span>

    <span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;tracked&#39;</span><span class="p">})</span>
</code></pre>
</div>
<h3 id="syncing-strategies-and-background-sync">Syncing strategies and background sync<a class="headerlink" href="#syncing-strategies-and-background-sync" title="Permanent link">&para;</a></h3>
<p>Implementing offline data synchronization:</p>
<div class="diagram-container" data-container-id="kroki-diagram-0"><button class="diagram-expand-btn" onclick="openDiagramModal('kroki-diagram-0')">🔍 View Larger</button><div id="kroki-diagram-0" class="diagram-content"><p><svg xmlns="<span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="The foundation protocol for data communication on the World Wide Web. HTTPS is the secure version using encryption." data-glossary-full-form="Hypertext Transfer Protocol (Secure)" data-glossary-term="HTTP" data-diagram-id="kroki-svg-0">http</span>://www.w3.org/2000/svg" contentStyleType="text/<span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="The standard markup language for creating web pages. CSS is used for styling and layout." data-glossary-full-form="HyperText Markup Language / Cascading Style Sheets" data-glossary-term="HTML">css</span>" data-diagram-type="DESCRIPTION" height="228px" preserveAspectRatio="xMaxYMax meet" style="width:2736px;height:228px;background:#FFFFFF;" version="1.1" viewBox="0 0 2736 228" width="2736px" zoomAndPan="magnify" id="Kroki"><defs /><g><g <span class="glossary-term" data-glossary-category="OOP" data-glossary-definition="A blueprint or template for creating objects that defines attributes and methods common to all objects of that type." data-glossary-term="Class">class</span>="cluster" data-entity="<span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A type of web application that uses modern web capabilities to deliver an app-like experience, working offline and installable on devices." data-glossary-full-form="Progressive Web Application" data-glossary-term="PWA">PWA</span> Sync Architecture" data-source-line="4" data-uid="ent0002" id="cluster_PWA Sync Architecture"><rect fill="none" height="183.3" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1;" width="2723" x="7" y="39.5659" /><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="182.1094" x="1277.4453" y="54.561"><span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A type of web application that uses modern web capabilities to deliver an app-like experience, working offline and installable on devices." data-glossary-full-form="Progressive Web Application" data-glossary-term="PWA">PWA</span> Sync Architecture</text></g><g <span class="glossary-term" data-glossary-category="OOP" data-glossary-definition="A blueprint or template for creating objects that defines attributes and methods common to all objects of that type." data-glossary-term="Class">class</span>="cluster" data-entity="Client Side" data-source-line="6" data-uid="ent0003" id="cluster_Client Side"><rect fill="none" height="116.3" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1;" width="1076" x="1630" y="82.5659" /><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="85.2988" x="2125.3506" y="97.561">Client Side</text></g><g <span class="glossary-term" data-glossary-category="OOP" data-glossary-definition="A blueprint or template for creating objects that defines attributes and methods common to all objects of that type." data-glossary-term="Class">class</span>="cluster" data-entity="Network Layer" data-source-line="17" data-uid="ent0011" id="cluster_Network Layer"><rect fill="none" height="116.3" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1;" width="868" x="738" y="82.5659" /><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="115.4385" x="1114.2808" y="97.561">Network Layer</text></g><g <span class="glossary-term" data-glossary-category="OOP" data-glossary-definition="A blueprint or template for creating objects that defines attributes and methods common to all objects of that type." data-glossary-term="Class">class</span>="cluster" data-entity="Server Side" data-source-line="27" data-uid="ent0018" id="cluster_Server Side"><rect fill="none" height="116.3" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1;" width="683" x="31" y="82.5659" /><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="91.2803" x="326.8599" y="97.561">Server Side</text></g><g <span class="glossary-term" data-glossary-category="OOP" data-glossary-definition="A blueprint or template for creating objects that defines attributes and methods common to all objects of that type." data-glossary-term="Class">class</span>="entity" data-entity="sw" data-source-line="7" data-uid="ent0004" id="entity_sw"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="146.832" x="2208.58" y="136.5659" /><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="2335.412" y="141.5659" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="2333.412" y="143.5659" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="2333.412" y="147.5659" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106.832" x="2223.58" y="169.561"><span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A script that runs in the background of a web browser, enabling features like offline functionality and push notifications." data-glossary-term="Service Worker">Service Worker</span></text></g><g <span class="glossary-term" data-glossary-category="OOP" data-glossary-definition="A blueprint or template for creating objects that defines attributes and methods common to all objects of that type." data-glossary-term="Class">class</span>="entity" data-entity="idb" data-source-line="8" data-uid="ent0005" id="entity_idb"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.6719" x="1928.66" y="136.5659" /><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="2025.3319" y="141.5659" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="2023.3319" y="143.5659" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="2023.3319" y="147.5659" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76.6719" x="1943.66" y="169.561">IndexedDB</text></g><g <span class="glossary-term" data-glossary-category="OOP" data-glossary-definition="A blueprint or template for creating objects that defines attributes and methods common to all objects of that type." data-glossary-term="Class">class</span>="entity" data-entity="bg_sync" data-source-line="9" data-uid="ent0006" id="entity_bg_sync"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="162.0215" x="2527.99" y="136.5659" /><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="2670.0115" y="141.5659" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="2668.0115" y="143.5659" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="2668.0115" y="147.5659" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122.0215" x="2542.99" y="169.561">Background Sync</text></g><g <span class="glossary-term" data-glossary-category="OOP" data-glossary-definition="A blueprint or template for creating objects that defines attributes and methods common to all objects of that type." data-glossary-term="Class">class</span>="entity" data-entity="<span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="The means by which a user interacts with a computer, website, or application, including visual elements and controls." data-glossary-full-form="User Interface" data-glossary-term="UI">ui</span>" data-source-line="10" data-uid="ent0007" id="entity_ui"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134.4795" x="1645.76" y="136.5659" /><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="1760.2395" y="141.5659" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1758.2395" y="143.5659" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1758.2395" y="147.5659" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94.4795" x="1660.76" y="169.561">App Interface</text></g><g <span class="glossary-term" data-glossary-category="OOP" data-glossary-definition="A blueprint or template for creating objects that defines attributes and methods common to all objects of that type." data-glossary-term="Class">class</span>="entity" data-entity="online" data-source-line="18" data-uid="ent0012" id="entity_online"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="157.6191" x="754.19" y="136.5659" /><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="891.8091" y="141.5659" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="889.8091" y="143.5659" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="889.8091" y="147.5659" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117.6191" x="769.19" y="169.561">Online Detection</text></g><g <span class="glossary-term" data-glossary-category="OOP" data-glossary-definition="A blueprint or template for creating objects that defines attributes and methods common to all objects of that type." data-glossary-term="Class">class</span>="entity" data-entity="retry" data-source-line="19" data-uid="ent0013" id="entity_retry"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="119.1602" x="1111.42" y="136.5659" /><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="1210.5802" y="141.5659" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1208.5802" y="143.5659" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1208.5802" y="147.5659" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79.1602" x="1126.42" y="169.561">Retry Logic</text></g><g <span class="glossary-term" data-glossary-category="OOP" data-glossary-definition="A blueprint or template for creating objects that defines attributes and methods common to all objects of that type." data-glossary-term="Class">class</span>="entity" data-entity="conflict" data-source-line="20" data-uid="ent0014" id="entity_conflict"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="171.3389" x="1418.33" y="136.5659" /><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="1569.6689" y="141.5659" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1567.6689" y="143.5659" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1567.6689" y="147.5659" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="131.3389" x="1433.33" y="169.561">Conflict Resolution</text></g><g <span class="glossary-term" data-glossary-category="OOP" data-glossary-definition="A blueprint or template for creating objects that defines attributes and methods common to all objects of that type." data-glossary-term="Class">class</span>="entity" data-entity="sync_api" data-source-line="28" data-uid="ent0019" id="entity_sync_api"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100.3408" x="46.83" y="136.5659" /><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="127.1708" y="141.5659" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="125.1708" y="143.5659" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="125.1708" y="147.5659" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60.3408" x="61.83" y="169.561">Sync <span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A set of protocols and tools for building software applications, defining how components interact." data-glossary-full-form="Application Programming Interface" data-glossary-term="API">API</span></text></g><g <span class="glossary-term" data-glossary-category="OOP" data-glossary-definition="A blueprint or template for creating objects that defines attributes and methods common to all objects of that type." data-glossary-term="Class">class</span>="entity" data-entity="server_conflict" data-source-line="29" data-uid="ent0020" id="entity_server_conflict"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="152.6836" x="291.66" y="136.5659" /><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="424.3436" y="141.5659" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="422.3436" y="143.5659" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="422.3436" y="147.5659" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112.6836" x="306.66" y="169.561">Conflict Handler</text></g><g <span class="glossary-term" data-glossary-category="OOP" data-glossary-definition="A blueprint or template for creating objects that defines attributes and methods common to all objects of that type." data-glossary-term="Class">class</span>="entity" data-entity="<span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="An organized collection of structured data stored electronically in a computer system, typically accessed via a database management system." data-glossary-term="Database">db</span>" data-source-line="30" data-uid="ent0021" id="entity_db"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="115.1885" x="582.41" y="136.5659" /><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="677.5985" y="141.5659" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="675.5985" y="143.5659" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="675.5985" y="147.5659" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75.1885" x="597.41" y="169.561">Data Store</text></g><g <span class="glossary-term" data-glossary-category="OOP" data-glossary-definition="A blueprint or template for creating objects that defines attributes and methods common to all objects of that type." data-glossary-term="Class">class</span>="link" data-entity-1="<span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="The means by which a user interacts with a computer, website, or application, including visual elements and controls." data-glossary-full-form="User Interface" data-glossary-term="UI">ui</span>" data-entity-2="idb" data-source-line="12" data-uid="lnk8" id="link_ui_idb"><path d="M1780.73,159.7159 C1826.05,159.7159 1879.1,159.7159 1922.4,159.7159" fill="none" id="<span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="The means by which a user interacts with a computer, website, or application, including visual elements and controls." data-glossary-full-form="User Interface" data-glossary-term="UI">ui</span>-to-idb" style="stroke:#181818;stroke-width:1;" /><polygon fill="#181818" points="1928.4,159.7159,1919.4,155.7159,1923.4,159.7159,1919.4,163.7159,1928.4,159.7159" style="stroke:#181818;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112.7598" x="1798.45" y="152.7828">Store offline data</text></g><g <span class="glossary-term" data-glossary-category="OOP" data-glossary-definition="A blueprint or template for creating objects that defines attributes and methods common to all objects of that type." data-glossary-term="Class">class</span>="link" data-entity-1="idb" data-entity-2="sw" data-source-line="13" data-uid="lnk9" id="link_idb_sw"><path d="M2045.64,159.7159 C2092.35,159.7159 2152.02,159.7159 2202.29,159.7159" fill="none" id="idb-to-sw" style="stroke:#181818;stroke-width:1;" /><polygon fill="#181818" points="2208.29,159.7159,2199.29,155.7159,2203.29,159.7159,2199.29,163.7159,2208.29,159.7159" style="stroke:#181818;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.6133" x="2063.46" y="152.7828">Queue sync actions</text></g><g <span class="glossary-term" data-glossary-category="OOP" data-glossary-definition="A blueprint or template for creating objects that defines attributes and methods common to all objects of that type." data-glossary-term="Class">class</span>="link" data-entity-1="sw" data-entity-2="bg_sync" data-source-line="14" data-uid="lnk10" id="link_sw_bg_sync"><path d="M2355.79,159.7159 C2406.94,159.7159 2469.04,159.7159 2521.73,159.7159" fill="none" id="sw-to-bg_sync" style="stroke:#181818;stroke-width:1;" /><polygon fill="#181818" points="2527.73,159.7159,2518.73,155.7159,2522.73,159.7159,2518.73,163.7159,2527.73,159.7159" style="stroke:#181818;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.0239" x="2373.7" y="152.7828">Register sync events</text></g><g <span class="glossary-term" data-glossary-category="OOP" data-glossary-definition="A blueprint or template for creating objects that defines attributes and methods common to all objects of that type." data-glossary-term="Class">class</span>="link" data-entity-1="bg_sync" data-entity-2="online" data-source-line="22" data-uid="lnk15" id="link_bg_sync_online"><path d="M2575.42,136.2459 C2531.36,107.0159 2450.51,58.6859 2373,40.1759 C2234.78,7.1659 1232.85,9.8959 1094,40.1759 C1009.52,58.6059 924.8155,103.8966 875.6855,133.1466" fill="none" id="bg_sync-to-online" style="stroke:#181818;stroke-width:1;" /><polygon fill="#181818" points="870.53,136.2159,880.3095,135.0489,874.8262,133.6581,876.217,128.1749,870.53,136.2159" style="stroke:#181818;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123.6523" x="912.5" y="19.6328">Check connectivity</text></g><g <span class="glossary-term" data-glossary-category="OOP" data-glossary-definition="A blueprint or template for creating objects that defines attributes and methods common to all objects of that type." data-glossary-term="Class">class</span>="link" data-entity-1="online" data-entity-2="retry" data-source-line="23" data-uid="lnk16" id="link_online_retry"><path d="M912.25,159.7159 C973.03,159.7159 1049.63,159.7159 1105,159.7159" fill="none" id="online-to-retry" style="stroke:#181818;stroke-width:1;" /><polygon fill="#181818" points="1111,159.7159,1102,155.7159,1106,159.7159,1102,163.7159,1111,159.7159" style="stroke:#181818;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.0889" x="953.11" y="152.7828">Network available</text></g><g <span class="glossary-term" data-glossary-category="OOP" data-glossary-definition="A blueprint or template for creating objects that defines attributes and methods common to all objects of that type." data-glossary-term="Class">class</span>="link" data-entity-1="retry" data-entity-2="conflict" data-source-line="24" data-uid="lnk17" id="link_retry_conflict"><path d="M1230.92,159.7159 C1283.07,159.7159 1353.28,159.7159 1411.95,159.7159" fill="none" id="retry-to-conflict" style="stroke:#181818;stroke-width:1;" /><polygon fill="#181818" points="1417.95,159.7159,1408.95,155.7159,1412.95,159.7159,1408.95,163.7159,1417.95,159.7159" style="stroke:#181818;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.1333" x="1272.46" y="152.7828">Handle conflicts</text></g><g <span class="glossary-term" data-glossary-category="OOP" data-glossary-definition="A blueprint or template for creating objects that defines attributes and methods common to all objects of that type." data-glossary-term="Class">class</span>="link" data-entity-1="conflict" data-entity-2="sync_api" data-source-line="32" data-uid="lnk22" id="link_conflict_sync_api"><path d="M1467.26,136.2159 C1419.14,106.9759 1331.08,58.6159 1248,40.1759 C1142.35,16.7259 377.48,8.5059 274,40.1759 C212.66,58.9459 157.825,102.9048 125.845,132.0448" fill="none" id="conflict-to-sync_api" style="stroke:#181818;stroke-width:1;" /><polygon fill="#181818" points="121.41,136.0859,130.7566,132.9809,125.1058,132.7183,125.3684,127.0675,121.41,136.0859" style="stroke:#181818;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.2661" x="1298.5" y="19.6328">Send queued data</text></g><g <span class="glossary-term" data-glossary-category="OOP" data-glossary-definition="A blueprint or template for creating objects that defines attributes and methods common to all objects of that type." data-glossary-term="Class">class</span>="link" data-entity-1="sync_api" data-entity-2="server_conflict" data-source-line="33" data-uid="lnk23" id="link_sync_api_server_conflict"><path d="M147.66,159.7159 C188.02,159.7159 239.2,159.7159 285.2,159.7159" fill="none" id="sync_api-to-server_conflict" style="stroke:#181818;stroke-width:1;" /><polygon fill="#181818" points="291.2,159.7159,282.2,155.7159,286.2,159.7159,282.2,163.7159,291.2,159.7159" style="stroke:#181818;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.1196" x="165.41" y="152.7828">Process conflicts</text></g><g <span class="glossary-term" data-glossary-category="OOP" data-glossary-definition="A blueprint or template for creating objects that defines attributes and methods common to all objects of that type." data-glossary-term="Class">class</span>="link" data-entity-1="server_conflict" data-entity-2="<span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="An organized collection of structured data stored electronically in a computer system, typically accessed via a database management system." data-glossary-term="Database">db</span>" data-source-line="34" data-uid="lnk24" id="link_server_conflict_db"><path d="M444.49,159.7159 C488.17,159.7159 536.06,159.7159 576.19,159.7159" fill="none" id="server_conflict-to-<span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="An organized collection of structured data stored electronically in a computer system, typically accessed via a database management system." data-glossary-term="Database">db</span>" style="stroke:#181818;stroke-width:1;" /><polygon fill="#181818" points="582.19,159.7159,573.19,155.7159,577.19,159.7159,573.19,163.7159,582.19,159.7159" style="stroke:#181818;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.1846" x="462.37" y="152.7828">Persist changes</text></g></g></svg></p></div></div>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python"><span class="c1"># Background sync and data synchronization</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PWASyncManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Manage PWA background synchronization&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sync_strategies</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;immediate&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">immediate_sync</span><span class="p">,</span>
            <span class="s1">&#39;background&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">background_sync</span><span class="p">,</span>
            <span class="s1">&#39;conflict_resolution&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_conflicts</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">queue_sync_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Queue an action for background synchronization&quot;&quot;&quot;</span>
        <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;pwa_data.db&#39;</span><span class="p">)</span>
        <span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

        <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">            INSERT INTO sync_queue (action, resource, data) </span>
<span class="s1">            VALUES (?, ?, ?)</span>
<span class="s1">        &#39;&#39;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)))</span>

        <span class="n">sync_id</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">lastrowid</span>
        <span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
        <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">sync_id</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_pending_syncs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all pending sync actions&quot;&quot;&quot;</span>
        <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;pwa_data.db&#39;</span><span class="p">)</span>
        <span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

        <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">            SELECT id, action, resource, data, timestamp </span>
<span class="s1">            FROM sync_queue </span>
<span class="s1">            WHERE synced = FALSE </span>
<span class="s1">            ORDER BY timestamp ASC</span>
<span class="s1">        &#39;&#39;&#39;</span><span class="p">)</span>

        <span class="n">syncs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">():</span>
            <span class="n">syncs</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="s1">&#39;resource&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
            <span class="p">})</span>

        <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">syncs</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">mark_sync_completed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sync_id</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Mark a sync action as completed&quot;&quot;&quot;</span>
        <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;pwa_data.db&#39;</span><span class="p">)</span>
        <span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

        <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">            UPDATE sync_queue </span>
<span class="s1">            SET synced = TRUE </span>
<span class="s1">            WHERE id = ?</span>
<span class="s1">        &#39;&#39;&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">sync_id</span><span class="p">,))</span>

        <span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
        <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">immediate_sync</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Attempt immediate synchronization&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Simulate network request</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_sync_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;result&#39;</span><span class="p">:</span> <span class="n">result</span><span class="p">}</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Queue for background sync if immediate fails</span>
            <span class="n">sync_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">queue_sync_action</span><span class="p">(</span><span class="s1">&#39;retry&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;queued&#39;</span><span class="p">:</span> <span class="n">sync_id</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">background_sync</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sync_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process background sync queue&quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">pending_syncs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pending_syncs</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">sync</span> <span class="ow">in</span> <span class="n">pending_syncs</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_sync_data</span><span class="p">(</span><span class="n">sync</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mark_sync_completed</span><span class="p">(</span><span class="n">sync</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
                <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">sync</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s1">&#39;result&#39;</span><span class="p">:</span> <span class="n">result</span>
                <span class="p">})</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">sync</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
                    <span class="s1">&#39;retry_later&#39;</span><span class="p">:</span> <span class="kc">True</span>
                <span class="p">})</span>

        <span class="k">return</span> <span class="n">results</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">resolve_conflicts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">local_data</span><span class="p">,</span> <span class="n">server_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Resolve data conflicts during sync&quot;&quot;&quot;</span>
        <span class="n">resolution_strategy</span> <span class="o">=</span> <span class="s1">&#39;server_wins&#39;</span>  <span class="c1"># Can be configurable</span>

        <span class="k">if</span> <span class="n">resolution_strategy</span> <span class="o">==</span> <span class="s1">&#39;server_wins&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">server_data</span>
        <span class="k">elif</span> <span class="n">resolution_strategy</span> <span class="o">==</span> <span class="s1">&#39;client_wins&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">local_data</span>
        <span class="k">elif</span> <span class="n">resolution_strategy</span> <span class="o">==</span> <span class="s1">&#39;merge&#39;</span><span class="p">:</span>
            <span class="c1"># Implement merge logic based on data structure</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">merge_data</span><span class="p">(</span><span class="n">local_data</span><span class="p">,</span> <span class="n">server_data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">resolution_strategy</span> <span class="o">==</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span>
            <span class="c1"># Use most recent data based on timestamp</span>
            <span class="n">local_time</span> <span class="o">=</span> <span class="n">local_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;last_modified&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">server_time</span> <span class="o">=</span> <span class="n">server_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;last_modified&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">server_data</span> <span class="k">if</span> <span class="n">server_time</span> <span class="o">&gt;</span> <span class="n">local_time</span> <span class="k">else</span> <span class="n">local_data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">merge_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">local_data</span><span class="p">,</span> <span class="n">server_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Merge local and server data&quot;&quot;&quot;</span>
        <span class="c1"># Simple merge strategy - can be customized per data type</span>
        <span class="n">merged</span> <span class="o">=</span> <span class="n">server_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Preserve local changes that don&#39;t conflict</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">local_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">server_data</span><span class="p">:</span>
                <span class="n">merged</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="k">return</span> <span class="n">merged</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process_sync_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process sync data - simulate server operation&quot;&quot;&quot;</span>
        <span class="c1"># Simulate processing time</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

        <span class="c1"># Return processed result</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;processed_at&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
            <span class="s1">&#39;data_id&#39;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;unknown&#39;</span><span class="p">),</span>
            <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;processed&#39;</span>
        <span class="p">}</span>

<span class="n">sync_manager</span> <span class="o">=</span> <span class="n">PWASyncManager</span><span class="p">()</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/api/sync/queue&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">queue_sync</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Queue data for background synchronization&quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">get_json</span><span class="p">()</span>

    <span class="n">sync_id</span> <span class="o">=</span> <span class="n">sync_manager</span><span class="o">.</span><span class="n">queue_sync_action</span><span class="p">(</span>
        <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;action&#39;</span><span class="p">,</span> <span class="s1">&#39;update&#39;</span><span class="p">),</span>
        <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;resource&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">),</span>
        <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;payload&#39;</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span>
        <span class="s1">&#39;sync_id&#39;</span><span class="p">:</span> <span class="n">sync_id</span><span class="p">,</span>
        <span class="s1">&#39;queued&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;Data queued for background sync&#39;</span>
    <span class="p">})</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/api/sync/process&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">process_sync</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process pending background sync queue&quot;&quot;&quot;</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">sync_manager</span><span class="o">.</span><span class="n">background_sync</span><span class="p">({})</span>

    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span>
        <span class="s1">&#39;processed&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">),</span>
        <span class="s1">&#39;successful&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">([</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span> <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]]),</span>
        <span class="s1">&#39;failed&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">([</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]]),</span>
        <span class="s1">&#39;results&#39;</span><span class="p">:</span> <span class="n">results</span>
    <span class="p">})</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/api/sync/status&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">sync_status</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get current sync status&quot;&quot;&quot;</span>
    <span class="n">pending_syncs</span> <span class="o">=</span> <span class="n">sync_manager</span><span class="o">.</span><span class="n">get_pending_syncs</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span>
        <span class="s1">&#39;pending_count&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">pending_syncs</span><span class="p">),</span>
        <span class="s1">&#39;last_sync&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
        <span class="s1">&#39;pending_actions&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">sync</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span>
                <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="n">sync</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">],</span>
                <span class="s1">&#39;resource&#39;</span><span class="p">:</span> <span class="n">sync</span><span class="p">[</span><span class="s1">&#39;resource&#39;</span><span class="p">],</span>
                <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">sync</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="n">sync</span> <span class="ow">in</span> <span class="n">pending_syncs</span>
        <span class="p">]</span>
    <span class="p">})</span>

<span class="c1"># PWA accessibility considerations</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PWAAccessibility</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Manage PWA accessibility features&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a11y_features</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;keyboard_navigation&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s1">&#39;screen_reader_support&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s1">&#39;high_contrast&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s1">&#39;focus_management&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s1">&#39;aria_labels&#39;</span><span class="p">:</span> <span class="kc">True</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_accessibility_js</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate JavaScript for accessibility enhancements&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">// PWA Accessibility Enhancements</span>
<span class="s1">class PWAAccessibility {</span>
<span class="s1">    constructor() {</span>
<span class="s1">        this.setupKeyboardNavigation();</span>
<span class="s1">        this.setupFocusManagement();</span>
<span class="s1">        this.setupHighContrast();</span>
<span class="s1">        this.setupScreenReaderSupport();</span>
<span class="s1">    }</span>

<span class="s1">    setupKeyboardNavigation() {</span>
<span class="s1">        // Ensure all interactive elements are keyboard accessible</span>
<span class="s1">        document.addEventListener(&#39;keydown&#39;, (e) =&gt; {</span>
<span class="s1">            // Handle tab navigation</span>
<span class="s1">            if (e.key === &#39;Tab&#39;) {</span>
<span class="s1">                this.manageFocusOrder(e);</span>
<span class="s1">            }</span>

<span class="s1">            // Handle escape key</span>
<span class="s1">            if (e.key === &#39;Escape&#39;) {</span>
<span class="s1">                this.handleEscape();</span>
<span class="s1">            }</span>

<span class="s1">            // Handle enter/space for custom controls</span>
<span class="s1">            if (e.key === &#39;Enter&#39; || e.key === &#39; &#39;) {</span>
<span class="s1">                this.handleActivation(e);</span>
<span class="s1">            }</span>
<span class="s1">        });</span>
<span class="s1">    }</span>

<span class="s1">    setupFocusManagement() {</span>
<span class="s1">        // Track focus for skip links and modal dialogs</span>
<span class="s1">        let focusStack = [];</span>

<span class="s1">        window.pushFocus = (element) =&gt; {</span>
<span class="s1">            focusStack.push(document.activeElement);</span>
<span class="s1">            element.focus();</span>
<span class="s1">        };</span>

<span class="s1">        window.popFocus = () =&gt; {</span>
<span class="s1">            const previousFocus = focusStack.pop();</span>
<span class="s1">            if (previousFocus) {</span>
<span class="s1">                previousFocus.focus();</span>
<span class="s1">            }</span>
<span class="s1">        };</span>

<span class="s1">        // Focus trap for modals</span>
<span class="s1">        window.trapFocus = (container) =&gt; {</span>
<span class="s1">            const focusableElements = container.querySelectorAll(</span>
<span class="s1">                &#39;button, [href], input, select, textarea, [tabindex]:not([tabindex=&quot;-1&quot;])&#39;</span>
<span class="s1">            );</span>

<span class="s1">            const firstElement = focusableElements[0];</span>
<span class="s1">            const lastElement = focusableElements[focusableElements.length - 1];</span>

<span class="s1">            container.addEventListener(&#39;keydown&#39;, (e) =&gt; {</span>
<span class="s1">                if (e.key === &#39;Tab&#39;) {</span>
<span class="s1">                    if (e.shiftKey) {</span>
<span class="s1">                        if (document.activeElement === firstElement) {</span>
<span class="s1">                            lastElement.focus();</span>
<span class="s1">                            e.preventDefault();</span>
<span class="s1">                        }</span>
<span class="s1">                    } else {</span>
<span class="s1">                        if (document.activeElement === lastElement) {</span>
<span class="s1">                            firstElement.focus();</span>
<span class="s1">                            e.preventDefault();</span>
<span class="s1">                        }</span>
<span class="s1">                    }</span>
<span class="s1">                }</span>
<span class="s1">            });</span>
<span class="s1">        };</span>
<span class="s1">    }</span>

<span class="s1">    setupHighContrast() {</span>
<span class="s1">        // Detect and respond to high contrast preferences</span>
<span class="s1">        const prefersHighContrast = window.matchMedia(&#39;(prefers-contrast: high)&#39;);</span>

<span class="s1">        const updateContrast = (e) =&gt; {</span>
<span class="s1">            if (e.matches) {</span>
<span class="s1">                document.body.classList.add(&#39;high-contrast&#39;);</span>
<span class="s1">            } else {</span>
<span class="s1">                document.body.classList.remove(&#39;high-contrast&#39;);</span>
<span class="s1">            }</span>
<span class="s1">        };</span>

<span class="s1">        prefersHighContrast.addListener(updateContrast);</span>
<span class="s1">        updateContrast(prefersHighContrast);</span>

<span class="s1">        // Manual contrast toggle</span>
<span class="s1">        const contrastToggle = document.getElementById(&#39;contrast-toggle&#39;);</span>
<span class="s1">        if (contrastToggle) {</span>
<span class="s1">            contrastToggle.addEventListener(&#39;click&#39;, () =&gt; {</span>
<span class="s1">                document.body.classList.toggle(&#39;high-contrast&#39;);</span>
<span class="s1">                const isHighContrast = document.body.classList.contains(&#39;high-contrast&#39;);</span>
<span class="s1">                localStorage.setItem(&#39;high-contrast&#39;, isHighContrast);</span>
<span class="s1">                contrastToggle.setAttribute(&#39;aria-pressed&#39;, isHighContrast);</span>
<span class="s1">            });</span>
<span class="s1">        }</span>
<span class="s1">    }</span>

<span class="s1">    setupScreenReaderSupport() {</span>
<span class="s1">        // Announce important changes to screen readers</span>
<span class="s1">        const liveRegion = document.createElement(&#39;div&#39;);</span>
<span class="s1">        liveRegion.setAttribute(&#39;aria-live&#39;, &#39;polite&#39;);</span>
<span class="s1">        liveRegion.setAttribute(&#39;aria-atomic&#39;, &#39;true&#39;);</span>
<span class="s1">        liveRegion.className = &#39;sr-only&#39;;</span>
<span class="s1">        document.body.appendChild(liveRegion);</span>

<span class="s1">        window.announceToScreenReader = (message) =&gt; {</span>
<span class="s1">            liveRegion.textContent = message;</span>
<span class="s1">            setTimeout(() =&gt; {</span>
<span class="s1">                liveRegion.textContent = &#39;&#39;;</span>
<span class="s1">            }, 1000);</span>
<span class="s1">        };</span>

<span class="s1">        // Announce app state changes</span>
<span class="s1">        window.addEventListener(&#39;online&#39;, () =&gt; {</span>
<span class="s1">            window.announceToScreenReader(&#39;Connection restored. App is now online.&#39;);</span>
<span class="s1">        });</span>

<span class="s1">        window.addEventListener(&#39;offline&#39;, () =&gt; {</span>
<span class="s1">            window.announceToScreenReader(&#39;Connection lost. App is now in offline mode.&#39;);</span>
<span class="s1">        });</span>
<span class="s1">    }</span>

<span class="s1">    manageFocusOrder(e) {</span>
<span class="s1">        // Ensure logical focus order in complex layouts</span>
<span class="s1">        const focusableElements = Array.from(document.querySelectorAll(</span>
<span class="s1">            &#39;button:not([disabled]), [href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex=&quot;-1&quot;])&#39;</span>
<span class="s1">        ));</span>

<span class="s1">        const currentIndex = focusableElements.indexOf(document.activeElement);</span>

<span class="s1">        if (e.shiftKey) {</span>
<span class="s1">            // Backward navigation</span>
<span class="s1">            if (currentIndex === 0) {</span>
<span class="s1">                focusableElements[focusableElements.length - 1].focus();</span>
<span class="s1">                e.preventDefault();</span>
<span class="s1">            }</span>
<span class="s1">        } else {</span>
<span class="s1">            // Forward navigation</span>
<span class="s1">            if (currentIndex === focusableElements.length - 1) {</span>
<span class="s1">                focusableElements[0].focus();</span>
<span class="s1">                e.preventDefault();</span>
<span class="s1">            }</span>
<span class="s1">        }</span>
<span class="s1">    }</span>

<span class="s1">    handleEscape() {</span>
<span class="s1">        // Close modals/dropdowns with escape key</span>
<span class="s1">        const openModal = document.querySelector(&#39;.modal.open&#39;);</span>
<span class="s1">        const openDropdown = document.querySelector(&#39;.dropdown.open&#39;);</span>

<span class="s1">        if (openModal) {</span>
<span class="s1">            this.closeModal(openModal);</span>
<span class="s1">        } else if (openDropdown) {</span>
<span class="s1">            this.closeDropdown(openDropdown);</span>
<span class="s1">        }</span>
<span class="s1">    }</span>

<span class="s1">    handleActivation(e) {</span>
<span class="s1">        const target = e.target;</span>

<span class="s1">        // Handle custom button-like elements</span>
<span class="s1">        if (target.getAttribute(&#39;role&#39;) === &#39;button&#39;) {</span>
<span class="s1">            target.click();</span>
<span class="s1">            e.preventDefault();</span>
<span class="s1">        }</span>
<span class="s1">    }</span>

<span class="s1">    closeModal(modal) {</span>
<span class="s1">        modal.classList.remove(&#39;open&#39;);</span>
<span class="s1">        modal.setAttribute(&#39;aria-hidden&#39;, &#39;true&#39;);</span>
<span class="s1">        window.popFocus();</span>
<span class="s1">    }</span>

<span class="s1">    closeDropdown(dropdown) {</span>
<span class="s1">        dropdown.classList.remove(&#39;open&#39;);</span>
<span class="s1">        dropdown.setAttribute(&#39;aria-expanded&#39;, &#39;false&#39;);</span>
<span class="s1">    }</span>
<span class="s1">}</span>

<span class="s1">// Initialize accessibility features</span>
<span class="s1">document.addEventListener(&#39;DOMContentLoaded&#39;, () =&gt; {</span>
<span class="s1">    const a11y = new PWAAccessibility();</span>

<span class="s1">    // Load saved preferences</span>
<span class="s1">    if (localStorage.getItem(&#39;high-contrast&#39;) === &#39;true&#39;) {</span>
<span class="s1">        document.body.classList.add(&#39;high-contrast&#39;);</span>
<span class="s1">    }</span>
<span class="s1">});</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">accessibility_manager</span> <span class="o">=</span> <span class="n">PWAAccessibility</span><span class="p">()</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/api/pwa/accessibility&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">accessibility_status</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get PWA accessibility features status&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span>
        <span class="s1">&#39;features&#39;</span><span class="p">:</span> <span class="n">accessibility_manager</span><span class="o">.</span><span class="n">a11y_features</span><span class="p">,</span>
        <span class="s1">&#39;guidelines_compliance&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;WCAG 2.1 AA level compliance&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Keyboard navigation support&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Screen reader compatibility&#39;</span><span class="p">,</span>
            <span class="s1">&#39;High contrast mode&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Focus management&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ARIA labels and roles&#39;</span>
        <span class="p">]</span>
    <span class="p">})</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</code></pre>
</div>
<h2 id="try-it">Try it<a class="headerlink" href="#try-it" title="Permanent link">&para;</a></h2>
<details class="question">
<summary>Exercise 1: <span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A type of web application that uses modern web capabilities to deliver an app-like experience, working offline and installable on devices." data-glossary-full-form="Progressive Web Application" data-glossary-term="PWA">PWA</span> <span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A script that runs in the background of a web browser, enabling features like offline functionality and push notifications." data-glossary-term="Service Worker">Service Worker</span> Implementation</summary>
<p><strong>Scenario</strong>: Create a <span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A type of web application that uses modern web capabilities to deliver an app-like experience, working offline and installable on devices." data-glossary-full-form="Progressive Web Application" data-glossary-term="PWA">PWA</span> for a note-taking application that works offline.</p>
<p><strong>Tasks</strong>:</p>
<ol>
<li>
<p>Implement a <span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A script that runs in the background of a web browser, enabling features like offline functionality and push notifications." data-glossary-term="Service Worker">service worker</span> that caches the app <span class="glossary-term" data-glossary-category="Programming Fundamentals" data-glossary-definition="A text-based interface for entering commands to interact with the operating system and execute programs." data-glossary-term="Terminal">shell</span> and user notes</p>
</li>
<li>
<p>Add background sync for notes created while offline</p>
</li>
<li>
<p>Create an offline fallback page with <span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A hardware or software component that stores data for faster retrieval on future requests, improving performance." data-glossary-term="Cache">cached</span> notes access</p>
</li>
</ol>
<details class="success">
<summary>Sample Solution</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/api/notes&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_note</span><span class="p">():</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create note with offline support&quot;&quot;&quot;</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">get_json</span><span class="p">()</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X-Offline-Request&#39;</span><span class="p">):</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>        <span class="c1"># Queue for background sync</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>        <span class="n">sync_id</span> <span class="o">=</span> <span class="n">sync_manager</span><span class="o">.</span><span class="n">queue_sync_action</span><span class="p">(</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>            <span class="s1">&#39;create_note&#39;</span><span class="p">,</span> <span class="s1">&#39;notes&#39;</span><span class="p">,</span> <span class="n">data</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>        <span class="p">)</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;queued&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;sync_id&#39;</span><span class="p">:</span> <span class="n">sync_id</span><span class="p">})</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>        <span class="c1"># Process immediately</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>        <span class="n">note_id</span> <span class="o">=</span> <span class="n">store_note</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">note_id</span><span class="p">,</span> <span class="s1">&#39;created&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="c1"># Service worker cache strategy for notes</span>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="n">NOTES_CACHE_STRATEGY</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="s1">// Cache notes data with versioning</span>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="s1">if (url.pathname.startsWith(&#39;/api/notes&#39;)) {</span>
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="s1">    event.respondWith(</span>
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="s1">        caches.open(&#39;notes-v1&#39;).then(cache =&gt; {</span>
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a><span class="s1">            return cache.match(request).then(response =&gt; {</span>
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="s1">                if (response) {</span>
</span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a><span class="s1">                    // Serve from cache and update in background</span>
</span><span id="__span-1-26"><a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a><span class="s1">                    fetch(request).then(freshResponse =&gt; {</span>
</span><span id="__span-1-27"><a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a><span class="s1">                        cache.put(request, freshResponse.clone());</span>
</span><span id="__span-1-28"><a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a><span class="s1">                    });</span>
</span><span id="__span-1-29"><a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a><span class="s1">                    return response;</span>
</span><span id="__span-1-30"><a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a><span class="s1">                }</span>
</span><span id="__span-1-31"><a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a><span class="s1">                return fetch(request).then(freshResponse =&gt; {</span>
</span><span id="__span-1-32"><a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a><span class="s1">                    cache.put(request, freshResponse.clone());</span>
</span><span id="__span-1-33"><a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a><span class="s1">                    return freshResponse;</span>
</span><span id="__span-1-34"><a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a><span class="s1">                });</span>
</span><span id="__span-1-35"><a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a><span class="s1">            });</span>
</span><span id="__span-1-36"><a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a><span class="s1">        })</span>
</span><span id="__span-1-37"><a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a><span class="s1">    );</span>
</span><span id="__span-1-38"><a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a><span class="s1">}</span>
</span><span id="__span-1-39"><a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a><span class="s1">&#39;&#39;&#39;</span>
</span></code></pre></div>
</details>
</details>
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h2>
<p>Progressive Web Apps combine the best of web and native mobile applications:</p>
<ul>
<li>
<p><strong><span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A script that runs in the background of a web browser, enabling features like offline functionality and push notifications." data-glossary-term="Service Worker"><span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A script that runs in the background of a web browser, enabling features like offline functionality and push notifications." data-glossary-term="Service Worker">Service Workers</span></span></strong> enable offline functionality, background sync, and push notifications through programmable network proxies</p>
</li>
<li>
<p><strong>Installable characteristics</strong> provide app-like installation prompts, standalone display modes, and native app behaviors</p>
</li>
<li>
<p><strong>Background synchronization</strong> ensures data consistency between online and offline states with conflict resolution strategies</p>
</li>
<li>
<p><strong>Accessibility considerations</strong> maintain inclusive design principles through keyboard navigation, screen reader support, and WCAG compliance</p>
</li>
<li>
<p><strong>Performance optimization</strong> leverages <span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A hardware or software component that stores data for faster retrieval on future requests, improving performance." data-glossary-term="Cache">caching</span> strategies, <span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A resource file used in web development, including images, stylesheets, JavaScript files, and fonts." data-glossary-term="Asset">asset</span> optimization, and progressive enhancement for fast, reliable experiences</p>
</li>
<li>
<p><strong>Cross-platform compatibility</strong> delivers consistent functionality across different devices, browsers, and operating systems</p>
</li>
</ul>
<p>Understanding <span class="glossary-term" data-glossary-category="Web Development" data-glossary-definition="A type of web application that uses modern web capabilities to deliver an app-like experience, working offline and installable on devices." data-glossary-full-form="Progressive Web Application" data-glossary-term="PWA">PWA</span> development enables developers to create engaging, performant applications that work reliably in any network condition while providing users with native app-like experiences through web technologies.</p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="October 18, 2025 02:48:38 UTC">October 18, 2025</span>
  </span>

    
    
    
    
  </aside>


  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback! Help us improve this page by creating an <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/issues/new/choose" target="_blank" rel="noopener">issue</a> on github.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        

<!-- Footer -->
<footer class="md-footer">
  
    <!-- Custom footer with left/right layout -->
    <div class="md-footer__inner md-grid">
      <!-- Left side: Copyright and cookie settings -->
      <div class="md-footer__left">
        <div class="md-footer__copyright">
          
            Copyright &copy; 2025 Eatham532 – <a href="#__consent">Change cookie settings</a>

          
        </div>
      </div>

      <!-- Right side: Page name and BETA -->
      <div class="md-footer__right">
        <div class="md-footer__page-info">
          <span class="md-footer__page-title">Content</span>
          
            <span class="md-footer__beta-badge">BETA</span>
          
        </div>
      </div>
    </div>
  
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            



<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of the textbook. With your consent, you're helping us to make software engineering education better for everyone.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="analytics" checked>
      <span class="task-list-indicator"></span>
      Google Analytics
    </label>
  </li>

      
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tabs", "navigation.top", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.prune", "search.highlight", "search.suggest", "content.code.annotate", "content.code.copy", "content.code.select", "content.tabs.link", "content.action.edit", "content.action.view", "toc.follow"], "search": "../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../../assets/diagram-modal.js"></script>
      
        <script src="../../../../assets/quiz.js"></script>
      
        <script src="../../../../assets/ide-utils.js"></script>
      
        <script src="../../../../assets/code-blocks.js"></script>
      
        <script src="../../../../assets/glossary.js"></script>
      
    
  </body>
</html>