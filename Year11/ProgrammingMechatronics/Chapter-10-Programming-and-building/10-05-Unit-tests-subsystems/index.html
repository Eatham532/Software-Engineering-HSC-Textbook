
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Comprehensive educational resource for NSW HSC Software Engineering syllabus">
      
      
      
        <link rel="canonical" href="https://eatham532.github.io/Software-Engineering-HSC-Textbook/Year11/ProgrammingMechatronics/Chapter-10-Programming-and-building/10-05-Unit-tests-subsystems/">
      
      
        <link rel="prev" href="../10-04-User-interfaces-for-control/quiz/">
      
      
        <link rel="next" href="quiz/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>10.5 Unit tests for subsystems - Software Engineering Textbook HSC</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/diagram-modal.css">
    
      <link rel="stylesheet" href="../../../../assets/quiz.css">
    
      <link rel="stylesheet" href="../../../../assets/common.css">
    
      <link rel="stylesheet" href="../../../../assets/diagram-fix.css">
    
      <link rel="stylesheet" href="../../../../assets/cross-reference.css">
    
      <link rel="stylesheet" href="../../../../assets/site-banner.css">
    
      <link rel="stylesheet" href="../../../../assets/code-runner.css">
    
      <link rel="stylesheet" href="../../../../assets/code-editor.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-58275RL1P9"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-58275RL1P9",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-58275RL1P9",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#105-unit-tests-for-subsystems" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
  
  
    
    
    
    <div class="site-banner site-banner--warning" data-banner data-banner-version="1" role="status" aria-live="polite">
      <div class="site-banner__inner">
        <span class="site-banner__icon" aria-hidden="true">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            
              <path d="M12 9v4"/><path d="M12 17h.01"/><path d="M10.29 3.86 1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0Z"/>
            
          </svg>
        </span>
        <p class="site-banner__text">
          This textbook is in <strong>beta</strong> ‚Äì content is actively being refined.
          
            <a class="site-banner__link" href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/issues/new/choose" target="_blank" rel="noopener">Report issues or suggestions</a>
          
        </p>
        <button type="button" class="site-banner__close" aria-label="Dismiss banner" title="Dismiss" data-banner-dismiss>&times;</button>
      </div>
    </div>
    <script>
      (function(){
        var banner=document.querySelector('[data-banner]');
        if(!banner) return;
        var version=banner.getAttribute('data-banner-version')||'1';
        var KEY='site_banner_dismissed_v'+version;
        try{ if(localStorage.getItem(KEY)){ banner.remove(); return;} }catch(e){}
        var btn=banner.querySelector('[data-banner-dismiss]');
        if(btn){ btn.addEventListener('click',function(){
          banner.classList.add('is-hiding');
          setTimeout(function(){ banner && banner.remove(); },200);
          try{ localStorage.setItem(KEY,'1'); }catch(e){}
        }); }
      })();
    </script>
  
  
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Software Engineering Textbook HSC" class="md-header__button md-logo" aria-label="Software Engineering Textbook HSC" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Software Engineering Textbook HSC
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              10.5 Unit tests for subsystems
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Eatham532/Software-Engineering-HSC-Textbook
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    

    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../ProgrammingFundamentals/" class="md-tabs__link">
          
  
  
  Year 11

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../Year12/ProgrammingForTheWeb/" class="md-tabs__link">
          
  
  
  Year 12

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../code-editor/" class="md-tabs__link">
        
  
  
    
  
  Code Editor

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Software Engineering Textbook HSC" class="md-nav__button md-logo" aria-label="Software Engineering Textbook HSC" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Software Engineering Textbook HSC
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Eatham532/Software-Engineering-HSC-Textbook
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Year 11
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Year 11
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../ProgrammingFundamentals/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Programming Fundamentals
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../ObjectOrientedParadigm/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Object-Oriented Paradigm
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Programming Mechatronics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Programming Mechatronics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../Chapter-07-Mechatronics-foundations/07-01-Applications-of-mechatronic-systems/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 07 ‚Äî Mechatronics foundations
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../Chapter-08-Data-and-integration/08-01-Working-with-device-data-and-diagnostics/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 08 ‚Äî Data and integration
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../Chapter-09-Control-algorithms/09-01-Open-vs-closed-loop-systems/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chapter 09 ‚Äî Control algorithms
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_5" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3_5" id="__nav_2_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Chapter 10 ‚Äî Programming and building
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3_5">
            <span class="md-nav__icon md-icon"></span>
            Chapter 10 ‚Äî Programming and building
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../10-01-Simulations-and-prototypes-for-testing/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    10.1 Simulations and prototypes for testing
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../10-02-Implementing-closed-loop-control/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    10.2 Implementing closed-loop control
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../10-03-Integrating-sensors-and-actuators/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    10.3 Integrating sensors and actuators
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../10-04-User-interfaces-for-control/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    10.4 User interfaces for control
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_5_5" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3_5_5" id="__nav_2_3_5_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    10.5 Unit tests subsystems
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_3_5_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3_5_5">
            <span class="md-nav__icon md-icon"></span>
            10.5 Unit tests subsystems
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Content
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Content
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-it-matters" class="md-nav__link">
    <span class="md-ellipsis">
      Why it matters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Concepts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unit-testing-fundamentals-for-mechatronics" class="md-nav__link">
    <span class="md-ellipsis">
      Unit testing fundamentals for mechatronics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-fixtures-simulating-physical-devices" class="md-nav__link">
    <span class="md-ellipsis">
      Test fixtures: simulating physical devices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guided-example-temperature-control-system-testing" class="md-nav__link">
    <span class="md-ellipsis">
      Guided example: temperature control system testing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehensive-unit-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Comprehensive unit tests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testability-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Testability patterns
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Testability patterns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dependency-injection-pattern" class="md-nav__link">
    <span class="md-ellipsis">
      Dependency injection pattern
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integration-testing-with-fixture-orchestration" class="md-nav__link">
    <span class="md-ellipsis">
      Integration testing with fixture orchestration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#try-it" class="md-nav__link">
    <span class="md-ellipsis">
      Try it
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recap" class="md-nav__link">
    <span class="md-ellipsis">
      Recap
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="quiz/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quiz
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../../../Year12/ProgrammingForTheWeb/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Year 12
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../code-editor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code Editor
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-it-matters" class="md-nav__link">
    <span class="md-ellipsis">
      Why it matters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Concepts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unit-testing-fundamentals-for-mechatronics" class="md-nav__link">
    <span class="md-ellipsis">
      Unit testing fundamentals for mechatronics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-fixtures-simulating-physical-devices" class="md-nav__link">
    <span class="md-ellipsis">
      Test fixtures: simulating physical devices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guided-example-temperature-control-system-testing" class="md-nav__link">
    <span class="md-ellipsis">
      Guided example: temperature control system testing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehensive-unit-tests" class="md-nav__link">
    <span class="md-ellipsis">
      Comprehensive unit tests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testability-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Testability patterns
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Testability patterns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dependency-injection-pattern" class="md-nav__link">
    <span class="md-ellipsis">
      Dependency injection pattern
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integration-testing-with-fixture-orchestration" class="md-nav__link">
    <span class="md-ellipsis">
      Integration testing with fixture orchestration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#try-it" class="md-nav__link">
    <span class="md-ellipsis">
      Try it
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recap" class="md-nav__link">
    <span class="md-ellipsis">
      Recap
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/edit/main/docs/Year11/ProgrammingMechatronics/Chapter-10-Programming-and-building/10-05-Unit-tests-subsystems/index.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/raw/main/docs/Year11/ProgrammingMechatronics/Chapter-10-Programming-and-building/10-05-Unit-tests-subsystems/index.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="105-unit-tests-for-subsystems">10.5 Unit tests for subsystems<a class="headerlink" href="#105-unit-tests-for-subsystems" title="Permanent link">&para;</a></h1>
<h2 id="why-it-matters">Why it matters<a class="headerlink" href="#why-it-matters" title="Permanent link">&para;</a></h2>
<p>Testing mechatronic subsystems presents unique challenges: hardware components are expensive, potentially dangerous, and may not be available during development. Unit testing with simulated devices allows developers to verify control logic, validate safety features, and ensure system reliability without requiring physical hardware.</p>
<p>Testability patterns and fixtures enable systematic verification of subsystem behaviour, making it possible to catch bugs early, document expected behaviour, and maintain confidence when making changes to complex control systems.</p>
<h2 id="concepts">Concepts<a class="headerlink" href="#concepts" title="Permanent link">&para;</a></h2>
<h3 id="unit-testing-fundamentals-for-mechatronics">Unit testing fundamentals for mechatronics<a class="headerlink" href="#unit-testing-fundamentals-for-mechatronics" title="Permanent link">&para;</a></h3>
<p>Unit testing verifies that individual components or subsystems behave correctly in isolation. For mechatronic systems, this means testing control logic separately from hardware interfaces.</p>
<p><strong>Key principles</strong>:</p>
<ul>
<li>
<p><strong>Isolation</strong>: test each subsystem independently</p>
</li>
<li>
<p><strong>Repeatability</strong>: tests produce consistent results</p>
</li>
<li>
<p><strong>Fast execution</strong>: tests run quickly without hardware delays</p>
</li>
<li>
<p><strong>Clear assertions</strong>: tests specify expected behaviour precisely</p>
</li>
</ul>
<p><strong>Challenges in mechatronic testing</strong>:</p>
<ul>
<li>
<p>Hardware dependencies make testing slow and expensive</p>
</li>
<li>
<p>Real sensors produce noisy, variable data</p>
</li>
<li>
<p>Actuators have physical constraints and safety implications</p>
</li>
<li>
<p>Timing-dependent behaviour is difficult to reproduce</p>
</li>
</ul>
<h3 id="test-fixtures-simulating-physical-devices">Test fixtures: simulating physical devices<a class="headerlink" href="#test-fixtures-simulating-physical-devices" title="Permanent link">&para;</a></h3>
<p>Test fixtures provide controlled, predictable substitutes for hardware components. They enable testing without physical devices while maintaining realistic behaviour patterns.</p>
<div class="diagram-container" data-container-id="kroki-diagram-0"><button class="diagram-expand-btn" onclick="openDiagramModal('kroki-diagram-0')">üîç View Larger</button><div id="kroki-diagram-0" class="diagram-content"><p><svg xmlns="http://www.w3.org/2000/svg" contentStyleType="text/css" data-diagram-type="DESCRIPTION" height="416px" preserveAspectRatio="xMaxYMax meet" style="width:1127px;height:416px;background:#FFFFFF;" version="1.1" viewBox="0 0 1127 416" width="1127px" zoomAndPan="magnify" id="Kroki" data-diagram-id="kroki-svg-0"><defs /><g><g class="cluster" data-entity="Production System" data-source-line="4" data-uid="ent0002" id="cluster_Production System"><path d="M405.5,95.42 L555.8379,95.42 A3.75,3.75 0 0 1 558.3379,97.92 L565.3379,117.7169 L726.5,117.7169 A2.5,2.5 0 0 1 729,120.2169 L729,407.36 A2.5,2.5 0 0 1 726.5,409.86 L405.5,409.86 A2.5,2.5 0 0 1 403,407.36 L403,97.92 A2.5,2.5 0 0 1 405.5,95.42" fill="none" style="stroke:#000000;stroke-width:1.5;" /><line style="stroke:#000000;stroke-width:1.5;" x1="403" x2="565.3379" y1="117.7169" y2="117.7169" /><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="149.3379" x="407" y="110.4151">Production System</text></g><g class="cluster" data-entity="Test Environment" data-source-line="11" data-uid="ent0011" id="cluster_Test Environment"><path d="M8.5,95.42 L149.1309,95.42 A3.75,3.75 0 0 1 151.6309,97.92 L158.6309,117.7169 L376.5,117.7169 A2.5,2.5 0 0 1 379,120.2169 L379,407.36 A2.5,2.5 0 0 1 376.5,409.86 L8.5,409.86 A2.5,2.5 0 0 1 6,407.36 L6,97.92 A2.5,2.5 0 0 1 8.5,95.42" fill="none" style="stroke:#000000;stroke-width:1.5;" /><line style="stroke:#000000;stroke-width:1.5;" x1="6" x2="158.6309" y1="117.7169" y2="117.7169" /><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="139.6309" x="10" y="110.4151">Test Environment</text></g><g class="entity" data-entity="Control Logic" data-source-line="5" data-uid="ent0003" id="entity_Control Logic"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="132.2031" x="418.9" y="130.42" /><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="531.1031" y="135.42" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="529.1031" y="137.42" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="529.1031" y="141.42" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.2031" x="433.9" y="163.4151">Control Logic</text></g><g class="entity" data-entity="Real Sensor" data-source-line="5" data-uid="ent0004" id="entity_Real Sensor"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="123.248" x="419.38" y="241.27" /><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="522.628" y="246.27" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="520.628" y="248.27" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="520.628" y="252.27" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83.248" x="434.38" y="274.2651">Real Sensor</text></g><g class="entity" data-entity="Real Actuator" data-source-line="6" data-uid="ent0006" id="entity_Real Actuator"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="135.2861" x="577.36" y="241.27" /><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="692.6461" y="246.27" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="690.6461" y="248.27" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="690.6461" y="252.27" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95.2861" x="592.36" y="274.2651">Real Actuator</text></g><g class="entity" data-entity="Physical Environment" data-source-line="7" data-uid="ent0008" id="entity_Physical Environment"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="191.1016" x="470.45" y="347.56" /><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="641.5516" y="352.56" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="639.5516" y="354.56" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="639.5516" y="358.56" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="151.1016" x="485.45" y="380.5551">Physical Environment</text></g><g class="entity" data-entity="Mock Sensor" data-source-line="12" data-uid="ent0012" id="entity_Mock Sensor"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="128.8877" x="234.56" y="241.27" /><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="343.4477" y="246.27" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="341.4477" y="248.27" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="341.4477" y="252.27" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88.8877" x="249.56" y="274.2651">Mock Sensor</text></g><g class="entity" data-entity="Mock Actuator" data-source-line="13" data-uid="ent0014" id="entity_Mock Actuator"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="140.9258" x="58.54" y="241.27" /><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="179.4658" y="246.27" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="177.4658" y="248.27" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="177.4658" y="252.27" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100.9258" x="73.54" y="274.2651">Mock Actuator</text></g><g class="entity" data-entity="Simulated Environment" data-source-line="14" data-uid="ent0016" id="entity_Simulated Environment"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="204.8965" x="26.55" y="347.56" /><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="211.4465" y="352.56" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="209.4465" y="354.56" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="209.4465" y="358.56" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="164.8965" x="41.55" y="380.5551">Simulated Environment</text></g><g class="entity" data-entity="Test Framework" data-source-line="16" data-uid="ent0019" id="entity_Test Framework"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="152.916" x="131.54" y="130.42" /><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="264.456" y="135.42" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="262.456" y="137.42" /><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="262.456" y="141.42" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112.916" x="146.54" y="163.4151">Test Framework</text></g><g class="entity" data-entity="GMN23" data-source-line="21" data-uid="ent0024" id="entity_GMN23"><path d="M745.25,125.87 L745.25,181.2684 L924.751,181.2684 L924.751,135.87 L914.751,125.87 L745.25,125.87" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;" /><path d="M914.751,125.87 L914.751,135.87 L924.751,135.87 L914.751,125.87" fill="#FAFAFA" style="stroke:#181818;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.3955" x="751.25" y="142.9369">Controls simulated</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.501" x="751.25" y="158.0697">environment and device</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.5063" x="751.25" y="173.2025">behaviour for testing</text></g><g class="entity" data-entity="GMN26" data-source-line="22" data-uid="ent0027" id="entity_GMN26"><path d="M959.75,133.43 L959.75,173.6956 L1120.2588,173.6956 L1120.2588,143.43 L1110.2588,133.43 L959.75,133.43" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;" /><path d="M1110.2588,133.43 L1110.2588,143.43 L1120.2588,143.43 L1110.2588,133.43" fill="#FAFAFA" style="stroke:#181818;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.9365" x="965.75" y="150.4969">Same logic tested</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139.5088" x="965.75" y="165.6297">in both environments</text></g><g class="link" data-entity-1="Control Logic" data-entity-2="Real Sensor" data-source-line="5" data-uid="lnk5" id="link_Control Logic_Real Sensor"><path d="M484.17,177.12 C483.48,195.8 482.7284,216.224 482.0484,234.894" fill="none" id="Control Logic-to-Real Sensor" style="stroke:#181818;stroke-width:1;" /><polygon fill="#181818" points="481.83,240.89,486.1549,232.0416,482.012,235.8933,478.1602,231.7504,481.83,240.89" style="stroke:#181818;stroke-width:1;" /></g><g class="link" data-entity-1="Control Logic" data-entity-2="Real Actuator" data-source-line="6" data-uid="lnk7" id="link_Control Logic_Real Actuator"><path d="M518.15,177.12 C545.61,195.8 579.4788,218.8456 606.9288,237.5156" fill="none" id="Control Logic-to-Real Actuator" style="stroke:#181818;stroke-width:1;" /><polygon fill="#181818" points="611.89,240.89,606.6977,232.521,607.7556,238.078,602.1986,239.136,611.89,240.89" style="stroke:#181818;stroke-width:1;" /></g><g class="link" data-entity-1="Real Sensor" data-entity-2="Physical Environment" data-source-line="7" data-uid="lnk9" id="link_Real Sensor_Physical Environment"><path d="M499.44,288.05 C513.7,305.54 529.5488,324.9895 543.7988,342.4695" fill="none" id="Real Sensor-to-Physical Environment" style="stroke:#181818;stroke-width:1;" /><polygon fill="#181818" points="547.59,347.12,545.0036,337.6168,544.4307,343.2446,538.8029,342.6717,547.59,347.12" style="stroke:#181818;stroke-width:1;" /></g><g class="link" data-entity-1="Real Actuator" data-entity-2="Physical Environment" data-source-line="8" data-uid="lnk10" id="link_Real Actuator_Physical Environment"><path d="M627.86,288.05 C614.61,305.54 599.9727,324.8571 586.7327,342.3371" fill="none" id="Real Actuator-to-Physical Environment" style="stroke:#181818;stroke-width:1;" /><polygon fill="#181818" points="583.11,347.12,591.7327,342.3608,586.1289,343.1343,585.3555,337.5305,583.11,347.12" style="stroke:#181818;stroke-width:1;" /></g><g class="link" data-entity-1="Control Logic" data-entity-2="Mock Sensor" data-source-line="12" data-uid="lnk13" id="link_Control Logic_Mock Sensor"><path d="M446.46,177.12 C414.54,195.8 374.5787,219.19 342.6687,237.86" fill="none" id="Control Logic-to-Mock Sensor" style="stroke:#181818;stroke-width:1;" /><polygon fill="#181818" points="337.49,240.89,347.2781,239.7975,341.8056,238.365,343.2381,232.8925,337.49,240.89" style="stroke:#181818;stroke-width:1;" /></g><g class="link" data-entity-1="Control Logic" data-entity-2="Mock Actuator" data-source-line="13" data-uid="lnk15" id="link_Control Logic_Mock Actuator"><path d="M418.46,174.91 C356.17,193.96 269.1579,220.5661 205.5279,240.0161" fill="none" id="Control Logic-to-Mock Actuator" style="stroke:#181818;stroke-width:1;" /><polygon fill="#181818" points="199.79,241.77,209.5662,242.9644,204.5716,240.3084,207.2276,235.3138,199.79,241.77" style="stroke:#181818;stroke-width:1;" /></g><g class="link" data-entity-1="Mock Sensor" data-entity-2="Simulated Environment" data-source-line="14" data-uid="lnk17" id="link_Mock Sensor_Simulated Environment"><path d="M262.11,288.05 C233.6,305.54 199.4241,326.5022 170.9341,343.9822" fill="none" id="Mock Sensor-to-Simulated Environment" style="stroke:#181818;stroke-width:1;" /><polygon fill="#181818" points="165.82,347.12,175.5831,345.8228,170.0818,344.5052,171.3994,339.0039,165.82,347.12" style="stroke:#181818;stroke-width:1;" /></g><g class="link" data-entity-1="Mock Actuator" data-entity-2="Simulated Environment" data-source-line="15" data-uid="lnk18" id="link_Mock Actuator_Simulated Environment"><path d="M129,288.05 C129,305.54 129,323.64 129,341.12" fill="none" id="Mock Actuator-to-Simulated Environment" style="stroke:#181818;stroke-width:1;" /><polygon fill="#181818" points="129,347.12,133,338.12,129,342.12,125,338.12,129,347.12" style="stroke:#181818;stroke-width:1;" /></g><g class="link" data-entity-1="Test Framework" data-entity-2="Mock Sensor" data-source-line="16" data-uid="lnk20" id="link_Test Framework_Mock Sensor"><path d="M226.86,177.12 C242.47,195.8 260.7114,217.6169 276.3214,236.2869" fill="none" id="Test Framework-to-Mock Sensor" style="stroke:#181818;stroke-width:1;" /><polygon fill="#181818" points="280.17,240.89,277.4658,231.4197,276.9628,237.0541,271.3284,236.5512,280.17,240.89" style="stroke:#181818;stroke-width:1;" /></g><g class="link" data-entity-1="Test Framework" data-entity-2="Mock Actuator" data-source-line="17" data-uid="lnk21" id="link_Test Framework_Mock Actuator"><path d="M191.63,177.12 C178.07,195.8 162.4242,217.3641 148.8742,236.0341" fill="none" id="Test Framework-to-Mock Actuator" style="stroke:#181818;stroke-width:1;" /><polygon fill="#181818" points="145.35,240.89,153.8736,235.9556,148.2869,236.8434,147.3991,231.2567,145.35,240.89" style="stroke:#181818;stroke-width:1;" /></g><g class="link" data-entity-1="Test Framework" data-entity-2="Simulated Environment" data-source-line="18" data-uid="lnk22" id="link_Test Framework_Simulated Environment"><path d="M131.32,174.6 C97.43,187.69 60.85,208.6 41,241.27 C17.77,279.5 56.5585,318.3821 90.2685,343.6421" fill="none" id="Test Framework-to-Simulated Environment" style="stroke:#181818;stroke-width:1;" /><polygon fill="#181818" points="95.07,347.24,90.2663,338.6421,91.0687,344.2417,85.4691,345.0441,95.07,347.24" style="stroke:#181818;stroke-width:1;" /></g><g class="link" data-entity-1="Test Framework" data-entity-2="GMN23" data-source-line="21" data-uid="lnk25" id="link_Test Framework_GMN23"><path d="M246.59,130.01 C287.89,106.29 356.18,71.29 420.5,57.42 C546.93,30.15 589.18,15.42 711.5,57.42 C750.56,70.83 786.78,102.21 809.75,125.5" fill="none" id="Test Framework-GMN23" style="stroke:#181818;stroke-width:1;stroke-dasharray:7.0,7.0;" /></g><g class="link" data-entity-1="GMN26" data-entity-2="Control Logic" data-source-line="22" data-uid="lnk28" id="link_GMN26_Control Logic"><path d="M1023.41,133 C1003.02,109.52 965.96,72.42 924.5,57.42 C782.38,6 604.01,87.25 525.38,129.98" fill="none" id="GMN26-Control Logic" style="stroke:#181818;stroke-width:1;stroke-dasharray:7.0,7.0;" /></g></g></svg></p></div></div>
<h3 id="guided-example-temperature-control-system-testing">Guided example: temperature control system testing<a class="headerlink" href="#guided-example-temperature-control-system-testing" title="Permanent link">&para;</a></h3>
<p>Let&rsquo;s test a temperature control system that manages heating based on sensor readings and safety limits.</p>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python"><span class="c1"># temperature_controller.py - The system under test</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TemperatureController</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sensor</span><span class="p">,</span> <span class="n">heater</span><span class="p">,</span> <span class="n">safety_limit</span><span class="o">=</span><span class="mf">80.0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span> <span class="o">=</span> <span class="n">sensor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heater</span> <span class="o">=</span> <span class="n">heater</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">safety_limit</span> <span class="o">=</span> <span class="n">safety_limit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_temperature</span> <span class="o">=</span> <span class="mf">20.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_enabled</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_target</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">temperature</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the target temperature&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="mi">10</span> <span class="o">&lt;=</span> <span class="n">temperature</span> <span class="o">&lt;=</span> <span class="mi">70</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">target_temperature</span> <span class="o">=</span> <span class="n">temperature</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">enable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Enable the controller&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_enabled</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">disable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Disable the controller&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_enabled</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heater</span><span class="o">.</span><span class="n">set_power</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Ensure heater is off</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Main control loop - call regularly&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_enabled</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># Read current temperature</span>
        <span class="n">current_temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">read_temperature</span><span class="p">()</span>

        <span class="c1"># Safety check - emergency shutdown if too hot</span>
        <span class="k">if</span> <span class="n">current_temp</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">safety_limit</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disable</span><span class="p">()</span>
            <span class="k">raise</span> <span class="n">SafetyException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Temperature </span><span class="si">{</span><span class="n">current_temp</span><span class="si">}</span><span class="s2">¬∞C exceeds safety limit </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">safety_limit</span><span class="si">}</span><span class="s2">¬∞C&quot;</span><span class="p">)</span>

        <span class="c1"># Simple proportional control</span>
        <span class="n">error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_temperature</span> <span class="o">-</span> <span class="n">current_temp</span>

        <span class="k">if</span> <span class="n">error</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Need heating</span>
            <span class="n">power</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">error</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># Proportional gain of 10</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">heater</span><span class="o">.</span><span class="n">set_power</span><span class="p">(</span><span class="n">power</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Too hot or at target</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">heater</span><span class="o">.</span><span class="n">set_power</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get current system status&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;enabled&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_enabled</span><span class="p">,</span>
            <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_temperature</span><span class="p">,</span>
            <span class="s1">&#39;current&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">read_temperature</span><span class="p">(),</span>
            <span class="s1">&#39;heater_power&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">heater</span><span class="o">.</span><span class="n">get_power</span><span class="p">()</span>
        <span class="p">}</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SafetyException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Raised when safety limits are exceeded&quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre>
</div>
<p>Now let&rsquo;s create test fixtures for the sensor and heater:</p>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python"><span class="c1"># test_fixtures.py - Mock devices for testing</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MockTemperatureSensor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initial_temperature</span><span class="o">=</span><span class="mf">20.0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_temperature</span> <span class="o">=</span> <span class="n">initial_temperature</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_noise_level</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_failure_mode</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">read_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read temperature with optional noise and failure simulation&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_failure_mode</span> <span class="o">==</span> <span class="s2">&quot;disconnected&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ConnectionError</span><span class="p">(</span><span class="s2">&quot;Sensor disconnected&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_failure_mode</span> <span class="o">==</span> <span class="s2">&quot;invalid_reading&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">)</span>

        <span class="c1"># Add noise if configured</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
        <span class="n">noise</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_noise_level</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_noise_level</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_temperature</span> <span class="o">+</span> <span class="n">noise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">temperature</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the simulated temperature (for testing)&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_temperature</span> <span class="o">=</span> <span class="n">temperature</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_noise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">noise_level</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add random noise to readings&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_noise_level</span> <span class="o">=</span> <span class="n">noise_level</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">simulate_failure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">failure_type</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Simulate sensor failures&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_failure_mode</span> <span class="o">=</span> <span class="n">failure_type</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">clear_failure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear simulated failures&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_failure_mode</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MockHeater</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_power</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_total_energy</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_failure_mode</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_power</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">power_percentage</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set heater power (0-100%)&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_failure_mode</span> <span class="o">==</span> <span class="s2">&quot;stuck_on&quot;</span><span class="p">:</span>
            <span class="k">return</span>  <span class="c1"># Ignore commands when stuck</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_failure_mode</span> <span class="o">==</span> <span class="s2">&quot;no_response&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ConnectionError</span><span class="p">(</span><span class="s2">&quot;Heater not responding&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_power</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">power_percentage</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_power</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get current power setting&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_power</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_total_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get total energy consumed (for testing efficiency)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_total_energy</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">simulate_failure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">failure_type</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Simulate heater failures&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_failure_mode</span> <span class="o">=</span> <span class="n">failure_type</span>
        <span class="k">if</span> <span class="n">failure_type</span> <span class="o">==</span> <span class="s2">&quot;stuck_on&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_power</span> <span class="o">=</span> <span class="mf">100.0</span>  <span class="c1"># Stuck at full power</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">clear_failure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear simulated failures&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_failure_mode</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre>
</div>
<h3 id="comprehensive-unit-tests">Comprehensive unit tests<a class="headerlink" href="#comprehensive-unit-tests" title="Permanent link">&para;</a></h3>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python"><span class="c1"># test_temperature_controller.py - Unit tests using fixtures</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">unittest</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">temperature_controller</span><span class="w"> </span><span class="kn">import</span> <span class="n">TemperatureController</span><span class="p">,</span> <span class="n">SafetyException</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">test_fixtures</span><span class="w"> </span><span class="kn">import</span> <span class="n">MockTemperatureSensor</span><span class="p">,</span> <span class="n">MockHeater</span>

<span class="k">class</span><span class="w"> </span><span class="nc">TestTemperatureController</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up test fixtures before each test&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span> <span class="o">=</span> <span class="n">MockTemperatureSensor</span><span class="p">(</span><span class="n">initial_temperature</span><span class="o">=</span><span class="mf">20.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heater</span> <span class="o">=</span> <span class="n">MockHeater</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span> <span class="o">=</span> <span class="n">TemperatureController</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">heater</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_initial_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test controller starts in correct initial state&quot;&quot;&quot;</span>
        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">get_status</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;enabled&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> <span class="mf">20.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;current&#39;</span><span class="p">],</span> <span class="mf">20.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;heater_power&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_target_temperature_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test target temperature range validation&quot;&quot;&quot;</span>
        <span class="c1"># Valid temperatures should be accepted</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">set_target</span><span class="p">(</span><span class="mf">25.0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">target_temperature</span><span class="p">,</span> <span class="mf">25.0</span><span class="p">)</span>

        <span class="c1"># Invalid temperatures should be rejected</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">set_target</span><span class="p">(</span><span class="mf">5.0</span><span class="p">))</span>   <span class="c1"># Too low</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">set_target</span><span class="p">(</span><span class="mf">80.0</span><span class="p">))</span>  <span class="c1"># Too high</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">target_temperature</span><span class="p">,</span> <span class="mf">25.0</span><span class="p">)</span>  <span class="c1"># Unchanged</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_enable_disable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test controller enable/disable functionality&quot;&quot;&quot;</span>
        <span class="c1"># Start disabled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">is_enabled</span><span class="p">)</span>

        <span class="c1"># Enable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">is_enabled</span><span class="p">)</span>

        <span class="c1"># Disable should turn off heater</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heater</span><span class="o">.</span><span class="n">set_power</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>  <span class="c1"># Set some power</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">disable</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">is_enabled</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">heater</span><span class="o">.</span><span class="n">get_power</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_heating_control</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test proportional heating control&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">set_target</span><span class="p">(</span><span class="mf">30.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">set_temperature</span><span class="p">(</span><span class="mf">20.0</span><span class="p">)</span>  <span class="c1"># 10¬∞C below target</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

        <span class="c1"># Should apply proportional heating (error * 10)</span>
        <span class="n">expected_power</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="mi">10</span>  <span class="c1"># 10¬∞C error * gain of 10</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">heater</span><span class="o">.</span><span class="n">get_power</span><span class="p">(),</span> <span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">expected_power</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_no_heating_when_at_target</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test heater turns off when at target temperature&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">set_target</span><span class="p">(</span><span class="mf">25.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">set_temperature</span><span class="p">(</span><span class="mf">25.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">heater</span><span class="o">.</span><span class="n">get_power</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_no_heating_when_too_hot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test heater turns off when above target&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">set_target</span><span class="p">(</span><span class="mf">25.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">set_temperature</span><span class="p">(</span><span class="mf">30.0</span><span class="p">)</span>  <span class="c1"># Above target</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">heater</span><span class="o">.</span><span class="n">get_power</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_safety_limit_enforcement</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test emergency shutdown at safety limit&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">set_target</span><span class="p">(</span><span class="mf">30.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>

        <span class="c1"># Simulate temperature exceeding safety limit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">set_temperature</span><span class="p">(</span><span class="mf">85.0</span><span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">SafetyException</span><span class="p">)</span> <span class="k">as</span> <span class="n">context</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

        <span class="c1"># Controller should be disabled and heater off</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">is_enabled</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">heater</span><span class="o">.</span><span class="n">get_power</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s2">&quot;safety limit&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">exception</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_disabled_controller_ignores_updates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test disabled controller doesn&#39;t control heater&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">set_target</span><span class="p">(</span><span class="mf">40.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">set_temperature</span><span class="p">(</span><span class="mf">20.0</span><span class="p">)</span>
        <span class="c1"># Keep controller disabled</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">heater</span><span class="o">.</span><span class="n">get_power</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_power_limiting</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test heater power is limited to 100%&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">set_target</span><span class="p">(</span><span class="mf">50.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">set_temperature</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span>  <span class="c1"># Large error</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

        <span class="c1"># Even with large error, power should not exceed 100%</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">heater</span><span class="o">.</span><span class="n">get_power</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">TestTemperatureControllerWithFailures</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test controller behaviour with simulated device failures&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span> <span class="o">=</span> <span class="n">MockTemperatureSensor</span><span class="p">(</span><span class="n">initial_temperature</span><span class="o">=</span><span class="mf">20.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heater</span> <span class="o">=</span> <span class="n">MockHeater</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span> <span class="o">=</span> <span class="n">TemperatureController</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">heater</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_sensor_disconnection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test handling of sensor connection failure&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">simulate_failure</span><span class="p">(</span><span class="s2">&quot;disconnected&quot;</span><span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ConnectionError</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_sensor_invalid_reading</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test handling of invalid sensor data&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">simulate_failure</span><span class="p">(</span><span class="s2">&quot;invalid_reading&quot;</span><span class="p">)</span>

        <span class="c1"># Controller should handle NaN readings gracefully</span>
        <span class="c1"># Implementation detail: this might raise an exception or use a default</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">((</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_heater_failure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test detection of heater communication failure&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">set_target</span><span class="p">(</span><span class="mf">30.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heater</span><span class="o">.</span><span class="n">simulate_failure</span><span class="p">(</span><span class="s2">&quot;no_response&quot;</span><span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ConnectionError</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_sensor_noise_handling</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test controller stability with noisy sensor readings&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">set_target</span><span class="p">(</span><span class="mf">25.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">add_noise</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># ¬±0.5¬∞C noise</span>

        <span class="c1"># Run multiple updates with noise</span>
        <span class="n">power_readings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">set_temperature</span><span class="p">(</span><span class="mf">24.0</span><span class="p">)</span>  <span class="c1"># Slightly below target</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">controller</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
            <span class="n">power_readings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">heater</span><span class="o">.</span><span class="n">get_power</span><span class="p">())</span>

        <span class="c1"># Power should be generally consistent despite noise</span>
        <span class="n">avg_power</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">power_readings</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">power_readings</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertGreater</span><span class="p">(</span><span class="n">avg_power</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1"># Should be heating</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertLess</span><span class="p">(</span><span class="n">avg_power</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>    <span class="c1"># But not too much</span>

<span class="c1"># Test runner</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="c1"># Run all tests</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</code></pre>
</div>
<h3 id="testability-patterns">Testability patterns<a class="headerlink" href="#testability-patterns" title="Permanent link">&para;</a></h3>
<p>Designing systems for testability requires specific architectural patterns that separate concerns and enable dependency injection.</p>
<h4 id="dependency-injection-pattern">Dependency injection pattern<a class="headerlink" href="#dependency-injection-pattern" title="Permanent link">&para;</a></h4>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python"><span class="k">class</span><span class="w"> </span><span class="nc">RobotArm</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Example of dependency injection for testability&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">motor_controller</span><span class="p">,</span> <span class="n">position_sensor</span><span class="p">,</span> <span class="n">safety_monitor</span><span class="p">):</span>
        <span class="c1"># Dependencies injected at construction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">motor</span> <span class="o">=</span> <span class="n">motor_controller</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span> <span class="o">=</span> <span class="n">position_sensor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">safety</span> <span class="o">=</span> <span class="n">safety_monitor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_position</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_position</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">move_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_position</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Move arm to target position with safety checks&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">safety</span><span class="o">.</span><span class="n">is_position_safe</span><span class="p">(</span><span class="n">target_position</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">SafetyException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Target position </span><span class="si">{</span><span class="n">target_position</span><span class="si">}</span><span class="s2"> is not safe&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">target_position</span> <span class="o">=</span> <span class="n">target_position</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_move</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_execute_move</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Internal move execution logic&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">read_position</span><span class="p">()</span>
        <span class="n">error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_position</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_position</span>

        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">:</span>  <span class="c1"># Close enough</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">motor</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">error</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">motor</span><span class="o">.</span><span class="n">move_forward</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="o">*</span> <span class="mi">50</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">motor</span><span class="o">.</span><span class="n">move_backward</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="o">*</span> <span class="mi">50</span><span class="p">))</span>

<span class="c1"># Mock implementations for testing</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MockMotorController</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_command</span> <span class="o">=</span> <span class="s2">&quot;stop&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">power_level</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">move_forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">power</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_command</span> <span class="o">=</span> <span class="s2">&quot;forward&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">power_level</span> <span class="o">=</span> <span class="n">power</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">move_backward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">power</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_command</span> <span class="o">=</span> <span class="s2">&quot;backward&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">power_level</span> <span class="o">=</span> <span class="n">power</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_command</span> <span class="o">=</span> <span class="s2">&quot;stop&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">power_level</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MockPositionSensor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_position</span> <span class="o">=</span> <span class="n">position</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">read_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_position</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_position</span> <span class="o">=</span> <span class="n">position</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MockSafetyMonitor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">safe_range</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_position_safe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">safe_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">position</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">safe_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_safe_range</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_pos</span><span class="p">,</span> <span class="n">max_pos</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">safe_range</span> <span class="o">=</span> <span class="p">(</span><span class="n">min_pos</span><span class="p">,</span> <span class="n">max_pos</span><span class="p">)</span>

<span class="c1"># Test using dependency injection</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_robot_arm_movement</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test robot arm with injected mock dependencies&quot;&quot;&quot;</span>
    <span class="n">motor</span> <span class="o">=</span> <span class="n">MockMotorController</span><span class="p">()</span>
    <span class="n">sensor</span> <span class="o">=</span> <span class="n">MockPositionSensor</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
    <span class="n">safety</span> <span class="o">=</span> <span class="n">MockSafetyMonitor</span><span class="p">()</span>

    <span class="n">arm</span> <span class="o">=</span> <span class="n">RobotArm</span><span class="p">(</span><span class="n">motor</span><span class="p">,</span> <span class="n">sensor</span><span class="p">,</span> <span class="n">safety</span><span class="p">)</span>

    <span class="c1"># Test normal movement</span>
    <span class="n">arm</span><span class="o">.</span><span class="n">move_to</span><span class="p">(</span><span class="mf">20.0</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">motor</span><span class="o">.</span><span class="n">current_command</span> <span class="o">==</span> <span class="s2">&quot;forward&quot;</span>
    <span class="k">assert</span> <span class="n">motor</span><span class="o">.</span><span class="n">power_level</span> <span class="o">&gt;</span> <span class="mi">0</span>

    <span class="c1"># Test safety limits</span>
    <span class="n">safety</span><span class="o">.</span><span class="n">set_safe_range</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">arm</span><span class="o">.</span><span class="n">move_to</span><span class="p">(</span><span class="mf">100.0</span><span class="p">)</span>  <span class="c1"># Outside safe range</span>
        <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Should have raised SafetyException&quot;</span>
    <span class="k">except</span> <span class="n">SafetyException</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># Expected</span>
</code></pre>
</div>
<h3 id="integration-testing-with-fixture-orchestration">Integration testing with fixture orchestration<a class="headerlink" href="#integration-testing-with-fixture-orchestration" title="Permanent link">&para;</a></h3>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python"><span class="c1"># test_system_integration.py - Testing multiple subsystems together</span>
<span class="k">class</span><span class="w"> </span><span class="nc">GreenhouseIntegrationTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Integration tests using multiple coordinated fixtures&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Create an integrated mock environment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">environment</span> <span class="o">=</span> <span class="n">MockGreenhouseEnvironment</span><span class="p">()</span>

        <span class="c1"># Create subsystem fixtures</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temp_sensor</span> <span class="o">=</span> <span class="n">MockTemperatureSensor</span><span class="p">(</span><span class="mf">20.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">humidity_sensor</span> <span class="o">=</span> <span class="n">MockHumiditySensor</span><span class="p">(</span><span class="mf">60.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fan</span> <span class="o">=</span> <span class="n">MockFan</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heater</span> <span class="o">=</span> <span class="n">MockHeater</span><span class="p">()</span>

        <span class="c1"># Connect fixtures to environment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">add_sensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temp_sensor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">add_sensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">humidity_sensor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">add_actuator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fan</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">add_actuator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">heater</span><span class="p">)</span>

        <span class="c1"># Create system under test</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">greenhouse_controller</span> <span class="o">=</span> <span class="n">GreenhouseController</span><span class="p">(</span>
            <span class="n">temp_sensor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">temp_sensor</span><span class="p">,</span>
            <span class="n">humidity_sensor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">humidity_sensor</span><span class="p">,</span>
            <span class="n">fan</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fan</span><span class="p">,</span>
            <span class="n">heater</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">heater</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_coordinated_climate_control</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test temperature and humidity control working together&quot;&quot;&quot;</span>
        <span class="c1"># Set targets</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">greenhouse_controller</span><span class="o">.</span><span class="n">set_temperature_target</span><span class="p">(</span><span class="mf">25.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">greenhouse_controller</span><span class="o">.</span><span class="n">set_humidity_target</span><span class="p">(</span><span class="mf">70.0</span><span class="p">)</span>

        <span class="c1"># Simulate hot, dry conditions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">set_conditions</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span> <span class="n">humidity</span><span class="o">=</span><span class="mf">40.0</span><span class="p">)</span>

        <span class="c1"># Run control cycle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">greenhouse_controller</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

        <span class="c1"># Should activate fan for cooling and humidity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertGreater</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fan</span><span class="o">.</span><span class="n">get_speed</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="c1"># Should not heat when too hot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">heater</span><span class="o">.</span><span class="n">get_power</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_system_recovery_after_failure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test system behaviour during and after component failure&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">greenhouse_controller</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>

        <span class="c1"># Simulate sensor failure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temp_sensor</span><span class="o">.</span><span class="n">simulate_failure</span><span class="p">(</span><span class="s2">&quot;disconnected&quot;</span><span class="p">)</span>

        <span class="c1"># System should detect failure and enter safe mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">greenhouse_controller</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">greenhouse_controller</span><span class="o">.</span><span class="n">is_in_safe_mode</span><span class="p">())</span>

        <span class="c1"># Restore sensor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temp_sensor</span><span class="o">.</span><span class="n">clear_failure</span><span class="p">()</span>

        <span class="c1"># System should recover</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">greenhouse_controller</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">greenhouse_controller</span><span class="o">.</span><span class="n">is_in_safe_mode</span><span class="p">())</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MockGreenhouseEnvironment</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Orchestrates multiple fixtures to simulate realistic environment&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuators</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">20.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">humidity</span> <span class="o">=</span> <span class="mf">60.0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_sensor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sensor</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sensor</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_actuator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actuator</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">actuator</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_conditions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">humidity</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update environmental conditions&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">temperature</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="n">temperature</span>
            <span class="c1"># Update all temperature sensors</span>
            <span class="k">for</span> <span class="n">sensor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensors</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sensor</span><span class="p">,</span> <span class="s1">&#39;set_temperature&#39;</span><span class="p">):</span>
                    <span class="n">sensor</span><span class="o">.</span><span class="n">set_temperature</span><span class="p">(</span><span class="n">temperature</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">humidity</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">humidity</span> <span class="o">=</span> <span class="n">humidity</span>
            <span class="c1"># Update all humidity sensors</span>
            <span class="k">for</span> <span class="n">sensor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensors</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sensor</span><span class="p">,</span> <span class="s1">&#39;set_humidity&#39;</span><span class="p">):</span>
                    <span class="n">sensor</span><span class="o">.</span><span class="n">set_humidity</span><span class="p">(</span><span class="n">humidity</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">simulate_time_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Simulate environmental dynamics over time&quot;&quot;&quot;</span>
        <span class="c1"># Simple thermal model</span>
        <span class="n">heating_effect</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
            <span class="n">actuator</span><span class="o">.</span><span class="n">get_power</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.01</span> 
            <span class="k">for</span> <span class="n">actuator</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actuators</span> 
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">actuator</span><span class="p">,</span> <span class="s1">&#39;get_power&#39;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">cooling_effect</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
            <span class="n">actuator</span><span class="o">.</span><span class="n">get_speed</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.005</span>
            <span class="k">for</span> <span class="n">actuator</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actuators</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">actuator</span><span class="p">,</span> <span class="s1">&#39;get_speed&#39;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span> <span class="o">+=</span> <span class="p">(</span><span class="n">heating_effect</span> <span class="o">-</span> <span class="n">cooling_effect</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>

        <span class="c1"># Update sensors with new conditions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_conditions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">humidity</span><span class="p">)</span>
</code></pre>
</div>
<h2 id="try-it">Try it<a class="headerlink" href="#try-it" title="Permanent link">&para;</a></h2>
<details class="question">
<summary>Exercise 1: sensor validation testing</summary>
<p>Create unit tests for a pressure sensor that must validate readings are within expected ranges and handle sensor failures gracefully.</p>
<p>Requirements:</p>
<ul>
<li>
<p>Normal range: 0-1000 kPa</p>
</li>
<li>
<p>Must detect readings outside physical limits</p>
</li>
<li>
<p>Must handle sensor disconnection</p>
</li>
<li>
<p>Must provide default safe reading during failures</p>
</li>
</ul>
<details class="success">
<summary>Sample Solution</summary>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python"><span class="k">class</span><span class="w"> </span><span class="nc">PressureSensor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_pressure</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_pressure</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_pressure</span> <span class="o">=</span> <span class="n">min_pressure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_pressure</span> <span class="o">=</span> <span class="n">max_pressure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_valid_reading</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">read_pressure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Implementation would read from actual hardware</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate_reading</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_reading</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">raw_reading</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_pressure</span> <span class="ow">or</span> <span class="n">raw_reading</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_pressure</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Pressure </span><span class="si">{</span><span class="n">raw_reading</span><span class="si">}</span><span class="s2"> outside valid range&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">raw_reading</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_safe_reading</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">reading</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_pressure</span><span class="p">()</span>
            <span class="n">validated</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_reading</span><span class="p">(</span><span class="n">reading</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">last_valid_reading</span> <span class="o">=</span> <span class="n">validated</span>
            <span class="k">return</span> <span class="n">validated</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ConnectionError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_valid_reading</span>  <span class="c1"># Return last known good value</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MockPressureSensor</span><span class="p">(</span><span class="n">PressureSensor</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pressure</span> <span class="o">=</span> <span class="mi">500</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_connected</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">read_pressure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_connected</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ConnectionError</span><span class="p">(</span><span class="s2">&quot;Sensor disconnected&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pressure</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_pressure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pressure</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pressure</span> <span class="o">=</span> <span class="n">pressure</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_connected</span> <span class="o">=</span> <span class="kc">False</span>

<span class="k">class</span><span class="w"> </span><span class="nc">TestPressureSensor</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span> <span class="o">=</span> <span class="n">MockPressureSensor</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_valid_readings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">set_pressure</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">get_safe_reading</span><span class="p">(),</span> <span class="mi">500</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_invalid_high_reading</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">set_pressure</span><span class="p">(</span><span class="mi">1500</span><span class="p">)</span>  <span class="c1"># Above max</span>
        <span class="c1"># Should return last valid (0 initially)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">get_safe_reading</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_disconnected_sensor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">set_pressure</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">get_safe_reading</span><span class="p">()</span>  <span class="c1"># Store valid reading</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
        <span class="c1"># Should return last valid reading</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">get_safe_reading</span><span class="p">(),</span> <span class="mi">300</span><span class="p">)</span>
</code></pre>
</div>
</details>
<details class="question">
<summary>Exercise 2: actuator control testing</summary>
<p>Design tests for a servo motor controller that must handle position commands, speed limits, and safety boundaries.</p>
<p>Requirements:</p>
<ul>
<li>
<p>Position range: -180 to +180 degrees</p>
</li>
<li>
<p>Maximum speed: 90 degrees/second</p>
</li>
<li>
<p>Must reject commands outside safe range</p>
</li>
<li>
<p>Must stop immediately on safety signal</p>
</li>
</ul>
<details class="success">
<summary>Sample Solution</summary>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python"><span class="k">class</span><span class="w"> </span><span class="nc">ServoController</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_angle</span><span class="o">=-</span><span class="mi">180</span><span class="p">,</span> <span class="n">max_angle</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">max_speed</span><span class="o">=</span><span class="mi">90</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_angle</span> <span class="o">=</span> <span class="n">min_angle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_angle</span> <span class="o">=</span> <span class="n">max_angle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_speed</span> <span class="o">=</span> <span class="n">max_speed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_position</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_position</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_moving</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">emergency_stop</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">move_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_angle</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">emergency_stop</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_angle</span> <span class="o">&lt;=</span> <span class="n">target_angle</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_angle</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_position</span> <span class="o">=</span> <span class="n">target_angle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_moving</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">emergency_stop_activate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">emergency_stop</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_moving</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_moving</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">emergency_stop</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_position</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_position</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Close enough</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_moving</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">return</span>

        <span class="c1"># Calculate movement step with speed limit</span>
        <span class="n">max_step</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_speed</span> <span class="o">*</span> <span class="n">dt</span>
        <span class="n">step</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_step</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">error</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">error</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_position</span> <span class="o">+=</span> <span class="n">step</span>

<span class="k">class</span><span class="w"> </span><span class="nc">TestServoController</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">servo</span> <span class="o">=</span> <span class="n">ServoController</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_valid_move_command</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">servo</span><span class="o">.</span><span class="n">move_to</span><span class="p">(</span><span class="mi">90</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">servo</span><span class="o">.</span><span class="n">target_position</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">servo</span><span class="o">.</span><span class="n">is_moving</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_invalid_move_command</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">servo</span><span class="o">.</span><span class="n">move_to</span><span class="p">(</span><span class="mi">200</span><span class="p">))</span>  <span class="c1"># Outside range</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">servo</span><span class="o">.</span><span class="n">target_position</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># Unchanged</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">servo</span><span class="o">.</span><span class="n">is_moving</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_emergency_stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">servo</span><span class="o">.</span><span class="n">move_to</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">servo</span><span class="o">.</span><span class="n">emergency_stop_activate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">servo</span><span class="o">.</span><span class="n">is_moving</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">servo</span><span class="o">.</span><span class="n">move_to</span><span class="p">(</span><span class="mi">45</span><span class="p">))</span>  <span class="c1"># Commands rejected</span>
</code></pre>
</div>
</details>
<details class="question">
<summary>Exercise 3: system integration test</summary>
<p>Create an integration test for a conveyor belt system with multiple sensors and actuators working together.</p>
<p>Components:</p>
<ul>
<li>
<p>Speed sensor (encoder)</p>
</li>
<li>
<p>Safety sensor (light curtain)</p>
</li>
<li>
<p>Motor controller</p>
</li>
<li>
<p>Emergency stop button</p>
</li>
</ul>
<details class="success">
<summary>Sample Solution</summary>
<div class="highlight python-template" data-fence-type="template" data-language="python">
<pre><code class="language-python"><span class="k">class</span><span class="w"> </span><span class="nc">ConveyorSystem</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">speed_sensor</span><span class="p">,</span> <span class="n">safety_sensor</span><span class="p">,</span> <span class="n">motor</span><span class="p">,</span> <span class="n">estop_button</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">speed_sensor</span> <span class="o">=</span> <span class="n">speed_sensor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">safety_sensor</span> <span class="o">=</span> <span class="n">safety_sensor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">motor</span> <span class="o">=</span> <span class="n">motor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">estop_button</span> <span class="o">=</span> <span class="n">estop_button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_speed</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enabled</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">speed</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">estop_button</span><span class="o">.</span><span class="n">is_pressed</span><span class="p">():</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">safety_sensor</span><span class="o">.</span><span class="n">is_clear</span><span class="p">():</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_speed</span> <span class="o">=</span> <span class="n">speed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enabled</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enabled</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_speed</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">motor</span><span class="o">.</span><span class="n">set_speed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Emergency stop override</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">estop_button</span><span class="o">.</span><span class="n">is_pressed</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="c1"># Safety sensor check</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">safety_sensor</span><span class="o">.</span><span class="n">is_clear</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="c1"># Speed control</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">enabled</span><span class="p">:</span>
            <span class="n">current_speed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speed_sensor</span><span class="o">.</span><span class="n">read_speed</span><span class="p">()</span>
            <span class="n">error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_speed</span> <span class="o">-</span> <span class="n">current_speed</span>
            <span class="n">adjustment</span> <span class="o">=</span> <span class="n">error</span> <span class="o">*</span> <span class="mf">0.1</span>  <span class="c1"># Simple proportional control</span>
            <span class="n">new_speed</span> <span class="o">=</span> <span class="n">current_speed</span> <span class="o">+</span> <span class="n">adjustment</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">motor</span><span class="o">.</span><span class="n">set_speed</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">new_speed</span><span class="p">)))</span>

<span class="k">class</span><span class="w"> </span><span class="nc">TestConveyorIntegration</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">speed_sensor</span> <span class="o">=</span> <span class="n">MockSpeedSensor</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">safety_sensor</span> <span class="o">=</span> <span class="n">MockSafetySensor</span><span class="p">(</span><span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">motor</span> <span class="o">=</span> <span class="n">MockMotor</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">estop</span> <span class="o">=</span> <span class="n">MockEstopButton</span><span class="p">(</span><span class="n">pressed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">conveyor</span> <span class="o">=</span> <span class="n">ConveyorSystem</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">speed_sensor</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">safety_sensor</span><span class="p">,</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">motor</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">estop</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_normal_operation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Should start successfully</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conveyor</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conveyor</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertGreater</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">motor</span><span class="o">.</span><span class="n">current_speed</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_safety_sensor_stops_system</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conveyor</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">safety_sensor</span><span class="o">.</span><span class="n">set_clear</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Block sensor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conveyor</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">motor</span><span class="o">.</span><span class="n">current_speed</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conveyor</span><span class="o">.</span><span class="n">enabled</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_emergency_stop_override</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conveyor</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">estop</span><span class="o">.</span><span class="n">press</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conveyor</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">motor</span><span class="o">.</span><span class="n">current_speed</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conveyor</span><span class="o">.</span><span class="n">enabled</span><span class="p">)</span>
</code></pre>
</div>
</details>
<h2 id="recap">Recap<a class="headerlink" href="#recap" title="Permanent link">&para;</a></h2>
<p>Unit testing mechatronic subsystems requires specialized approaches to handle hardware dependencies and ensure reliable system behaviour:</p>
<p><strong>Test fixtures</strong>: mock devices provide controlled, predictable substitutes for hardware components, enabling fast and repeatable testing without physical devices.</p>
<p><strong>Testability patterns</strong>: dependency injection and interface abstraction separate control logic from hardware implementation, making systems easier to test and maintain.</p>
<p><strong>Comprehensive testing</strong>: covers normal operation, edge cases, failure scenarios, and safety requirements to ensure robust system behaviour.</p>
<p><strong>Integration testing</strong>: coordinates multiple fixtures to test subsystem interactions and system-level behaviour in realistic scenarios.</p>
<p><strong>Benefits</strong>: early bug detection, documented behaviour, confidence in changes, and reduced reliance on expensive hardware for development and testing.</p>
<p>Effective testing strategies enable reliable mechatronic systems by validating control logic, safety features, and system integration before deploying to physical hardware.</p>
<p>See also <a href="../10-01-Simulations-and-prototypes-for-testing/">10.1 Simulations and prototypes for testing</a> for simulation-based testing approaches.</p>
</details>
</details>
</details>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="October 16, 2025 05:58:30 UTC">October 16, 2025</span>
  </span>

    
    
    
    
  </aside>


  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback! Help us improve this page by creating an <a href="https://github.com/Eatham532/Software-Engineering-HSC-Textbook/issues/new/choose" target="_blank" rel="noopener">issue</a> on github.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        

<!-- Footer -->
<footer class="md-footer">
  
    <!-- Custom footer with left/right layout -->
    <div class="md-footer__inner md-grid">
      <!-- Left side: Copyright and cookie settings -->
      <div class="md-footer__left">
        <div class="md-footer__copyright">
          
            Copyright &copy; 2025 Eatham532 ‚Äì <a href="#__consent">Change cookie settings</a>

          
        </div>
      </div>

      <!-- Right side: Page name and BETA -->
      <div class="md-footer__right">
        <div class="md-footer__page-info">
          <span class="md-footer__page-title">Content</span>
          
            <span class="md-footer__beta-badge">BETA</span>
          
        </div>
      </div>
    </div>
  
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            



<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of the textbook. With your consent, you're helping us to make software engineering education better for everyone.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="analytics" checked>
      <span class="task-list-indicator"></span>
      Google Analytics
    </label>
  </li>

      
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tabs", "navigation.top", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.prune", "search.highlight", "search.suggest", "content.code.annotate", "content.code.copy", "content.code.select", "content.tabs.link", "content.action.edit", "content.action.view", "toc.follow"], "search": "../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../../assets/diagram-modal.js"></script>
      
        <script src="../../../../assets/quiz.js"></script>
      
        <script src="../../../../assets/ide-utils.js"></script>
      
        <script src="../../../../assets/code-blocks.js"></script>
      
    
  </body>
</html>